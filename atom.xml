<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sampwoodçš„One Piece</title>
  
  <subtitle>step by step</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://sampwood.github.io/"/>
  <updated>2020-08-02T14:58:23.508Z</updated>
  <id>https://sampwood.github.io/</id>
  
  <author>
    <name>Sampwood</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>web worker</title>
    <link href="https://sampwood.github.io/2020/08/02/web-worker/"/>
    <id>https://sampwood.github.io/2020/08/02/web-worker/</id>
    <published>2020-08-02T14:54:33.000Z</published>
    <updated>2020-08-02T14:58:23.508Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©çœ‹åˆ°ä¸€ç¯‡æ–‡ç« è®²è§£äº†web workerçš„æŠ€æœ¯æ–¹æ¡ˆã€‚å¾ˆæœ‰æ”¶è·ï¼Œè™½ç„¶ç›®å‰è™½ç„¶ä¸ä¸€å®šèƒ½ç”¨ä¸Šã€‚</p><a id="more"></a><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><blockquote><p>Web Worker ä½œä¸ºæµè§ˆå™¨å¤šçº¿ç¨‹æŠ€æœ¯, åœ¨é¡µé¢å†…å®¹ä¸æ–­ä¸°å¯Œ, åŠŸèƒ½æ—¥è¶‹å¤æ‚çš„å½“ä¸‹, æˆä¸ºç¼“è§£é¡µé¢å¡é¡¿, æå‡åº”ç”¨æ€§èƒ½çš„å¯é€‰æ–¹æ¡ˆ.</p></blockquote><p>web workerå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œé‡åº¦é€»è¾‘ï¼Œxhrï¼ŒIOç­‰æ“ä½œã€‚å› ä¸ºå®ƒä¸ä¼šå½±å“ä¸»çº¿ç¨‹çš„è¿è¡Œï¼Œæ‰€ä»¥å…¶åœ¨æŸäº›åœºæ™¯ä¸‹å¯ä»¥è§£å†³é¡µé¢å¡é¡¿ï¼Œæå‡æ¸²æŸ“æ€§èƒ½ã€‚</p><p>å®˜æ–¹æ–‡æ¡£æ˜¯ MDN çš„ Web Workers API. å…¶å¯¹ Web Worker çš„è¡¨è¿°æ˜¯:</p><blockquote><p>Web Workers makes it possible to run a script operation in a background thread separate from the main execution thread of a web application.</p></blockquote><h3 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h3><p>web workerçš„æµè§ˆå™¨å…¼å®¹æ€§è¿˜ä¸é”™ï¼Œä¸»æµæµè§ˆå™¨åœ¨å‡ å¹´å‰å°±æ”¯æŒ Workerã€‚</p><blockquote><p>å¯è§å½“ä¸‹æµè§ˆå™¨å·²ç»è¾ƒå¥½åœ°æ”¯æŒ Worker, åªè¦å¯¹ 0.09% çš„ä¸æ”¯æŒæµè§ˆå™¨åšå¥½å›é€€ç­–ç•¥(å¦‚å±•ç¤ºä¸€ä¸ª tip), Worker å¯ä»¥æ”¾å¿ƒåœ°åº”ç”¨åˆ°å‰ç«¯ä¸šåŠ¡ä¸­.</p></blockquote><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(<span class="string">'./worker.js'</span>);</span><br><span class="line">worker.postMessage(<span class="string">'hello'</span>);</span><br><span class="line">worker.onmessage = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.data); <span class="comment">// 'world'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// worker.js</span></span><br><span class="line">self.onmessage = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.data); <span class="comment">// 'hello'</span></span><br><span class="line">    postMessage(<span class="string">'world'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦æµç¨‹ä¸º:</p><ul><li>ä¸»çº¿ç¨‹è°ƒç”¨ new Worker(url) åˆ›å»º Worker å®ä¾‹, url ä¸º Worker JS èµ„æº url.</li><li>ä¸»çº¿ç¨‹è°ƒç”¨ postMessage å‘é€ hello, </li><li>ä¸»çº¿ç¨‹åˆ›å»ºç›‘å¬ï¼šåœ¨ onmesssage ä¸­ç›‘å¬ Worker çº¿ç¨‹æ¶ˆæ¯.</li><li>Worker çº¿ç¨‹åœ¨ onmessage ä¸­ç›‘å¬ä¸»çº¿ç¨‹æ¶ˆæ¯, æ”¶åˆ°ä¸»çº¿ç¨‹çš„ hello; </li><li>Worker é€šè¿‡ postMessage å›å¤ world.</li><li>ä¸»çº¿ç¨‹åœ¨æ¶ˆæ¯å›è°ƒä¸­æ”¶åˆ° Worker çš„ world ä¿¡æ¯.</li></ul><p>è¯­æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯åœ¨å®ç”¨æ—¶ï¼Œè¿˜æ˜¯å¯¹æ•°æ®é€šä¿¡è¿™éƒ¨åˆ†åšä¸€ä¸‹å°è£…ã€‚ä¹Ÿæœ‰åº“åšäº†è¿™äº›äº‹ï¼Œå¯ä»¥æœæœã€‚</p><h4 id="è¿è¡Œç¯å¢ƒå·®å¼‚"><a href="#è¿è¡Œç¯å¢ƒå·®å¼‚" class="headerlink" title="è¿è¡Œç¯å¢ƒå·®å¼‚"></a>è¿è¡Œç¯å¢ƒå·®å¼‚</h4><p>worker å’Œ ä¸»çº¿ç¨‹çš„è¿è¡Œç¯å¢ƒè¿˜æ˜¯æœ‰ä¸€äº›å·®å¼‚çš„ã€‚æœ€ä¸»è¦å°±æ˜¯worker æ˜¯ä¸æ”¯æŒ UI çš„ï¼Œæ‰€ä»¥domç›¸å…³çš„apiæ˜¯ä¸å­˜åœ¨çš„ã€‚è€Œä¸”worker çš„globalå¯¹è±¡ä¸æ˜¯ä¸»çº¿ç¨‹çš„windowå¯¹è±¡ã€‚Worker çº¿ç¨‹è¿è¡Œæ—¶, ä¼šåˆ›å»ºç‹¬ç«‹äºä¸»çº¿ç¨‹çš„ JS è¿è¡Œç¯å¢ƒ, ç§°ä¹‹ä¸º DedicatedWorkerGlobalScopeã€‚</p><h3 id="é€šä¿¡é€Ÿåº¦ç­‰"><a href="#é€šä¿¡é€Ÿåº¦ç­‰" class="headerlink" title="é€šä¿¡é€Ÿåº¦ç­‰"></a>é€šä¿¡é€Ÿåº¦ç­‰</h3><p>å¯¹web workeré€šä¿¡é€Ÿåº¦ç­‰æµ‹è¯•å°±ç”±ä¸“ä¸šäººå‘˜æ¥è¿›è¡Œäº†~~</p><h3 id="service-work"><a href="#service-work" class="headerlink" title="service work"></a>service work</h3><p>çœ‹åˆ°è¿™ï¼Œæœ‰æ²¡æœ‰æƒ³èµ·å¦ä¸€ä¸ªç‹¬ç«‹æ³¨å†Œè¿è¡Œçš„åŠŸèƒ½ service workå‘¢ï¼Ÿ</p><p>service workå’Œweb workè¿˜æ˜¯æœ‰ä¸€å®šçš„åŒºåˆ«çš„ã€‚service workä¼šè„±ç¦»é¡µé¢è¿è¡Œï¼Œå°±æ˜¯åœ¨é¡µé¢æ²¡æœ‰è®¿é—®åˆ°æ—¶ä¹Ÿä¼šç‹¬ç«‹è¿è¡Œã€‚</p><blockquote><p>Service workersæœ¬è´¨ä¸Šå……å½“Webåº”ç”¨ç¨‹åºä¸æµè§ˆå™¨ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ç½‘ç»œå¯ç”¨æ—¶ä½œä¸ºæµè§ˆå™¨å’Œç½‘ç»œé—´çš„ä»£ç†ã€‚å®ƒä»¬æ—¨åœ¨ï¼ˆé™¤å…¶ä»–ä¹‹å¤–ï¼‰ä½¿å¾—èƒ½å¤Ÿåˆ›å»ºæœ‰æ•ˆçš„ç¦»çº¿ä½“éªŒï¼Œæ‹¦æˆªç½‘ç»œè¯·æ±‚å¹¶åŸºäºç½‘ç»œæ˜¯å¦å¯ç”¨ä»¥åŠæ›´æ–°çš„èµ„æºæ˜¯å¦é©»ç•™åœ¨æœåŠ¡å™¨ä¸Šæ¥é‡‡å–é€‚å½“çš„åŠ¨ä½œã€‚</p></blockquote><p>service workeræ˜¯å¯¹é¡µé¢å†…å®¹åšç¼“å­˜å’Œæ›´æ–°ï¼Œç›¸å½“äºåˆ›å»ºä¸€ä¸ªå¯ä»¥offlineå·¥ä½œçš„appã€‚</p><p>è€Œweb workerä¸»è¦åŠŸèƒ½æ˜¯æŠŠå¤æ‚çš„å ç”¨cpuæ—¶é—´é•¿çš„é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œå‡å°‘é¡µé¢å¡é¡¿ï¼Œæé«˜é¡µé¢æ¸²æŸ“æ€§èƒ½ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://mp.weixin.qq.com/s/MyRRIbn-UoruVD1dpvD-QQ" target="_blank" rel="noopener">ã€ç¬¬2015æœŸã€‘Web Worker æ–‡çŒ®ç»¼è¿°</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©çœ‹åˆ°ä¸€ç¯‡æ–‡ç« è®²è§£äº†web workerçš„æŠ€æœ¯æ–¹æ¡ˆã€‚å¾ˆæœ‰æ”¶è·ï¼Œè™½ç„¶ç›®å‰è™½ç„¶ä¸ä¸€å®šèƒ½ç”¨ä¸Šã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="https://sampwood.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æ–°è·å–çš„çŸ¥è¯†ç‚¹</title>
    <link href="https://sampwood.github.io/2020/04/20/%E6%96%B0%E8%8E%B7%E5%8F%96%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <id>https://sampwood.github.io/2020/04/20/æ–°è·å–çš„çŸ¥è¯†ç‚¹/</id>
    <published>2020-04-20T03:39:26.000Z</published>
    <updated>2020-08-02T14:57:56.661Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­getåˆ°çš„æ–°çŸ¥è¯†ç‚¹ã€‚</p><h3 id="e2e"><a href="#e2e" class="headerlink" title="e2e"></a>e2e</h3><p>e2eæˆ–è€…ç«¯åˆ°ç«¯ï¼ˆend-to-endï¼‰æˆ–è€…UIæµ‹è¯•æ˜¯ä¸€ç§æµ‹è¯•æ–¹æ³•ï¼Œå®ƒç”¨æ¥æµ‹è¯•ä¸€ä¸ªåº”ç”¨ä»å¤´åˆ°å°¾çš„æµç¨‹æ˜¯å¦å’Œè®¾è®¡æ—¶å€™æ‰€æƒ³çš„ä¸€æ ·ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä»ä¸€ä¸ªç”¨æˆ·çš„è§’åº¦å‡ºå‘ï¼Œè®¤ä¸ºæ•´ä¸ªç³»ç»Ÿéƒ½æ˜¯ä¸€ä¸ªé»‘ç®±ï¼Œåªæœ‰UIä¼šæš´éœ²ç»™ç”¨æˆ·ã€‚</p><p>å…·ä½“é“¾æ¥çœ‹ï¼š<a href="http://sentsin.com/web/658.html" target="_blank" rel="noopener">http://sentsin.com/web/658.html</a><br><a id="more"></a></p><h3 id="angular1-5"><a href="#angular1-5" class="headerlink" title="angular1.5"></a>angular1.5</h3><h4 id="æŒ‡ä»¤çš„transcludeé€‰é¡¹ä»¥åŠng-transcludeæŒ‡ä»¤"><a href="#æŒ‡ä»¤çš„transcludeé€‰é¡¹ä»¥åŠng-transcludeæŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤çš„transcludeé€‰é¡¹ä»¥åŠng-transcludeæŒ‡ä»¤"></a>æŒ‡ä»¤çš„transcludeé€‰é¡¹ä»¥åŠng-transcludeæŒ‡ä»¤</h4><p><code style="color: #c7254e; background-color: #f9f2f4">transclude</code>å­—é¢æ„æ€å°±æ˜¯åµŒå…¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ éœ€ä¸éœ€è¦å°†ä½ çš„æŒ‡ä»¤å†…éƒ¨çš„å…ƒç´ ï¼ˆæ³¨æ„ä¸æ˜¯æŒ‡ä»¤çš„æ¨¡æ¿ï¼‰åµŒå…¥åˆ°ä½ çš„æ¨¡æ¿ä¸­å»ï¼Œé»˜è®¤æ˜¯falseã€‚</p><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h4><ul><li>å®‰è£…pythonæ¨¡å—ï¼š<code>sudo apt-get update</code>ï¼Œ<code>sudo apt-get install python-websocket</code></li><li>å®‰è£…jdkï¼š<code>sudo apt-get install openjdk-8-jdk</code></li></ul><h4 id="å‘½ä»¤è¡Œä¸‹è½½-google-drive-ä¸­çš„æ–‡ä»¶"><a href="#å‘½ä»¤è¡Œä¸‹è½½-google-drive-ä¸­çš„æ–‡ä»¶" class="headerlink" title="å‘½ä»¤è¡Œä¸‹è½½ google drive ä¸­çš„æ–‡ä»¶"></a>å‘½ä»¤è¡Œä¸‹è½½ <code>google drive</code> ä¸­çš„æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --load-cookies /tmp/cookies.txt <span class="string">"https://docs.google.com/uc?export=download&amp;confirm=<span class="variable">$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=FILEID' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+)</span>.*/\1\n/p')&amp;id=FILEID"</span> -O FILENAME &amp;&amp; rm -rf /tmp/cookies.txt</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: å…¶ä¸­ <code>FILEI</code>D æ˜¯ <code>Google Drive</code> å…±äº«æ–‡ä»¶çš„<code>ID</code>ï¼Œå¯ä»¥é€šè¿‡ å³é”®-&gt;ã€è·å–å…±äº«é“¾æ¥ã€‘å¾—åˆ°ï¼Œ <code>FILENAME</code> éšæ„ </p><h4 id="terminal"><a href="#terminal" class="headerlink" title="terminal"></a>terminal</h4><p>è®¾ç½®ä»£ç†ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ALL_PROXY=socks5://127.0.0.1:1080</span><br></pre></td></tr></table></figure></p><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><p>clone æŸä¸ªåˆ†æ”¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b b1 https://github.com/...</span><br></pre></td></tr></table></figure></p><p>clone æŒ‡å®šç›®å½•:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/... directory</span><br></pre></td></tr></table></figure></p><p>git stash: å¤‡ä»½å½“å‰çš„å·¥ä½œåŒºçš„å†…å®¹ï¼Œä»æœ€è¿‘çš„ä¸€æ¬¡æäº¤ä¸­è¯»å–ç›¸å…³å†…å®¹ï¼Œè®©å·¥ä½œåŒºä¿è¯å’Œä¸Šæ¬¡æäº¤çš„å†…å®¹ä¸€è‡´ã€‚åŒæ—¶ï¼Œå°†å½“å‰çš„å·¥ä½œåŒºå†…å®¹ä¿å­˜åˆ°Gitæ ˆä¸­ã€‚</p><p>git stash pop: ä»Gitæ ˆä¸­è¯»å–æœ€è¿‘ä¸€æ¬¡ä¿å­˜çš„å†…å®¹ï¼Œæ¢å¤å·¥ä½œåŒºçš„ç›¸å…³å†…å®¹ã€‚ç”±äºå¯èƒ½å­˜åœ¨å¤šä¸ªStashçš„å†…å®¹ï¼Œæ‰€ä»¥ç”¨æ ˆæ¥ç®¡ç†ï¼Œpopä¼šä»æœ€è¿‘çš„ä¸€ä¸ªstashä¸­è¯»å–å†…å®¹å¹¶æ¢å¤ã€‚</p><h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><p>debug:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åœ¨chromeä¸­debugï¼š</span><br><span class="line">1. å®‰è£…æ’ä»¶node-inspector</span><br><span class="line">    npm install -g node-inspector</span><br><span class="line">    node-debug main.js</span><br><span class="line"></span><br><span class="line">psï¼šå¦‚æœä¸èƒ½æ­£å¸¸å®‰è£…node-inspectorï¼ŒæŠŠnpmå›é€€åˆ°5.3.0</span><br></pre></td></tr></table></figure></p><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><p>æœ€ç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">descript(<span class="string">'æ¨¡å—å'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    it(<span class="string">'æœŸå¾…çš„æ­£ç¡®è¡Œä¸ºä¸ç»“æœ'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </span><br><span class="line">        ...æµ‹è¯•ä»£ç </span><br><span class="line"></span><br><span class="line">        assert.equal(&#123;æœŸå¾…çš„ç»“æœ&#125;, &#123;å®é™…çš„ç»“æœ&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h4 id="Sinon"><a href="#Sinon" class="headerlink" title="Sinon"></a>Sinon</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¥å£ï¼šsinonå¯¹è±¡ï¼ˆå…¨å±€å¯¹è±¡ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> sandbox = sinon.sandbox.create();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•ï¼šstubï¼Œæ›¿ä»£å¯¹è±¡åŸç”Ÿçš„æ–¹æ³•ï¼Œå½“è°ƒç”¨ä¹‹åç›´æ¥è¿”å›ç»™å®šçš„ç»“æœ</span></span><br><span class="line">sandbox.stub(&#123;å¯¹è±¡&#125;, <span class="string">'æ–¹æ³•å'</span>).returns(<span class="string">'ç›´æ¥è¿”å›çš„ç»“æœ'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–æ¶ˆå¯¹æ–¹æ³•çš„ç›‘è§†</span></span><br><span class="line">sandbox.restore();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•ï¼šspyï¼Œæ¨¡æ‹Ÿä¸€ä¸ªå‡½æ•°ï¼Œè®°å½•å®ƒè¢«è°ƒç”¨çš„å‚æ•°ä»¥åŠè°ƒç”¨æ¬¡æ•°</span></span><br><span class="line"><span class="comment">// 1. åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> callback = sinon.spy();</span><br><span class="line">PubSub.subscribe(<span class="string">"message"</span>, callback);</span><br><span class="line"></span><br><span class="line">PubSub.publishSync(<span class="string">"message"</span>);</span><br><span class="line"></span><br><span class="line">assertTrue(callback.called);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åŒ…è£…ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å‡½æ•°</span></span><br><span class="line">sinon.spy(jQuery, <span class="string">'ajax'</span>);</span><br><span class="line"></span><br><span class="line">jQuery.getJSON(<span class="string">"/some/resource"</span>);</span><br><span class="line"></span><br><span class="line">assert(jQuery.ajax.calledOnce);</span><br></pre></td></tr></table></figure><h3 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h3><ul><li>å¼•å…¥cssæ–‡ä»¶ï¼š<code>@import &#39;./default.css&#39;</code></li><li>vue <code>component</code> åŠ  <code>key</code> å¯ä»¥è®©é¡µé¢é‡æ–°æ¸²æŸ“</li><li>å¼‚æ­¥ç»„ä»¶ï¼šVue å…è®¸ä»¥ä¸€ä¸ªå·¥å‚å‡½æ•°çš„æ–¹å¼å®šä¹‰ç»„ä»¶ï¼Œè¿™ä¸ªå·¥å‚å‡½æ•°ä¼šå¼‚æ­¥è§£æç»„ä»¶å®šä¹‰<code>&#39;my-component&#39;: () =&gt; import(&#39;./my-async-component&#39;)</code></li><li>è·¯ç”±æ‡’åŠ è½½ï¼šç»“åˆ <code>Vue</code> çš„å¼‚æ­¥ç»„ä»¶å’Œ <code>Webpack</code> çš„ä»£ç åˆ†å‰²åŠŸèƒ½ï¼Œè½»æ¾å®ç°è·¯ç”±ç»„ä»¶çš„æ‡’åŠ è½½ã€‚</li></ul><h4 id="Vue-cli3"><a href="#Vue-cli3" class="headerlink" title="Vue cli3"></a>Vue cli3</h4><ul><li>vue ä½¿ç”¨äº† sockjs-client/sockjs-node ä¿è¯æˆ‘ä»¬åœ¨æ”¹å®Œä»£ç é‡æ–°ç¼–è¯‘ä¹‹åï¼Œèƒ½å¤Ÿé€šçŸ¥æµè§ˆå™¨é‡æ–°åŠ è½½å˜æ›´ç»“æœã€‚<br>å¦‚æœå‡ºç° <code>WebSocket connection to &#39;ws://192.168.30.104:8080/sockjs-node/292/auzldzcy/websocket&#39; failed: WebSocket is closed before the connection is established.</code> çš„è­¦å‘Šï¼Œåˆ™æœ‰å¯èƒ½æ˜¯å¼€äº†å…¨å±€ä»£ç†</li></ul><h4 id="Vue-å…¨å±€é”™è¯¯æ•è·"><a href="#Vue-å…¨å±€é”™è¯¯æ•è·" class="headerlink" title="Vue å…¨å±€é”™è¯¯æ•è·"></a>Vue å…¨å±€é”™è¯¯æ•è·</h4><p>åœ¨vueé¡¹ç›®ä¸­ï¼Œç”¨<code>window.onerror</code> çš„æ–¹å¼æ•è·ä¸åˆ°å…¨å±€é”™è¯¯ã€‚<br>å¾—ç”¨å®˜æ–¹æä¾›çš„ <code>Vue.config.errorHandler</code> æ¥æ•è·å…¨å±€é”™è¯¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.errorHandler = <span class="function"><span class="keyword">function</span> (<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">  <span class="comment">// `info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">  <span class="comment">// åªåœ¨ 2.2.0+ å¯ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: <a href="https://cn.vuejs.org/v2/api/#errorHandler" target="_blank" rel="noopener">é“¾æ¥</a></p><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><ul><li>nrm: å¿«é€Ÿåˆ‡æ¢npmæº</li></ul><h3 id="js"><a href="#js" class="headerlink" title="js"></a>js</h3><ul><li>Arrayæ•°ç»„æ’åºæ–¹æ³•sortçš„è¿”å›å¿…é¡»æ˜¯<strong>ä¸¤ä¸ªå€¼ç›¸å‡</strong>ï¼Œä¸èƒ½æ˜¯å¤§äºå°äºç›¸æ¯”ã€‚å› ä¸ºæ’åºä¼¼ä¹ä½¿ç”¨è¿”å›å€¼å’Œ0ï¼Œ-1ï¼Œ1æ¯”è¾ƒæ¥æ’åºçš„ã€‚</li><li>é”™è¯¯è·Ÿè¸ªæ’ä»¶ï¼šsentry</li><li>es6ä¸­moduleè¯­æ³•<code>import</code>ç”¨äºé™æ€æ–‡ä»¶å¯¼å…¥ï¼ˆè¢« JavaScript å¼•æ“é™æ€åˆ†æï¼‰ï¼Œç¬¦åˆ <code>ECMAScript ææ¡ˆ</code> çš„ <code>import()</code> è¯­æ³•å¯ä»¥å®ŒæˆåŠ¨æ€åŠ è½½</li></ul><h4 id="åˆ¤æ–­æµè§ˆå™¨"><a href="#åˆ¤æ–­æµè§ˆå™¨" class="headerlink" title="åˆ¤æ–­æµè§ˆå™¨"></a>åˆ¤æ–­æµè§ˆå™¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ua = <span class="built_in">window</span>.navigator.userAgent;</span><br><span class="line"><span class="keyword">const</span> isIE = <span class="built_in">window</span>.ActiveXObject !== <span class="literal">undefined</span> &amp;&amp; ua.includes(<span class="string">'MSIE'</span>);</span><br><span class="line"><span class="keyword">const</span> isIE11 = ua.includes(<span class="string">'Trident'</span>) &amp;&amp; ua.includes(<span class="string">'rv:11.0'</span>);</span><br><span class="line"><span class="keyword">const</span> isEdge = ua.includes(<span class="string">'Edge'</span>);</span><br><span class="line"><span class="keyword">const</span> isFirefox = ua.includes(<span class="string">'Firefox'</span>);</span><br><span class="line"><span class="keyword">const</span> isChrome = (ua.includes(<span class="string">'Chrome'</span>) &amp;&amp; <span class="built_in">window</span>.chrome) || ua.match(<span class="string">'CriOS'</span>); <span class="comment">// 'CriOS'åˆ¤æ–­åœ¨ipadä¸Šæ˜¯ä¸æ˜¯chrome</span></span><br><span class="line"><span class="keyword">const</span> isSafari = ua.includes(<span class="string">'Safari'</span>) &amp;&amp; ua.includes(<span class="string">'Version'</span>);</span><br><span class="line"><span class="keyword">const</span> isQQBrower = ua.includes(<span class="string">'QQBrowser'</span>);</span><br><span class="line"><span class="keyword">const</span> is360EE = ua.includes(<span class="string">'360EE'</span>);</span><br><span class="line"><span class="keyword">const</span> is360SE = ua.includes(<span class="string">'360SE'</span>);</span><br><span class="line"><span class="keyword">const</span> isSouGou = ua.includes(<span class="string">'MetaSr'</span>);</span><br><span class="line"><span class="keyword">const</span> hasMine = navigator.mimeTypes[<span class="string">'application/vnd.chromium.remoting-viewer'</span>]; <span class="comment">// 360æµè§ˆå™¨åˆ¤æ–­(ps: ä¸ç¡®å®š)</span></span><br></pre></td></tr></table></figure><h3 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h3><ul><li>ä»£ç åˆ†å‰²åŠŸèƒ½ï¼šå½“æ¶‰åŠåˆ°åŠ¨æ€ä»£ç æ‹†åˆ†æ—¶ï¼Œwebpack æä¾›äº†ä¸¤ä¸ªç±»ä¼¼çš„æŠ€æœ¯ã€‚å¯¹äºåŠ¨æ€å¯¼å…¥ï¼Œç¬¬ä¸€ç§ï¼Œä¹Ÿæ˜¯æ¨èé€‰æ‹©çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨ç¬¦åˆ ECMAScript ææ¡ˆ çš„ import() è¯­æ³•ã€‚<code>import(&#39;path/to/module&#39;) -&gt; Promise</code></li></ul><h3 id="PM2"><a href="#PM2" class="headerlink" title="PM2"></a>PM2</h3><p>PM2æ˜¯nodeè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥ç®€åŒ–å¾ˆå¤šnodeåº”ç”¨ç®¡ç†çš„ç¹çä»»åŠ¡ï¼Œå¦‚æ€§èƒ½ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å‡è¡¡ç­‰ï¼Œè€Œä¸”ä½¿ç”¨éå¸¸ç®€å•ã€‚</p><p>å‚è€ƒï¼š<a href="http://www.cnblogs.com/chyingp/p/pm2-documentation.html" target="_blank" rel="noopener">PM2å®ç”¨å…¥é—¨æŒ‡å—</a></p><h3 id="npm-script"><a href="#npm-script" class="headerlink" title="npm script"></a>npm script</h3><p>npm è„šæœ¬æœ‰ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥ä½¿ç”¨ npm çš„å†…éƒ¨å˜é‡ã€‚<br>ä¾‹å¦‚<code>npm_package_version</code>èƒ½è·å–åˆ°é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>ç„¶åï¼Œnpm è„šæœ¬è¿˜å¯ä»¥é€šè¿‡<code>npm_config_</code>å‰ç¼€ï¼Œæ‹¿åˆ° npm çš„é…ç½®å˜é‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;node build/build.js&quot;,</span><br><span class="line">    &quot;build:axios&quot;: &quot;npm_config_axios=true npm run build&quot;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// webpack.config.js</span><br><span class="line">&#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      &apos;~services&apos;: process.env.npm_config_axios ? resolve(&apos;src/services-axios&apos;) : resolve(&apos;src/services&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ­£åˆ™"><a href="#æ­£åˆ™" class="headerlink" title="æ­£åˆ™"></a>æ­£åˆ™</h3><p>Safari ä¸æ”¯æŒæ­£åˆ™åå‘åŒ¹é…ï¼ˆ(?&lt;=\d)ï¼‰</p><h3 id="æ•°æ®åŸ‹ç‚¹-è·¨åŸŸ"><a href="#æ•°æ®åŸ‹ç‚¹-è·¨åŸŸ" class="headerlink" title="æ•°æ®åŸ‹ç‚¹ + è·¨åŸŸ"></a>æ•°æ®åŸ‹ç‚¹ + è·¨åŸŸ</h3><p>ä¸ºä»€ä¹ˆé€šå¸¸åœ¨å‘é€æ•°æ®åŸ‹ç‚¹è¯·æ±‚çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ 1x1 åƒç´ çš„é€æ˜ gif å›¾ç‰‡ï¼Ÿ</p><p>åˆ©ç”¨ç©ºç™½gifæˆ–1x1 pxçš„imgæ˜¯äº’è”ç½‘å¹¿å‘Šæˆ–ç½‘ç«™ç›‘æµ‹æ–¹é¢å¸¸ç”¨çš„æ‰‹æ®µï¼Œç®€å•ã€å®‰å…¨ã€ç›¸æ¯”PNG/JPGä½“ç§¯å°ï¼Œ1px é€æ˜å›¾ï¼Œå¯¹ç½‘é¡µå†…å®¹çš„å½±å“å‡ ä¹æ²¡æœ‰å½±å“ï¼Œè¿™ç§è¯·æ±‚ç”¨åœ¨å¾ˆå¤šåœ°æ–¹ï¼Œæ¯”å¦‚æµè§ˆã€ç‚¹å‡»ã€çƒ­ç‚¹ã€å¿ƒè·³ã€IDé¢å‘ç­‰ç­‰ï¼Œ</p><ul><li>é¿å…è·¨åŸŸï¼ˆimg å¤©ç„¶æ”¯æŒè·¨åŸŸï¼‰ï¼›æ²¡æœ‰è·¨åŸŸé—®é¢˜ï¼Œä¸€èˆ¬è¿™ç§ä¸ŠæŠ¥æ•°æ®ï¼Œä»£ç è¦å†™é€šç”¨çš„ï¼›ï¼ˆæ’é™¤ajaxï¼‰</li><li>ä¸ä¼šé˜»å¡é¡µé¢åŠ è½½ï¼Œå½±å“ç”¨æˆ·çš„ä½“éªŒï¼Œåªè¦new Imageå¯¹è±¡å°±å¥½äº†ï¼›ï¼ˆæ’é™¤JS/CSSæ–‡ä»¶èµ„æºæ–¹å¼ä¸ŠæŠ¥ï¼‰ä¸€èˆ¬æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦appendåˆ°DOMä¸­ï¼Œé€šè¿‡å®ƒçš„onerrorå’Œonloadäº‹ä»¶æ¥æ£€æµ‹å‘é€çŠ¶æ€ã€‚</li><li>åœ¨æ‰€æœ‰å›¾ç‰‡ä¸­ï¼Œä½“ç§¯æœ€å°ï¼›ï¼ˆæ¯”è¾ƒPNG/JPGï¼‰GIFçš„æœ€ä½åˆæ³•ä½“ç§¯æœ€å°ï¼ˆæœ€å°çš„BMPæ–‡ä»¶éœ€è¦74ä¸ªå­—èŠ‚ï¼ŒPNGéœ€è¦67ä¸ªå­—èŠ‚ï¼Œè€Œåˆæ³•çš„GIFï¼Œåªéœ€è¦43ä¸ªå­—èŠ‚ï¼‰</li><li>è§¦å‘ GET è¯·æ±‚ä¹‹åä¸éœ€è¦è·å–å’Œå¤„ç†æ•°æ®ã€æœåŠ¡å™¨ä¹Ÿä¸éœ€è¦å‘é€æ•°æ®</li><li>å›¾ç‰‡è¯·æ±‚ä¸å ç”¨ Ajax è¯·æ±‚é™é¢ï¼Œç›¸æ¯” XMLHttpRequest å¯¹è±¡å‘é€ GET è¯·æ±‚ï¼Œæ€§èƒ½ä¸Šæ›´å¥½</li></ul><p>é™¤äº†img å¤©ç„¶æ”¯æŒè·¨åŸŸä¹‹å¤–ï¼Œscript æ ‡ç­¾ä¹Ÿæ˜¯æ”¯æŒè·¨åŸŸçš„ï¼Œè¿™ä¹Ÿæ˜¯ <code>jsonp</code> è·¨åŸŸæ–¹æ¡ˆçš„åŸºç¡€ã€‚</p><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3><p>å˜é‡æ˜¯ä¸ªå¯¹è±¡ï¼Œå¸¦å±æ€§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Assign the project to an employee.</span><br><span class="line"> * @param &#123;Object&#125; employee - The employee who is responsible for the project.</span><br><span class="line"> * @param &#123;string&#125; employee.name - The name of the employee.</span><br><span class="line"> * @param &#123;string&#125; employee.department - The employee&apos;s department.</span><br><span class="line"> */</span><br><span class="line"> Project.prototype.assign = function(employee) &#123;    // ...&#125;;</span><br></pre></td></tr></table></figure></p><h3 id="mapæ ‡ç­¾"><a href="#mapæ ‡ç­¾" class="headerlink" title="mapæ ‡ç­¾"></a>mapæ ‡ç­¾</h3><p>ä»Šå¤©çœ‹åˆ°ä¸€æ®µä»£ç :</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"planets.jpg"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">usemap</span>=<span class="string">"#planetmap"</span> <span class="attr">alt</span>=<span class="string">"Planets"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span> <span class="attr">name</span>=<span class="string">"planetmap"</span> <span class="attr">id</span>=<span class="string">"planetmap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"circle"</span> <span class="attr">coords</span>=<span class="string">"180,139,14"</span> <span class="attr">href</span> =<span class="string">"venus.html"</span> <span class="attr">alt</span>=<span class="string">"Venus"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"circle"</span> <span class="attr">coords</span>=<span class="string">"129,161,10"</span> <span class="attr">href</span> =<span class="string">"mercur.html"</span> <span class="attr">alt</span>=<span class="string">"Mercury"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"rect"</span> <span class="attr">coords</span>=<span class="string">"0,0,110,260"</span> <span class="attr">href</span> =<span class="string">"sun.html"</span> <span class="attr">alt</span>=<span class="string">"Sun"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¿½ç„¶å‘ç°è‡ªå·±å¯¹mapæ ‡ç­¾ä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚ç„¶åå°±æŸ¥äº†ä¸‹ã€‚å‘ç°è¿™æ˜¯ä¸€ä¸ªæŒºæœ‰æ„æ€çš„æ ‡ç­¾ã€‚</p><p>å…¶å®è¿™ä¸ªæ ‡ç­¾çš„åŠŸèƒ½æ˜¯åœ¨å›¾ç‰‡çš„åŒºåŸŸå†…åˆ‡å‰²ä¸€éƒ¨åˆ†æ¥å®ç°ç‚¹å‡»å¼¹å‡ºæ–°é¡µé¢çš„åŠŸèƒ½ã€‚ä¸Šé¢ä»£ç ä¸­areaæ ‡ç­¾ä¸­çš„shapeå’Œcoordså±æ€§åˆ†åˆ«ç”¨æ¥å®šä¹‰åŒºåŸŸçš„å½¢çŠ¶å’Œå¯ç‚¹å‡»åŒºåŸŸï¼ˆå¯¹é¼ æ ‡æ•æ„Ÿçš„åŒºåŸŸï¼‰çš„åæ ‡ã€‚è€Œhrefå±æ€§å°±æ˜¯ç”¨æ¥æŒ‡å®šæ–°é¡µé¢çš„URLï¼Œå’Œaæ ‡ç­¾çš„hrefå…·æœ‰ç›¸åŒçš„æ„ä¹‰ã€‚åŒæ—¶ï¼Œareaä¹Ÿå…·æœ‰targetå±æ€§ã€‚</p><p>mapæ ‡ç­¾éœ€è¦ç»“åˆimgæ ‡ç­¾ä¸­çš„usemapå±æ€§æ¥ä½¿ç”¨ã€‚usemapä¸­çš„#planetmapæŒ‡å®šäº†è¦ä½¿ç”¨çš„mapçš„idã€‚</p><p><strong><em>æ³¨æ„</em></strong>ï¼š<code>&lt;img&gt;</code> ä¸­çš„ usemap å±æ€§å¯å¼•ç”¨ <code>&lt;map&gt;</code> ä¸­çš„ id æˆ– name å±æ€§ï¼ˆç”±æµè§ˆå™¨å†³å®šï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŒæ—¶å‘ <code>&lt;map&gt;</code> æ·»åŠ  id å’Œ name ä¸¤ä¸ªå±æ€§ã€‚</p><h3 id="çˆ¬è™«åè®®"><a href="#çˆ¬è™«åè®®" class="headerlink" title="çˆ¬è™«åè®®"></a>çˆ¬è™«åè®®</h3><p>å¦‚æœä½ å¸Œæœ›ä½ çš„ç½‘ç«™æ‰€æœ‰å†…å®¹éƒ½è¢«ç™¾åº¦çˆ¬å–ï¼Œé‚£ä¹ˆåªè¦ä¸å†™ <code>rebots.txt</code> å°±è¡Œï¼Œ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€äº›åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­getåˆ°çš„æ–°çŸ¥è¯†ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;e2e&quot;&gt;&lt;a href=&quot;#e2e&quot; class=&quot;headerlink&quot; title=&quot;e2e&quot;&gt;&lt;/a&gt;e2e&lt;/h3&gt;&lt;p&gt;e2eæˆ–è€…ç«¯åˆ°ç«¯ï¼ˆend-to-endï¼‰æˆ–è€…UIæµ‹è¯•æ˜¯ä¸€ç§æµ‹è¯•æ–¹æ³•ï¼Œå®ƒç”¨æ¥æµ‹è¯•ä¸€ä¸ªåº”ç”¨ä»å¤´åˆ°å°¾çš„æµç¨‹æ˜¯å¦å’Œè®¾è®¡æ—¶å€™æ‰€æƒ³çš„ä¸€æ ·ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä»ä¸€ä¸ªç”¨æˆ·çš„è§’åº¦å‡ºå‘ï¼Œè®¤ä¸ºæ•´ä¸ªç³»ç»Ÿéƒ½æ˜¯ä¸€ä¸ªé»‘ç®±ï¼Œåªæœ‰UIä¼šæš´éœ²ç»™ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“é“¾æ¥çœ‹ï¼š&lt;a href=&quot;http://sentsin.com/web/658.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://sentsin.com/web/658.html&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="éšç¬”" scheme="https://sampwood.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="e2e" scheme="https://sampwood.github.io/tags/e2e/"/>
    
  </entry>
  
  <entry>
    <title>prerender-vue</title>
    <link href="https://sampwood.github.io/2020/03/18/prerender-vue/"/>
    <id>https://sampwood.github.io/2020/03/18/prerender-vue/</id>
    <published>2020-03-18T08:18:03.000Z</published>
    <updated>2020-03-18T08:21:17.209Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><p>ç›®å‰å¤§éƒ¨åˆ†æ¥è§¦åˆ°çš„é¡µé¢éƒ½ä¼šä½¿ç”¨SPAæ¥å®ç°ã€‚ä½†æ˜¯SPAä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¯¹äºSEOçš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ã€‚</p><p>å¯¹äºvueé¡¹ç›®æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨nuxtä¸€æŠŠæ¢­ğŸ˜¹ã€‚<br>ä½†å¯¹äºç®€å•çš„åœºæ™¯æ¥è¯´ï¼Œå…¶å®ä¹Ÿå¯ä»¥ç”¨é¢„æ¸²æŸ“çš„æ–¹å¼æ¥åªå¯¹é¦–é¡µå’Œæ–‡æ¡£éƒ¨åˆ†åšé™æ€æ¸²æŸ“ã€‚<br>è¿™æ ·æ—¢æ»¡è¶³äº†SEOçš„æ”¯æŒï¼Œä¹Ÿå’ŒåŸæœ¬vueçš„å†™æ³•ä¸€æ ·ã€‚</p><a id="more"></a><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><h4 id="prerender-spa-plugin"><a href="#prerender-spa-plugin" class="headerlink" title="prerender-spa-plugin"></a>prerender-spa-plugin</h4><p>é¢„æ¸²æŸ“ä¾èµ– <code>prerender-spa-plugin</code> æ’ä»¶ã€‚</p><p><code>prerender-spa-plugin</code> æ˜¯ <code>webpack</code> çš„æ’ä»¶ï¼Œæ‰€ä»¥ç”¨ <code>webpack</code> æ‰“åŒ…çš„å•é¡µé¢ï¼ˆ<code>react</code>ï¼Œ<code>vue</code>ï¼Œ<code>angular</code>ç­‰ï¼‰éƒ½èƒ½ä½¿ç”¨ã€‚</p><p><code>prerender-spa-plugin</code> åŸç†å°±æ˜¯ä½¿ç”¨æµè§ˆå™¨å†…æ ¸é¢„å…ˆåŠ è½½é¡µé¢æ¸²æŸ“æ•°æ®å¾—åˆ°å®Œæ•´é¡µé¢åç”Ÿæˆå®Œæ•´çš„<code>html</code>æ–‡ä»¶ã€‚</p><h4 id="sitemap-js"><a href="#sitemap-js" class="headerlink" title="sitemap.js"></a>sitemap.js</h4><p>ç™¾åº¦çˆ¬è™«éå¸¸å–œæ¬¢Sitemapï¼ŒSitemapåè®®ä½¿ä½ èƒ½å¤Ÿå‘ŠçŸ¥æœç´¢å¼•æ“ç½‘ç«™ä¸­å¯ä¾›æŠ“å–çš„ç½‘å€ï¼Œsitemapçš„ç”Ÿæˆå°±æ˜¯è®©æœç´¢å¼•æ“æ›´å¥½çš„å»è®¿é—®ç½‘ç«™ä»è€Œç»™ç½‘ç«™çš„æ”¶å½•äº§ç”Ÿä¸€ä¸ªå¥½çš„ä½œç”¨ã€‚</p><p>æ‰€ä»¥ç”¨<code>sitemap</code> åº“æ¥è‡ªåŠ¨ç”Ÿæˆ <code>sitemap.xml</code> æ–‡ä»¶å¯¹SEOæœ‰å¾ˆå¤§å¸®åŠ©ã€‚</p><h3 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h3><h4 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add prerender-spa-plugin sitemap -D</span><br></pre></td></tr></table></figure><h4 id="å°†vue-router-modeå±æ€§æ”¹ä¸ºhistory"><a href="#å°†vue-router-modeå±æ€§æ”¹ä¸ºhistory" class="headerlink" title="å°†vue router modeå±æ€§æ”¹ä¸ºhistory"></a>å°†vue router modeå±æ€§æ”¹ä¸ºhistory</h4><p>modeå¿…é¡»ä¸ºhistoryï¼Œå¦‚æœä¸æ”¹ä¸ºhistoryï¼Œåœ¨hashæ¨¡å¼ä¸‹ï¼Œprerender-spa-pluginæ‰“åŒ…å‡ºæ¥çš„é™æ€htmlåªæœ‰é¦–é¡µçš„htmlæ˜¯å®Œæ•´çš„ï¼Œå…¶ä»–é¡µé¢è¿˜æ˜¯ç”¨çš„é¦–é¡µéª¨æ¶ï¼Œç„¶ååŠ¨æ€ç”Ÿæˆç”Ÿæˆhtmlæ›¿æ¢ï¼Œå°±è¾¾ä¸åˆ°seoçš„æ•ˆæœã€‚</p><h4 id="é…ç½®webpackæ–‡ä»¶"><a href="#é…ç½®webpackæ–‡ä»¶" class="headerlink" title="é…ç½®webpackæ–‡ä»¶"></a>é…ç½®webpackæ–‡ä»¶</h4><p>ä¿®æ”¹build/webpack.prod.conf.js æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const resolve = dir =&gt; path.join(__dirname, &apos;..&apos;, dir);</span><br><span class="line">// pre-render</span><br><span class="line">const PrerenderSPAPlugin = require(&apos;prerender-spa-plugin&apos;)</span><br><span class="line">const Renderer = PrerenderSPAPlugin.PuppeteerRenderer</span><br><span class="line">const VueLoaderPlugin = require(&apos;vue-loader/lib/plugin&apos;)</span><br><span class="line">const routes = [&apos;/&apos;] // ç¡®å®šéœ€è¦é¢„æ¸²æŸ“çš„é¡µé¢è·¯ç”±å’Œç”Ÿæˆsitemapçš„è·¯ç”±ï¼Œè¿™ä¸¤ä¸ªä¹Ÿå¯ä»¥åˆ†å¼€</span><br><span class="line">// sitemap urlå®¹å™¨</span><br><span class="line">const sitemap = require(&apos;sitemap&apos;);</span><br><span class="line">const siteMapUrls = [];</span><br><span class="line"></span><br><span class="line">const webpackConfig = merge(baseWebpackConfig, &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      // pre render</span><br><span class="line">      new PrerenderSPAPlugin(&#123;</span><br><span class="line">        staticDir: path.join(__dirname, &apos;../dist&apos;),</span><br><span class="line">        // Output directory</span><br><span class="line">        outputDir: path.join(__dirname, &apos;../dist/rendered&apos;),</span><br><span class="line">        routes,</span><br><span class="line">        postProcess (context) &#123;</span><br><span class="line">          //content å‚æ•°</span><br><span class="line">          const &#123;originalRoute, route, html&#125; = context;</span><br><span class="line">          //å°†è·¯ç”±æ·»åŠ åˆ°å…¨å±€sitemapå®¹å™¨</span><br><span class="line">          siteMapUrls.push(originalRoute);</span><br><span class="line"></span><br><span class="line">          //å½“å½“å‰è·¯ç”±ä¸ºæœ€åä¸€ä¸ªç”Ÿæˆè·¯ç”±æ—¶  </span><br><span class="line">          if (route === routes[routes.length - 1]) &#123;</span><br><span class="line">            //å»é™¤é‡å¤çš„é“¾æ¥</span><br><span class="line">            let currentSiteMapUrls = Array.from(new Set(siteMapUrls));</span><br><span class="line">            // //è¿‡æ»¤æ‰é“¾æ¥ä¸­çš„é”šç‚¹åå†…å®¹</span><br><span class="line">            currentSiteMapUrls = currentSiteMapUrls.map(url =&gt; &#123;</span><br><span class="line">              const isMao = url.indexOf(&apos;#&apos;) &gt; -1;</span><br><span class="line">              //ç”Ÿæˆsitemapæ‰€éœ€æ•°æ®ï¼Œå…·ä½“å‚æ•°å‚è¯¦sitemap.jså®˜ç½‘</span><br><span class="line">              return &#123;url: isMao ? url.split(&apos;#&apos;)[0] : url, changefreq: &apos;weekly&apos;, priority: 1, lastmod: new Date().toLocaleDateString()&#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            //ç”ŸæˆsiteMapæ–‡ä»¶</span><br><span class="line">            const sm = sitemap.createSitemap(&#123;</span><br><span class="line">              //è·¯ç”±å‰ç¼€åœ°å€ï¼Œå…¨åœ°å€è‡ªåŠ¨ä¸ä¼šæ·»åŠ hostname</span><br><span class="line">              hostname: &apos;https://matpool.com&apos;,</span><br><span class="line">              cacheTime: 600000,  //600 sec (10 min) cache purge period</span><br><span class="line">              urls: currentSiteMapUrls</span><br><span class="line">            &#125;);</span><br><span class="line">            //å°†sitemapæ–‡ä»¶æ·»åŠ æ­é…æ‰“åŒ…æ–‡ä»¶å¤¹distä¸­</span><br><span class="line">            fs.writeFileSync(resolve(&apos;dist/sitemap.xml&apos;), sm.toString());</span><br><span class="line">          &#125;</span><br><span class="line">          // è§£å†³é—ªå±é—®é¢˜</span><br><span class="line">          context.html = html.replace(&apos;id=&quot;app&quot;&apos;, &apos;id=&quot;app&quot; data-server-rendered=&quot;true&quot;&apos;);</span><br><span class="line">          //è¿”å›å½“å‰contetå¯¹è±¡</span><br><span class="line">          return context</span><br><span class="line">        &#125;,</span><br><span class="line">        renderer: new Renderer(&#123;</span><br><span class="line">          inject: &#123;</span><br><span class="line">            foo: &apos;bar&apos;</span><br><span class="line">          &#125;,</span><br><span class="line">          headless: true,</span><br><span class="line">          renderAfterDocumentEvent: &apos;render-event&apos;,</span><br><span class="line">          //puppeteerå‚æ•°ï¼Œæ ‡ç­¾æ„æ€ï¼šå®Œå…¨ä¿¡ä»»åœ¨Chromeä¸­æ‰“å¼€çš„å†…å®¹</span><br><span class="line">          args: [&apos;--no-sandbox&apos;, &apos;--disable-setuid-sandbox&apos;]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢webpackæ–‡ä»¶ä¸­ <code>postProcess</code> æ˜¯ç”¨æ¥é…åˆ<code>sitemap</code>åº“ç”Ÿæˆ<code>sitemap.xml</code>æ–‡ä»¶çš„ã€‚<br>PrerenderSPAPlugin æ’ä»¶ä¸­å…¶ä»–ä»£ç æ˜¯ç”¨æ¥ç”Ÿæˆé¢„æ¸²æŸ“é¡µé¢çš„ã€‚</p><h4 id="ä¿®æ”¹main-js"><a href="#ä¿®æ”¹main-js" class="headerlink" title="ä¿®æ”¹main.js"></a>ä¿®æ”¹main.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  i18n,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ˜¯å…³é”®ï¼Œè§¦å‘äº‹ä»¶æ¥å¼•å¯¼é¢„æ¸²æŸ“ã€‚"render-event" å¾—å’Œä¸Šé¢çš„PrerenderSPAPlugin.renderer.renderAfterDocumentEventä¸€è‡´</span></span><br><span class="line">    <span class="built_in">document</span>.dispatchEvent(<span class="keyword">new</span> Event(<span class="string">'render-event'</span>))</span><br><span class="line">  &#125;,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h3><h4 id="ä¾èµ–åŒ…ä¸èƒ½ä¸‹è½½"><a href="#ä¾èµ–åŒ…ä¸èƒ½ä¸‹è½½" class="headerlink" title="ä¾èµ–åŒ…ä¸èƒ½ä¸‹è½½"></a>ä¾èµ–åŒ…ä¸èƒ½ä¸‹è½½</h4><p><code>prerender-spa-plugin</code> ä¾èµ– google çš„ <code>puppeteer</code> åº“ã€‚æ‰€ä»¥installçš„æ—¶å€™éœ€è¦ç¿»å¢™ï¼Œæˆ–è€…è®¾ç½®æ·˜å®æºã€‚</p><h4 id="Linuxä¸èƒ½æ­£å¸¸æ‰“åŒ…"><a href="#Linuxä¸èƒ½æ­£å¸¸æ‰“åŒ…" class="headerlink" title="Linuxä¸èƒ½æ­£å¸¸æ‰“åŒ…"></a>Linuxä¸èƒ½æ­£å¸¸æ‰“åŒ…</h4><p>æœ¬åœ°æ‰“åŒ…æ²¡æœ‰é—®é¢˜ï¼ŒlinuxæœåŠ¡å™¨æ‰“åŒ…å¯èƒ½ä¼šå‡ºç°ERROR: Fail to lauunch chrome!</p><p>åŸå› ä¸€ï¼šlinux ç¯å¢ƒç¼ºå°‘ä¸€äº›<a href="https://github.com/puppeteer/puppeteer/blob/master/docs/troubleshooting.md#chrome-headless-doesnt-launch-on-unix" target="_blank" rel="noopener">ä¾èµ–</a></p><p>æ‰€ä»¥éœ€è¦å…ˆåœ¨Linuxä¸Šè£…å¥½è¿™äº›ä¾èµ–ã€‚</p><p>å› ä¸ºæˆ‘æ˜¯ç”¨dockeræ¥æ„å»ºéƒ¨ç½²çš„ï¼Œè¿™é‡Œæä¾›ä¸‹dockerfileï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">18.04</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer=<span class="string">"sampwood@163.com"</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> sed -i <span class="string">'s/archive.ubuntu.com/mirrors.aliyun.com/g'</span> /etc/apt/sources.list; \</span></span><br><span class="line"><span class="bash">  apt-get update; \</span></span><br><span class="line"><span class="bash">  DEBIAN_FRONTEND=noninteractive \</span></span><br><span class="line"><span class="bash">  apt-get install -y --no-install-recommends \</span></span><br><span class="line"><span class="bash">  ca-certificates \</span></span><br><span class="line"><span class="bash">  bash \</span></span><br><span class="line"><span class="bash">  curl \</span></span><br><span class="line"><span class="bash">  git \</span></span><br><span class="line"><span class="bash">  apt-utils</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> curl -sL https://deb.nodesource.com/setup_12.x | bash</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install -y nodejs</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> curl -sL https://sentry.io/get-cli/ | bash</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm config <span class="built_in">set</span> sass_binary_site https://npm.taobao.org/mirrors/node-sass/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install -g yarn@1.16.0 standard-version@7.1.0</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yarn config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yarn config <span class="built_in">set</span> sass_binary_site https://npm.taobao.org/mirrors/node-sass/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  apt-get update \</span></span><br><span class="line"><span class="bash">  &amp;&amp; apt-get install -y gconf-service libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget \</span></span><br><span class="line"><span class="bash">  &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure><h4 id="é—ªå±"><a href="#é—ªå±" class="headerlink" title="é—ªå±"></a>é—ªå±</h4><p>åœ¨é¢„æ¸²æŸ“æ„å»ºå®Œæˆä¹‹åï¼Œè®¿é—®é¡µé¢ï¼Œå¯èƒ½ä¼šå‡ºç°é—ªå±çš„ç°è±¡ã€‚</p><p>è§£å†³æ–¹æ³•ï¼šåœ¨ <code>PrerenderSPAPlugin.postProcess</code> ä¸­åŠ å…¥ä¸‹é¢è¿™æ®µä»£ç ï¼ˆä¸Šé¢çš„ä¾‹å­ä¸­å·²ç»åŠ äº†ï¼‰<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.html = html.replace(<span class="string">'id="app"'</span>, <span class="string">'id="app" data-server-rendered="true"'</span>);</span><br></pre></td></tr></table></figure></p><h4 id="å…¶ä»–é¡µé¢åˆ·æ–°æ—¶ä¸èƒ½æ­£å¸¸è®¿é—®"><a href="#å…¶ä»–é¡µé¢åˆ·æ–°æ—¶ä¸èƒ½æ­£å¸¸è®¿é—®" class="headerlink" title="å…¶ä»–é¡µé¢åˆ·æ–°æ—¶ä¸èƒ½æ­£å¸¸è®¿é—®"></a>å…¶ä»–é¡µé¢åˆ·æ–°æ—¶ä¸èƒ½æ­£å¸¸è®¿é—®</h4><p>åœ¨é¢„æ¸²æŸ“é¡µé¢ä¹‹å¤–çš„é¡µé¢åˆ·æ–°æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸èƒ½æ­£å¸¸æ¸²æŸ“çš„æƒ…å†µã€‚</p><p>è§£å†³æ–¹æ³•ï¼šé…ç½® <code>nginx</code> æ–‡ä»¶:<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">  <span class="section">server</span> &#123;</span><br><span class="line">    <span class="comment"># pre-rendered routes</span></span><br><span class="line">    <span class="attribute">location</span> = / &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> /rendered/index.html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># all other dynamic routes</span></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">      <span class="attribute">index</span> index.html;</span><br><span class="line">      <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œé¢çš„ <code>/rendered/</code> æ–‡ä»¶å¤¹è¦å’Œä¸Šé¢<code>webpack.prod.conf.js</code> ä¸­ <code>PrerenderSPAPlugin.outputDir</code> ä¿æŒä¸€è‡´</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://brickyang.github.io/2019/01/14/%E5%9B%BD%E5%86%85%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85-Puppeteer-%E7%9A%84%E6%96%B9%E6%B3%95/" target="_blank" rel="noopener">å›½å†…ä¸‹è½½å®‰è£… Puppeteer çš„æ–¹æ³•</a></li><li><a href="https://juejin.im/post/5dcbc2196fb9a0606f094186#heading-2" target="_blank" rel="noopener">vueé¡¹ç›®seoé—®é¢˜ç®€å•è§£å†³ï¼Œå¹¶ç”Ÿæˆsitemap</a></li><li><a href="https://github.com/puppeteer/puppeteer/blob/master/docs/troubleshooting.md" target="_blank" rel="noopener">puppeteer Troubleshooting</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;åœºæ™¯&quot;&gt;&lt;a href=&quot;#åœºæ™¯&quot; class=&quot;headerlink&quot; title=&quot;åœºæ™¯&quot;&gt;&lt;/a&gt;åœºæ™¯&lt;/h3&gt;&lt;p&gt;ç›®å‰å¤§éƒ¨åˆ†æ¥è§¦åˆ°çš„é¡µé¢éƒ½ä¼šä½¿ç”¨SPAæ¥å®ç°ã€‚ä½†æ˜¯SPAä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¯¹äºSEOçš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºvueé¡¹ç›®æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨nuxtä¸€æŠŠæ¢­ğŸ˜¹ã€‚&lt;br&gt;ä½†å¯¹äºç®€å•çš„åœºæ™¯æ¥è¯´ï¼Œå…¶å®ä¹Ÿå¯ä»¥ç”¨é¢„æ¸²æŸ“çš„æ–¹å¼æ¥åªå¯¹é¦–é¡µå’Œæ–‡æ¡£éƒ¨åˆ†åšé™æ€æ¸²æŸ“ã€‚&lt;br&gt;è¿™æ ·æ—¢æ»¡è¶³äº†SEOçš„æ”¯æŒï¼Œä¹Ÿå’ŒåŸæœ¬vueçš„å†™æ³•ä¸€æ ·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="vue" scheme="https://sampwood.github.io/categories/coding/vue/"/>
    
    
      <category term="vue" scheme="https://sampwood.github.io/tags/vue/"/>
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="seo" scheme="https://sampwood.github.io/tags/seo/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨æ¸²æŸ“</title>
    <link href="https://sampwood.github.io/2020/01/22/browser-render/"/>
    <id>https://sampwood.github.io/2020/01/22/browser-render/</id>
    <published>2020-01-22T02:53:31.000Z</published>
    <updated>2020-08-02T14:58:10.957Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨"><a href="#æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨" class="headerlink" title="æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨"></a>æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨</h3><p>åœ¨é¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰äººåœ¨å›ç­”é¡µé¢çš„ä¼˜åŒ–ä¸­æåˆ°å°†jsæ”¾åˆ°bodyæ ‡ç­¾åº•éƒ¨ï¼ŒåŸå› æ˜¯å› ä¸ºæµè§ˆå™¨ç”ŸæˆDomæ ‘çš„æ—¶å€™æ˜¯ä¸€è¡Œä¸€è¡Œè¯»HTMLä»£ç çš„ï¼Œscriptæ ‡ç­¾æ”¾åœ¨æœ€åé¢å°±ä¸ä¼šå½±å“å‰é¢çš„é¡µé¢çš„æ¸²æŸ“ã€‚<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶Domæ ‘å®Œå…¨ç”Ÿæˆå¥½åé¡µé¢æ‰èƒ½æ¸²æŸ“å‡ºæ¥ï¼Œæµè§ˆå™¨åˆå¿…é¡»è¯»å®Œå…¨éƒ¨HTMLæ‰èƒ½ç”Ÿæˆå®Œæ•´çš„Domæ ‘ï¼Œscriptæ ‡ç­¾ä¸æ”¾åœ¨bodyåº•éƒ¨æ˜¯ä¸æ˜¯ä¹Ÿä¸€æ ·ï¼Œå› ä¸ºdomæ ‘çš„ç”Ÿæˆéœ€è¦æ•´ä¸ªæ–‡æ¡£è§£æå®Œæ¯•ã€‚</p><a id="more"></a><p><img src="/images/render-screenshot.png" alt="\images\render-screenshot"></p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹chromeåœ¨é¡µé¢æ¸²æŸ“è¿‡ç¨‹ä¸­çš„ï¼Œç»¿è‰²æ ‡å¿—çº¿æ˜¯First Paintçš„æ—¶é—´ã€‚<br>çº³å°¼ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°firstpaintï¼Œé¡µé¢çš„paintä¸æ˜¯åœ¨æ¸²æŸ“æ ‘ç”Ÿæˆä¹‹åå—ï¼Ÿå…¶å®ç°ä»£æµè§ˆå™¨ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ,æ¸²æŸ“å¼•æ“å°†å°è¯•å°½å¿«åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å†…å®¹ã€‚<br>å®ƒä¸ä¼šç­‰åˆ°æ‰€æœ‰HTMLè§£æä¹‹å‰å¼€å§‹æ„å»ºå’Œå¸ƒå±€æ¸²æŸ“æ ‘ã€‚éƒ¨åˆ†çš„å†…å®¹å°†è¢«è§£æå¹¶æ˜¾ç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´æµè§ˆå™¨èƒ½å¤Ÿæ¸²æŸ“ä¸å®Œæ•´çš„domæ ‘å’Œcssomï¼Œå°½å¿«çš„å‡å°‘ç™½å±çš„æ—¶é—´ã€‚<br>å‡å¦‚æˆ‘ä»¬å°†jsæ”¾åœ¨headerï¼Œjså°†é˜»å¡è§£ædomï¼Œdomçš„å†…å®¹ä¼šå½±å“åˆ°First Paintï¼Œå¯¼è‡´First Paintå»¶åã€‚<br>æ‰€ä»¥è¯´æˆ‘ä»¬ä¼šå°†jsæ”¾åœ¨åé¢ï¼Œä»¥å‡å°‘First Paintçš„æ—¶é—´ï¼Œä½†æ˜¯ä¸ä¼šå‡å°‘DOMContentLoadedè¢«è§¦å‘çš„æ—¶é—´ã€‚</p><h3 id="ä»æµè§ˆå™¨å†…æ ¸åˆ°äº‹ä»¶å¾ªç¯"><a href="#ä»æµè§ˆå™¨å†…æ ¸åˆ°äº‹ä»¶å¾ªç¯" class="headerlink" title="ä»æµè§ˆå™¨å†…æ ¸åˆ°äº‹ä»¶å¾ªç¯"></a>ä»æµè§ˆå™¨å†…æ ¸åˆ°äº‹ä»¶å¾ªç¯</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“jsæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†jsæ˜¯æ”¯æŒå¼‚æ­¥çš„ï¼Œæ‰€ä»¥æµè§ˆå™¨å†…æ ¸å¿…ç„¶æ˜¯å¤šçº¿ç¨‹orå¤šè¿›ç¨‹çš„ã€‚é‚£ä¹ˆä½ çŸ¥é“æµè§ˆå™¨å†…æ ¸éƒ½æœ‰å“ªäº›çº¿ç¨‹æ¥æ”¯æ’‘é¡µé¢å·¥ä½œçš„å—ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹æµè§ˆå™¨çš„å¤šè¿›ç¨‹æ¶æ„å§ã€‚<br>ä»¥ Chrome ä¸ºä¾‹,å®ƒç”±å¤šä¸ªè¿›ç¨‹ç»„æˆ,æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±æ ¸å¿ƒçš„èŒè´£,å®ƒä»¬ç›¸äº’é…åˆå®Œæˆæµè§ˆå™¨çš„æ•´ä½“åŠŸèƒ½ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸­åˆåŒ…å«å¤šä¸ªçº¿ç¨‹,ä¸€ä¸ªè¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹ä¹Ÿä¼šååŒå·¥ä½œ,é…åˆå®Œæˆæ‰€åœ¨è¿›ç¨‹çš„èŒè´£ã€‚<br>Chrome é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„,å…¶é¡¶å±‚å­˜åœ¨ä¸€ä¸ª Browser process ç”¨ä»¥åè°ƒæµè§ˆå™¨çš„å…¶å®ƒè¿›ç¨‹ã€‚ï¼ˆè¯¦æƒ…çœ‹å‚è€ƒ1ï¼‰</p><p>æµè§ˆå™¨ä¸»è¦æœ‰4ä¸ªè¿›ç¨‹ï¼šä¸»è¿›ç¨‹ã€ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹ã€GPUè¿›ç¨‹ã€æ¸²æŸ“è¿›ç¨‹ã€‚<br>è€Œæ¸²æŸ“è¿›ç¨‹åˆç§°ä¸ºæµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹æˆ–æµè§ˆå™¨å†…æ ¸,å†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ã€‚ä¸»è¦è´Ÿè´£é¡µé¢æ¸²æŸ“,è„šæœ¬æ‰§è¡Œ,äº‹ä»¶å¤„ç†ç­‰ã€‚</p><p>æµè§ˆå™¨å†…æ ¸çš„çº¿ç¨‹ä¸»è¦åŒ…æ‹¬ï¼šGUIæ¸²æŸ“çº¿ç¨‹ã€JSå¼•æ“çº¿ç¨‹ã€äº‹ä»¶è§¦å‘çº¿ç¨‹ã€å®šæ—¶è§¦å‘å™¨çº¿ç¨‹ã€å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹ã€‚</p><p>çœ‹åˆ°è¿™æ˜¯ä¸æ˜¯æœ‰ä¸­ç†Ÿæ‚‰çš„æ„Ÿè§‰ï¼Œjsé™¤äº†ä¸»çº¿ç¨‹ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªå®ä»»åŠ¡å’Œä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚<br>å…¶ä¸­å®ä»»åŠ¡ï¼ˆmacrotaskï¼‰ä¸»è¦åŒ…å«ï¼šscript(æ•´ä½“ä»£ç )ã€setTimeoutã€setIntervalã€I/Oã€UIäº¤äº’äº‹ä»¶ã€postMessageã€MessageChannelã€setImmediate(Node.js ç¯å¢ƒ)ï¼Œ<br>å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ä¸»è¦åŒ…å«ï¼šPromise.thenã€MutaionObserverã€process.nextTick(Node.js ç¯å¢ƒ)ã€‚</p><p>è¿™é‡Œé¢setTimeoutã€ setInterval æ˜¯ä¸æ˜¯å°±æ˜¯å¯¹åº”çš„ <code>å®šæ—¶è§¦å‘å™¨çº¿ç¨‹</code> å‘¢ï¼Ÿ<br>UIäº¤äº’äº‹ä»¶ å¯¹åº” <code>äº‹ä»¶è§¦å‘çº¿ç¨‹</code>ï¼Ÿ xhr å¯¹åº” <code>å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹</code> ï¼Ÿ</p><p>è¿™ä¹ˆå¯¹ç…§ç€æ¥çœ‹ï¼Œå°±èƒ½å¾ˆå¥½çš„åŒºåˆ†å¼€å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ã€‚</p><p>jsæ—¶é—´å¾ªç¯çš„è¿è¡Œæœºåˆ¶æ˜¯ï¼š</p><ul><li>æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼ˆæ ˆä¸­æ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰</li><li>æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±å°†å®ƒæ·»åŠ åˆ°å¾®ä»»åŠ¡çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­</li><li>å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡ï¼ˆä¾æ¬¡æ‰§è¡Œï¼‰</li><li>å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå¼€å§‹æ£€æŸ¥æ¸²æŸ“ï¼Œç„¶åGUIçº¿ç¨‹æ¥ç®¡æ¸²æŸ“</li><li>æ¸²æŸ“å®Œæ¯•åï¼ŒJSçº¿ç¨‹ç»§ç»­æ¥ç®¡ï¼Œå¼€å§‹ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰</li></ul><p>å…¶ä¸­promise æ„é€ å‡½æ•°çš„å†…å®¹æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œthen ä¸­çš„å‡½æ•°ä¼šè¢«æ”¾åˆ°å¯¹åº”çš„å¾®ä»»åŠ¡åˆ—è¡¨ä¸­ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://juejin.im/post/5e143104e51d45414a4715f7" target="_blank" rel="noopener">ä» 8 é“é¢è¯•é¢˜çœ‹æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ä¸æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="https://www.cnblogs.com/caizhenbo/p/6679478.html" target="_blank" rel="noopener">DOMContentLoadedä¸loadçš„åŒºåˆ«</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/DOMContentLoaded" target="_blank" rel="noopener">DOMContentLoaded</a></li><li><a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/7" target="_blank" rel="noopener">ç¬¬ 10 é¢˜ï¼šå¸¸è§å¼‚æ­¥ç¬”è¯•é¢˜ï¼Œè¯·å†™å‡ºä»£ç çš„è¿è¡Œç»“æœ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨&quot;&gt;&lt;a href=&quot;#æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨&quot; class=&quot;headerlink&quot; title=&quot;æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨&quot;&gt;&lt;/a&gt;æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†cssæ”¾åœ¨å¤´éƒ¨ï¼Œå°†jsæ–‡ä»¶æ”¾åœ¨å°¾éƒ¨&lt;/h3&gt;&lt;p&gt;åœ¨é¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰äººåœ¨å›ç­”é¡µé¢çš„ä¼˜åŒ–ä¸­æåˆ°å°†jsæ”¾åˆ°bodyæ ‡ç­¾åº•éƒ¨ï¼ŒåŸå› æ˜¯å› ä¸ºæµè§ˆå™¨ç”ŸæˆDomæ ‘çš„æ—¶å€™æ˜¯ä¸€è¡Œä¸€è¡Œè¯»HTMLä»£ç çš„ï¼Œscriptæ ‡ç­¾æ”¾åœ¨æœ€åé¢å°±ä¸ä¼šå½±å“å‰é¢çš„é¡µé¢çš„æ¸²æŸ“ã€‚&lt;br&gt;é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶Domæ ‘å®Œå…¨ç”Ÿæˆå¥½åé¡µé¢æ‰èƒ½æ¸²æŸ“å‡ºæ¥ï¼Œæµè§ˆå™¨åˆå¿…é¡»è¯»å®Œå…¨éƒ¨HTMLæ‰èƒ½ç”Ÿæˆå®Œæ•´çš„Domæ ‘ï¼Œscriptæ ‡ç­¾ä¸æ”¾åœ¨bodyåº•éƒ¨æ˜¯ä¸æ˜¯ä¹Ÿä¸€æ ·ï¼Œå› ä¸ºdomæ ‘çš„ç”Ÿæˆéœ€è¦æ•´ä¸ªæ–‡æ¡£è§£æå®Œæ¯•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="browser" scheme="https://sampwood.github.io/categories/coding/browser/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="https://sampwood.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>mongodbæ•°æ®è¿ç§»</title>
    <link href="https://sampwood.github.io/2020/01/03/mongodb-data-migration/"/>
    <id>https://sampwood.github.io/2020/01/03/mongodb-data-migration/</id>
    <published>2020-01-03T03:27:31.000Z</published>
    <updated>2020-01-03T04:33:44.042Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™å‡ å¤©æ¢æœåŠ¡å™¨ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šçš„<code>mongodb</code>å°±éœ€è¦åšä¸€ä¸‹æ•°æ®è¿ç§»ã€‚åœ¨æ­¤è®°å½•ä¸‹æ–¹æ³•ã€‚</p><h3 id="æ•°æ®å¤‡ä»½"><a href="#æ•°æ®å¤‡ä»½" class="headerlink" title="æ•°æ®å¤‡ä»½"></a>æ•°æ®å¤‡ä»½</h3><p>åœ¨<code>mongodb</code>ä¸­ä½¿ç”¨<code>mongodump</code>å‘½ä»¤æ¥å¤‡ä»½æ•°æ®ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongodump -h localhost:27017 -d <span class="built_in">test</span> -o /path/to/mongobackups</span><br></pre></td></tr></table></figure></p><a id="more"></a><p><strong>NOTE</strong>: <code>test</code> æ˜¯è¦å¤‡ä»½çš„æ•°æ®åº“å®ä¾‹åç§°</p><h3 id="æ•°æ®è¿˜åŸ"><a href="#æ•°æ®è¿˜åŸ" class="headerlink" title="æ•°æ®è¿˜åŸ"></a>æ•°æ®è¿˜åŸ</h3><p>åœ¨<code>mongodb</code>ä¸­ä½¿ç”¨<code>mongorestore</code>å‘½ä»¤æ¥æ¢å¤å¤‡ä»½æ•°æ®ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongorestore -h [remote host]:27017 -d <span class="built_in">test</span> /path/to/mongobackups</span><br></pre></td></tr></table></figure></p><p><strong>NOTE</strong>: å¦‚æœè¦è®©<code>mongodb</code> ç›‘å¬å…¬ç½‘ip, è®¾ç½®<code>/etc/mongod.conf</code> ä¸­ <code>bindIp: 0.0.0.0</code></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://xiangsugar.github.io/2018/06/24/MongoDB%E4%B8%8D%E5%90%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB/" target="_blank" rel="noopener">MongoDBä¸åŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®è¿ç§»</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‡ å¤©æ¢æœåŠ¡å™¨ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šçš„&lt;code&gt;mongodb&lt;/code&gt;å°±éœ€è¦åšä¸€ä¸‹æ•°æ®è¿ç§»ã€‚åœ¨æ­¤è®°å½•ä¸‹æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ•°æ®å¤‡ä»½&quot;&gt;&lt;a href=&quot;#æ•°æ®å¤‡ä»½&quot; class=&quot;headerlink&quot; title=&quot;æ•°æ®å¤‡ä»½&quot;&gt;&lt;/a&gt;æ•°æ®å¤‡ä»½&lt;/h3&gt;&lt;p&gt;åœ¨&lt;code&gt;mongodb&lt;/code&gt;ä¸­ä½¿ç”¨&lt;code&gt;mongodump&lt;/code&gt;å‘½ä»¤æ¥å¤‡ä»½æ•°æ®ï¼š&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mongodump -h localhost:27017 -d &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt; -o /path/to/mongobackups&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="database" scheme="https://sampwood.github.io/categories/coding/database/"/>
    
    
      <category term="mongodb" scheme="https://sampwood.github.io/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>cool-css</title>
    <link href="https://sampwood.github.io/2019/12/26/cool-css/"/>
    <id>https://sampwood.github.io/2019/12/26/cool-css/</id>
    <published>2019-12-26T02:30:26.000Z</published>
    <updated>2019-12-26T02:34:51.696Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªç‚«é…·çš„cssåŠ¨ç”»ï¼Œä»”ç»†é˜…è¯»äº†ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œè™½ç„¶ä¸šåŠ¡åœºæ™¯ä¸Šä¸å¤ªç”¨çš„åˆ°ï¼Œè¿™é‡Œåšä¸‹è®°å½•ã€‚</p><p>ä¸»è¦æ˜¯ç”¨äº†<code>filter</code>è¿™ä¸ªå±æ€§ã€‚</p><p><a href="https://mp.weixin.qq.com/s/N2i9M8m4WsmdL-uYZwer5Q" target="_blank" rel="noopener">ã€ç¬¬1816æœŸã€‘å·§ç”¨ CSS å®ç°é…·ç‚«çš„å……ç”µåŠ¨ç”»</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªç‚«é…·çš„cssåŠ¨ç”»ï¼Œä»”ç»†é˜…è¯»äº†ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œè™½ç„¶ä¸šåŠ¡åœºæ™¯ä¸Šä¸å¤ªç”¨çš„åˆ°ï¼Œè¿™é‡Œåšä¸‹è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦æ˜¯ç”¨äº†&lt;code&gt;filter&lt;/code&gt;è¿™ä¸ªå±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/N2i9M
      
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="css" scheme="https://sampwood.github.io/categories/coding/css/"/>
    
    
      <category term="css" scheme="https://sampwood.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>åˆè¯†QuickJS</title>
    <link href="https://sampwood.github.io/2019/11/27/new-quickjs/"/>
    <id>https://sampwood.github.io/2019/11/27/new-quickjs/</id>
    <published>2019-11-27T07:00:34.000Z</published>
    <updated>2019-11-27T07:07:04.965Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©äº†è§£åˆ°ä¸€ä¸ªç‰›é€¼çš„ä¸œè¥¿ï¼š<a href="https://bellard.org/quickjs/" target="_blank" rel="noopener">quikcjs</a>ã€‚</p><p>å‰æ®µæ—¶é—´åŒäº‹è¿˜åœ¨è¯´æœ‰æ²¡æœ‰jsè½¬å¯æ‰§è¡Œæ–‡ä»¶çš„åº“ã€‚å¯æƒœçŸ¥é“çš„æ™šäº†ç‚¹ï¼Œä¸ç„¶å¯ä»¥è®©ä»–ä»¬è¯•è¯•è¿™ä¸ªã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»Šå¤©äº†è§£åˆ°ä¸€ä¸ªç‰›é€¼çš„ä¸œè¥¿ï¼š&lt;a href=&quot;https://bellard.org/quickjs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;quikcjs&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‰æ®µæ—¶é—´åŒäº‹è¿˜åœ¨è¯´æœ‰æ²¡æœ‰jsè½¬å¯æ‰§è¡Œæ–‡ä»¶çš„åº“ã€‚å¯æƒœçŸ¥é“çš„æ™šäº†ç‚¹ï¼Œä¸ç„¶
      
    
    </summary>
    
      <category term="éšç¬”" scheme="https://sampwood.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="js" scheme="https://sampwood.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>webç«¯çš„éŸ³é¢‘æµ</title>
    <link href="https://sampwood.github.io/2019/10/25/stream-web/"/>
    <id>https://sampwood.github.io/2019/10/25/stream-web/</id>
    <published>2019-10-25T01:39:09.000Z</published>
    <updated>2019-12-30T07:26:27.385Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„é¢˜ç›®ï¼šæ€ä¹ˆä½¿ç”¨HTML5å®ç°å½•éŸ³çš„åŠŸèƒ½ï¼Ÿ</p><p>ç„¶åè¯•ç€äº†è§£äº†ä¸‹ï¼Œå®ç°åŸç†ä¸»è¦æ˜¯ç”¨äº†<code>MediaStream</code>è¿™ä¸ªå¯¹è±¡ã€‚</p><blockquote><p>The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks.<br>Each track is specified as an instance of MediaStreamTrack.<br>You can obtain a MediaStream object either by using the constructor or by calling MediaDevices.getUserMedia().</p></blockquote><p>è¿™æ˜¯æ¥è‡ª<code>MDNæ–‡æ¡£</code> å¯¹ <code>MediaStream</code> çš„è¯´æ˜ã€‚</p><p>ä»ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ <code>MediaDevices.getUserMedia()</code> æ–¹æ³•æ¥è·å–è®¾å¤‡çš„éŸ³é¢‘è¾“å…¥åŠŸèƒ½ã€‚</p><a id="more"></a><h3 id="è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½"><a href="#è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½" class="headerlink" title="è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½"></a>è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½</h3><blockquote><p>The MediaDevices.getUserMedia() method prompts the user for permission to use a media input<br>which produces a MediaStream with tracks containing the requested types of media.<br>That stream can include, for example,<br>a video track (produced by either a hardware or virtual video source such as a camera, video recording device, screen sharing service, and so forth),<br>an audio track (similarly, produced by a physical or virtual audio source like a microphone, A/D converter, or the like), and possibly other track types.</p></blockquote><p>è¿™æ˜¯æ¥è‡ª<code>MDNæ–‡æ¡£</code>çš„è¯´æ˜ã€‚</p><p><code>MediaDevices.getUserMedia()</code> è¿™ä¸ªæ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>constraints</code> , æ¥æŒ‡å®šå¯¹è¯­éŸ³/è§†é¢‘çš„é™åˆ¶ï¼Œä¾‹å¦‚ï¼š <code>{ audio: true, video: true }</code></p><p>ç„¶åå‚è€ƒå®ƒæä¾›çš„demoï¼Œå†™äº†ä¸ª å®æ—¶å½•éŸ³å¹¶æ’­æ”¾çš„åŠŸèƒ½ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"padding: 50px;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Older browsers might not implement mediaDevices at all, so we set an empty object first</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (navigator.mediaDevices === <span class="literal">undefined</span>) &#123;</span></span><br><span class="line"><span class="undefined">      navigator.mediaDevices = &#123;&#125;;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Some browsers partially implement mediaDevices. We can't just assign an object</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// with getUserMedia as it would overwrite existing properties.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Here, we will just add the getUserMedia property if it's missing.</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (navigator.mediaDevices.getUserMedia === <span class="literal">undefined</span>) &#123;</span></span><br><span class="line"><span class="javascript">      navigator.mediaDevices.getUserMedia = <span class="function"><span class="keyword">function</span>(<span class="params">constraints</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// First get ahold of the legacy getUserMedia, if present</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// Some browsers just don't implement it - return a rejected promise with an error</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// to keep a consistent interface</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (!getUserMedia) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'getUserMedia is not implemented in this browser'</span>));</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// Otherwise, wrap the call to the old navigator.getUserMedia with a Promise</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">          getUserMedia.call(navigator, constraints, resolve, reject);</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    navigator.mediaDevices.getUserMedia(&#123; <span class="attr">audio</span>: <span class="literal">true</span>, <span class="attr">video</span>: <span class="literal">false</span> &#125;)</span></span><br><span class="line"><span class="javascript">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">stream</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// Older browsers may not have srcObject</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (<span class="string">"srcObject"</span> <span class="keyword">in</span> audio) &#123;</span></span><br><span class="line"><span class="undefined">        audio.srcObject = stream;</span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// Avoid using this in new browsers, as it is going away.</span></span></span><br><span class="line"><span class="javascript">        audio.src = <span class="built_in">window</span>.URL.createObjectURL(stream);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="javascript">      audio.onloadedmetadata = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">        audio.play();</span></span><br><span class="line"><span class="undefined">      &#125;;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="javascript">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(err.name + <span class="string">": "</span> + err.message);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šå¯ä»¥çœ‹å‡ºï¼Œåªè¦æŠŠ <code>audio.srcObject</code> è®¾ç½®æˆè·å–åˆ°çš„ <code>stream</code> å°±å¯ä»¥æ’­æ”¾å½•éŸ³äº†ã€‚</p><h3 id="å¦‚ä½•åœæ­¢å½•éŸ³"><a href="#å¦‚ä½•åœæ­¢å½•éŸ³" class="headerlink" title="å¦‚ä½•åœæ­¢å½•éŸ³"></a>å¦‚ä½•åœæ­¢å½•éŸ³</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†éŸ³é¢‘æµçš„è¾“å…¥å’Œè¾“å‡ºã€‚ä½†æ˜¯è¿™ä¸ª <code>audio</code> çš„æš‚åœä¼¼ä¹åªæ§åˆ¶äº†éŸ³é¢‘çš„è¾“å‡ºï¼Œé‚£å¦‚ä½•åœæ­¢éŸ³é¢‘çš„è¾“å…¥å‘¢ï¼Ÿ<br><code>MediaStream</code> æœ¬èº«æ²¡æœ‰æä¾› <code>stop/end</code> ä¹‹ç±»çš„æ–¹æ³•ã€‚</p><p>ä»<code>MediaStream</code> çš„è¯´æ˜ä¸­ï¼Œå¯ä»¥çœ‹å‡º <code>MediaStream</code> æ˜¯ç”± <code>MediaStreamTrack</code> ç»„æˆçš„ã€‚</p><blockquote><p>The MediaStreamTrack interface represents a single media track within a stream;<br>typically, these are audio or video tracks, but other track types may exist as well.</p></blockquote><p><code>MediaStreamTrack</code> æä¾›äº† <code>stop</code> æ–¹æ³•ï¼š</p><blockquote><p>Stops playing the source associated to the track, both the source and the track are deassociated. The track state is set to ended.</p></blockquote><blockquote><p>Calling stop() tells the user agent that the trackâ€™s sourceâ€”whatever that source may be, including files, network streams, or a local camera or microphoneâ€”is no longer needed by the MediaStreamTrack.  Since multiple tracks may use the same source (for example, if two tabs are using the deviceâ€™s microphone), the source itself isnâ€™t necessarily immediately stopped. It is instead disassociated from the track and the track object is stopped. Once no media tracks are using the source, the source may actually be completely stopped.</p></blockquote><blockquote><p>Immediately after calling stop(), the track state is set to ended.</p></blockquote><p>æ‰€ä»¥åœæ­¢å½•éŸ³çš„æ–¹æ³•æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stream.getTracks().forEach(<span class="function"><span class="keyword">function</span>(<span class="params">track</span>) </span>&#123;</span><br><span class="line">  track.stop();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="éŸ³é¢‘æµçš„ä¿å­˜"><a href="#éŸ³é¢‘æµçš„ä¿å­˜" class="headerlink" title="éŸ³é¢‘æµçš„ä¿å­˜"></a>éŸ³é¢‘æµçš„ä¿å­˜</h3><p>å½“æˆ‘ä»¬è°ƒç”¨äº†è®¾å¤‡çš„éº¦å…‹é£ä¹‹åï¼Œå¾—åˆ°äº† <code>stream</code>ã€‚é€šè¿‡ <code>audio</code> æ ‡ç­¾å®ç°äº† <code>stream</code> çš„è¾“å‡ºã€‚æ­¤æ—¶å¦‚æœè¦æŠŠå¾—åˆ°è¿™æ®µ<code>stream</code> ä¿å­˜ä¸‹æ¥è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ</p><blockquote><p>The MediaStream Recording API, sometimes simply referred to as the Media Recording API or the MediaRecorder API, is closely affiliated with the Media Capture and Streams API and the WebRTC API. The MediaStream Recording API makes it possible to capture the data generated by a MediaStream or HTMLMediaElement object for analysis, processing, or saving to disk. Itâ€™s also surprisingly easy to work with.</p></blockquote><blockquote><p>The MediaStream Recording API is comprised of a single major interface, MediaRecorder, which does all the work of taking the data from a MediaStream and delivering it to you for processing. The data is delivered by a series of dataavailable events, already in the format you specify when creating the MediaRecorder. You can then process the data further or write it to file as desired.</p></blockquote><p>åŸæ¥è¿˜æœ‰ä¸ª <code>MediaRecorder</code> ç”¨ä»¥å®Œæˆæ•°æ®çš„ä¿å­˜ğŸ˜„</p><p>å‚è€ƒ<code>MDN</code> æä¾›çš„demoï¼Œå®ç°éŸ³é¢‘çš„ä¿å­˜å’Œé‡æ’­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> recordedChunks = []</span><br><span class="line"><span class="keyword">const</span> mediaRecorder = <span class="keyword">new</span> MediaRecorder(stream) <span class="comment">// stream å°±æ˜¯æˆ‘ä»¬å‰é¢è·å–åˆ°çš„ stream</span></span><br><span class="line"></span><br><span class="line">mediaRecorder.ondataavailable = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  recordedChunks.push(e.data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mediaRecorder.onstop = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> blob = <span class="keyword">new</span> Blob(recordedChunks, &#123; <span class="string">'type'</span> : <span class="string">'audio/ogg; codecs=opus'</span> &#125;)</span><br><span class="line">  <span class="keyword">const</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>) <span class="comment">// æˆ–è€…å…¶ä»–çš„ audio å¯¹è±¡</span></span><br><span class="line">  audio.src = URL.createObjectURL(blob)</span><br><span class="line">  audio.srcObject = <span class="literal">null</span> <span class="comment">// å¦‚æœä¹‹å‰çš„ audioè®¾ç½®äº† srcObject åˆ™éœ€è¦åœ¨æ­¤å¤„è®¾ç½®ä¸ºnullï¼›å¦åˆ™ä¸éœ€è¦æ¬¡æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mediaRecorder.start() <span class="comment">// å¼€å§‹è®°å½•</span></span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  mediaRecorder.stop() <span class="comment">// ç»“æŸè®°å½•</span></span><br><span class="line">&#125;, <span class="number">5000</span>) <span class="comment">// è‡ªå®šä¹‰5såç»“æŸè®°å½•ï¼Œæˆ–è€…æ‰‹åŠ¨ç»“æŸ</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¦ä¸‹è½½çš„è¯ï¼Œåªéœ€æŠŠä¸Šé¢åˆ›å»ºçš„ <code>url</code> æ”¾åˆ° <code>a</code> æ ‡ç­¾ä¸­å°±å¯å®ç°ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API" target="_blank" rel="noopener">Media Capture and Streams API (Media Stream)</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" target="_blank" rel="noopener">MediaDevices.getUserMedia()</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/stop" target="_blank" rel="noopener">MediaStreamTrack.stop()</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API" target="_blank" rel="noopener">MediaStream Recording API</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„é¢˜ç›®ï¼šæ€ä¹ˆä½¿ç”¨HTML5å®ç°å½•éŸ³çš„åŠŸèƒ½ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç„¶åè¯•ç€äº†è§£äº†ä¸‹ï¼Œå®ç°åŸç†ä¸»è¦æ˜¯ç”¨äº†&lt;code&gt;MediaStream&lt;/code&gt;è¿™ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks.&lt;br&gt;Each track is specified as an instance of MediaStreamTrack.&lt;br&gt;You can obtain a MediaStream object either by using the constructor or by calling MediaDevices.getUserMedia().&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯æ¥è‡ª&lt;code&gt;MDNæ–‡æ¡£&lt;/code&gt; å¯¹ &lt;code&gt;MediaStream&lt;/code&gt; çš„è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;MediaDevices.getUserMedia()&lt;/code&gt; æ–¹æ³•æ¥è·å–è®¾å¤‡çš„éŸ³é¢‘è¾“å…¥åŠŸèƒ½ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="html" scheme="https://sampwood.github.io/categories/coding/html/"/>
    
    
      <category term="html5" scheme="https://sampwood.github.io/tags/html5/"/>
    
  </entry>
  
  <entry>
    <title>å¼•å…¥stylelintå¯¹é¡¹ç›®åšä»£ç æ ·å¼å®¡æŸ¥</title>
    <link href="https://sampwood.github.io/2019/10/09/stylelint/"/>
    <id>https://sampwood.github.io/2019/10/09/stylelint/</id>
    <published>2019-10-09T03:05:09.000Z</published>
    <updated>2019-10-12T03:32:50.336Z</updated>
    
    <content type="html"><![CDATA[<p>æ—©å°±çœ‹åˆ°<code>stylelint</code> çš„ä»‹ç»æ–‡ç« ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚å› ä¸ºæ‡’ï¼Œè¿™å‡ å¤©æ‰æ¥å…¥äº†è¿™ä¸ªæ ·å¼æ£€æŸ¥çš„å·¥å…·ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹å¦‚ä½•å¼•å…¥è¿™ä¸ªåº“å§ã€‚</p><h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><p>å®‰è£…ç›¸å…³ä¾èµ–åº“<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add stylelint stylelint-config-standard stylelint-config-prettier</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>ä»è¿™é‡Œçœ‹å¥½åƒå¹¶æ²¡æœ‰å®‰è£…<code>webpack</code>ç›¸å…³çš„<code>plugin</code>å•Šï¼Œéš¾é“é›†æˆåˆ°<code>webpack</code>ä¸­ä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿ</p><p>è¿™é‡Œå°±ä¸å¾—ä¸è¯´ä¸‹äº†ï¼Œåœ¨<a href="https://vue-loader.vuejs.org/zh/guide/linting.html#eslint" target="_blank" rel="noopener">Vue Loader-ä»£ç æ ¡éªŒ (Linting)</a>ä¸­æœ‰ä»‹ç»å¦‚ä½•é›†æˆ<br><code>stylelint</code> åˆ° <code>webpack</code>ï¼Œåšè‡ªåŠ¨åŒ–æ£€æµ‹ã€‚</p><p>ä½†æ˜¯è¿™ä¸ªé…ç½®å…¶å®ä¸é€‚ç”¨åœ¨ç”±<code>vue cli3</code>ç”Ÿæˆçš„é¡¹ç›®ä¸­ã€‚é…ç½®<code>stylelint-webpack-plugin</code>æ’ä»¶åˆ°<code>vue.config.js</code>ä¸­ä¹‹åï¼Œé¡¹ç›®è¿è¡Œä¸èµ·æ¥ã€‚ğŸ˜£</p><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><h4 id="è§„åˆ™æ–‡ä»¶"><a href="#è§„åˆ™æ–‡ä»¶" class="headerlink" title="è§„åˆ™æ–‡ä»¶"></a>è§„åˆ™æ–‡ä»¶</h4><p>æ–°å»ºè§„åˆ™æ–‡ä»¶ï¼š<code>.stylelintrc.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [</span><br><span class="line">    <span class="string">'stylelint-config-standard'</span>,</span><br><span class="line">    <span class="string">'stylelint-config-prettier'</span></span><br><span class="line">  ],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'rule-empty-line-before'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'at-rule-empty-line-before'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'no-descending-specificity'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'font-family-no-missing-generic-family-keyword'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'max-empty-lines'</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">'block-opening-brace-space-before'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'indentation'</span>: [<span class="number">2</span>],</span><br><span class="line">    <span class="string">'function-comma-space-after'</span>: <span class="string">'always-single-line'</span>,</span><br><span class="line">    <span class="string">'selector-list-comma-newline-after'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'value-list-comma-newline-after'</span>: <span class="string">'always-multi-line'</span>,</span><br><span class="line">    <span class="string">'declaration-block-trailing-semicolon'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'declaration-colon-space-after'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'color-hex-case'</span>: <span class="string">'lower'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å› ä¸ºæˆ‘åœ¨é¡¹ç›®ç”¨äº†<code>prettier</code> æ¥æ ¼å¼åŒ–jsä»£ç ï¼Œä¸ºäº†ä¿è¯å…¶ä¸<code>stylelint</code> ä¸å†²çªï¼Œæˆ‘<code>extends</code>äº†<code>stylelint-config-prettier</code>ã€‚<br>è¿™æ ·æˆ‘å°±ä¸å¾—ä¸åŠ ä¸€äº›è‡ªå®šä¹‰çš„<code>rules</code>äº†ã€‚å› ä¸º<code>stylelint-config-prettier</code>çš„è§„åˆ™çœŸçš„å¾ˆå¼±ï¼Œå¾ˆå¤šéƒ½ä¸æ£€æŸ¥ã€‚</p><p>å½“ç„¶å¦‚æœè¦å¿½ç•¥æŸäº›æ–‡ä»¶ï¼Œå¯ä»¥å»ºä¸€ä¸ª<code>.stylelintignore</code>æ–‡ä»¶ã€‚</p><h4 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h4><p>åœ¨<code>package.json</code> ä¸­å®šä¹‰<code>script</code>æ¥è‡ªåŠ¨è¿è¡Œç›‘æµ‹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    "lint": "vue-cli-service lint", // vue cli3ç”Ÿäº§é¡¹ç›®è‡ªå¸¦çš„</span><br><span class="line">    "lint:style": "stylelint 'public/index.html' 'src/**/*.&#123;css,less,vue&#125;'", //æ–°åŠ çš„</span><br><span class="line">  &#125;,</span><br><span class="line">  "lint-staged": &#123;</span><br><span class="line">    "*.&#123;js,vue&#125;": [ // è¿™ä¸ªæ˜¯prettierç”¨çš„ï¼Œå¦‚æœæ²¡æœ‰åœ¨é¡¹ç›®ç”¨prettierï¼Œå°±ä¸éœ€è¦è¿™ä¸ª</span><br><span class="line">      "vue-cli-service lint",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ],</span><br><span class="line">    "*.&#123;html,vue,css,less&#125;": [ // è¿™ä¸ªæ˜¯stylelintç”¨çš„</span><br><span class="line">      "stylelint 'public/index.html' 'src/**/*.&#123;css,less,vue&#125;' --fix",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®<code>package.json</code>æ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥æ‰‹åŠ¨è¿è¡Œ<code>yarn lint:style</code>æ¥æ£€æŸ¥æ ·å¼ä»£ç äº†ï¼Œæˆ–è€…<code>yarn lint:style --fix</code>æ¥è‡ªåŠ¨çŸ«æ­£</p><p>åœ¨<code>lint-staged</code>ä¸­åŠ çš„ä»£ç ï¼Œæ˜¯ä¸ºäº†èƒ½åœ¨ä»£ç <code>git commit</code>ä¹‹å‰è‡ªåŠ¨åšä¸€ä¸ªæ£€æŸ¥ï¼Œä¹Ÿå°±ä¸éœ€è¦æ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘å‘½ä»¤äº†ã€‚</p><h3 id="vscodeå·¥å…·"><a href="#vscodeå·¥å…·" class="headerlink" title="vscodeå·¥å…·"></a>vscodeå·¥å…·</h3><p>åœ¨<code>vscode</code>ä¸­å®‰è£…<code>stylelint</code>æ’ä»¶ï¼ŒæŒ‰ç…§ä»–çš„è¦æ±‚ä¿®æ”¹ä¸‹<code>settings.json</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"css.validate": false,</span><br><span class="line">"less.validate": false,</span><br><span class="line">"scss.validate": false</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæ’ä»¶ç›®å‰è¿˜ä¸æ”¯æŒåœ¨ä¿å­˜æ—¶è‡ªåŠ¨fixã€‚<code>stylelint-plus</code>å¯ä»¥ï¼Œä½†æ˜¯ä¸‹è½½é‡è¿˜æ˜¯è¾ƒå°‘</p><p>Soï¼Œåˆ°æ­¤ï¼Œå¼•å…¥<code>stylelint</code>æˆåŠŸã€‚ğŸ‘ğŸ‘ğŸ‘</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://stylelint.io/" target="_blank" rel="noopener">stylelintå®˜ç½‘</a></li><li><a href="https://prettier.io/docs/en/integrating-with-linters.html#recommended-configuration-2" target="_blank" rel="noopener">prettier-Integrating with Linters</a></li><li><a href="https://vue-loader.vuejs.org/zh/guide/linting.html#eslint" target="_blank" rel="noopener">Vue Loader-ä»£ç æ ¡éªŒ (Linting)</a></li><li><a href="https://segmentfault.com/a/1190000008708473" target="_blank" rel="noopener">å¼•å…¥stylelintå¯¹CSS/Sassåšä»£ç å®¡æŸ¥</a></li><li><a href="https://juejin.im/post/5c31c9a16fb9a049f8197000" target="_blank" rel="noopener">å¦‚ä½•ä¸ºä½ çš„ Vue é¡¹ç›®æ·»åŠ é…ç½® Stylelint</a></li><li><a href="https://segmentfault.com/a/1190000020168436" target="_blank" rel="noopener">åœ¨Vueé¡¹ç›®ä¸­ä½¿ç”¨Eslint+Prettier+Stylelint</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ—©å°±çœ‹åˆ°&lt;code&gt;stylelint&lt;/code&gt; çš„ä»‹ç»æ–‡ç« ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚å› ä¸ºæ‡’ï¼Œè¿™å‡ å¤©æ‰æ¥å…¥äº†è¿™ä¸ªæ ·å¼æ£€æŸ¥çš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹å¦‚ä½•å¼•å…¥è¿™ä¸ªåº“å§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h3&gt;&lt;p&gt;å®‰è£…ç›¸å…³ä¾èµ–åº“&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yarn add stylelint stylelint-config-standard stylelint-config-prettier&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="css" scheme="https://sampwood.github.io/categories/coding/css/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="css" scheme="https://sampwood.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘é¡µæ€§èƒ½ä¼˜åŒ–</title>
    <link href="https://sampwood.github.io/2019/10/08/web-performance/"/>
    <id>https://sampwood.github.io/2019/10/08/web-performance/</id>
    <published>2019-10-08T10:47:33.000Z</published>
    <updated>2019-10-08T10:49:40.311Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸‹ç›®å‰äº†è§£çš„ä¸€äº›ä¼˜åŒ–ç½‘é¡µæ€§èƒ½çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆæ¬¡åŠ è½½æ—¶é—´ç­‰ã€‚</p><h3 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h3><p>ç›®å‰å¼€å‘çš„é¡¹ç›®éƒ½æ˜¯ <code>vue</code> é¡¹ç›®ï¼Œ<code>vue cli3</code> é»˜è®¤ä½¿ç”¨ <code>webpack</code> æ‰“åŒ…ï¼Œæ‰€ä»¥ä» <code>webpack</code> æ–¹é¢å…¥æ‰‹ä¼˜åŒ–é¡¹ç›®æ˜¯ä¸ªæŒºå¥½çš„è§’åº¦ã€‚</p><h4 id="preload-prefetch"><a href="#preload-prefetch" class="headerlink" title="preload prefetch"></a>preload prefetch</h4><p>å¯åŠ¨ä¸€ä¸ª <code>vue cli3</code> åˆ›å»ºçš„é¡¹ç›®ï¼Œå‘ç°åœ¨ <code>network</code> ä¸­å¤šäº†å¾ˆå¤šçš„è¯·æ±‚ï¼Œç‰¹æ®Šçš„è¯·æ±‚ã€‚è¿™äº›è¯·æ±‚è¢«å½’ç±»åˆ° <code>other</code> ä¸­ã€‚<br>è€Œä¸”è¿™äº›èµ„æºè¢«è¯·æ±‚äº†ä¸¤æ¬¡ã€‚</p><p>æŸ¥æ‰¾äº†ä¸‹èµ„æ–™å‘ç°ï¼ŒåŸæ¥æ˜¯å› ä¸ºè¿™äº› <code>other</code> èµ„æºä½¿ç”¨äº† <code>preload</code> æˆ– <code>prefetch</code>ã€‚</p><p>é‚£è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><a id="more"></a><h5 id="preload"><a href="#preload" class="headerlink" title="preload"></a>preload</h5><p><code>preload</code> æŒ‡ä»¤è®©æµè§ˆå™¨ä»¥<strong>é«˜ä¼˜ç§€çº§</strong>é¢„åŠ è½½æŒ‡å®šçš„èµ„æºã€‚æµè§ˆå™¨åœ¨é‡åˆ°<code>preload</code> åä¼šå·²å¼‚æ­¥çš„æ–¹å¼ä¸‹è½½èµ„æºï¼Œä¹Ÿä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ã€‚</p><p>åœ¨ä¸‹è½½å®Œæˆä¹‹åå­˜åœ¨å†…å­˜ä¸­ï¼Œåœ¨é¡µé¢è§£æåˆ°scriptåŠ è½½çš„æ—¶å€™ï¼Œç›´æ¥è¯»å–æ‰§è¡Œã€‚</p><p>ä½†æ˜¯å‡å¦‚ä½ åœ¨å½“å‰é¡µé¢æ²¡æœ‰ç”¨åˆ°<code>preload</code> çš„èµ„æºï¼ŒChrome ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šã€‚</p><p>è¿™å…¶å®æ˜¯<code>preload</code> å’Œ <code>prefetch</code> çš„åŒºåˆ«ã€‚<br><code>preload</code> æ˜¯ä»¥<code>é«˜ä¼˜å…ˆçº§</code>å»åŠ è½½å½“å‰é¡µé¢å°†è¦ä½¿ç”¨çš„èµ„æºï¼Œè€Œ<code>prefetch</code> æ˜¯ä»¥<code>ä½ä¼˜å…ˆçº§</code>å»åŠ è½½ä¸‹ä¸ªé¡µé¢å°†ä¼šä½¿ç”¨åˆ°çš„èµ„æºã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"/main.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="prefetch"><a href="#prefetch" class="headerlink" title="prefetch"></a>prefetch</h5><p><code>Prefetch</code> æ˜¯ä¸€ä¸ªä½ä¼˜å…ˆçº§çš„èµ„æºæç¤ºï¼Œå…è®¸æµè§ˆå™¨åœ¨<strong>åå°ï¼ˆç©ºé—²æ—¶ï¼‰</strong>è·å–å°†æ¥å¯èƒ½ç”¨å¾—åˆ°çš„èµ„æºï¼Œå¹¶ä¸”å°†ä»–ä»¬å­˜å‚¨åœ¨æµè§ˆå™¨çš„ç¼“å­˜ä¸­ã€‚<br>ä¸€æ—¦ä¸€ä¸ªé¡µé¢åŠ è½½å®Œæ¯•å°±ä¼šå¼€å§‹ä¸‹è½½å…¶ä»–çš„èµ„æºï¼Œç„¶åå½“ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªå¸¦æœ‰ prefetched çš„è¿æ¥ï¼Œå®ƒå°†å¯ä»¥ç«‹åˆ»ä»ç¼“å­˜ä¸­åŠ è½½å†…å®¹ã€‚<br>æœ‰ä¸‰ç§ä¸åŒçš„ <code>prefetch</code> çš„ç±»å‹ï¼Œ<code>link</code>ï¼Œ<code>DNS</code> å’Œ <code>prerender</code>ï¼Œä¸‹é¢æ¥è¯¦ç»†åˆ†æã€‚</p><p><code>link</code> ç”¨äºåŠ è½½èµ„æºï¼Œ<code>DNS</code> ç”¨äºè§£æDNSï¼Œ<code>prerender</code> ç”¨äºæ¸²æŸ“é¡µé¢ã€‚</p><h5 id="é¢„å…ˆè§£æDNS"><a href="#é¢„å…ˆè§£æDNS" class="headerlink" title="é¢„å…ˆè§£æDNS"></a>é¢„å…ˆè§£æDNS</h5><p><code>DNS prefetching</code> å…è®¸æµè§ˆå™¨åœ¨ç”¨æˆ·æµè§ˆé¡µé¢æ—¶åœ¨åå°è¿è¡Œ DNS çš„è§£æã€‚å¦‚æ­¤ä¸€æ¥ï¼Œ<code>DNS</code> çš„è§£æåœ¨ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æ—¶å·²ç»å®Œæˆï¼Œæ‰€ä»¥å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚<br>å¯ä»¥åœ¨ä¸€ä¸ª <code>link</code> æ ‡ç­¾çš„å±æ€§ä¸­æ·»åŠ  <code>rel=&quot;dns-prefetch&#39;</code> æ¥å¯¹æŒ‡å®šçš„ <code>URL</code> è¿›è¡Œ <code>DNS prefetching</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨headæ ‡ç­¾ä¸­ï¼Œè¶Šæ—©è¶Šå¥½--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"https://cdn.bootcss.com/"</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="preconnect"><a href="#preconnect" class="headerlink" title="preconnect"></a>preconnect</h5><p><code>preconnect</code> å…è®¸æµè§ˆå™¨åœ¨ä¸€ä¸ª <code>HTTP</code> è¯·æ±‚æ­£å¼å‘ç»™æœåŠ¡å™¨å‰é¢„å…ˆæ‰§è¡Œä¸€äº›æ“ä½œï¼Œè¿™åŒ…æ‹¬ <code>DNS</code> è§£æï¼Œ<code>TLS</code> åå•†ï¼Œ<code>TCP</code> æ¡æ‰‹ï¼Œè¿™æ¶ˆé™¤äº†å¾€è¿”å»¶è¿Ÿå¹¶ä¸ºç”¨æˆ·èŠ‚çœäº†æ—¶é—´ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.domain.com"</span> <span class="attr">rel</span>=<span class="string">"preconnect"</span> <span class="attr">crossorigin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="deferå’Œasync"><a href="#deferå’Œasync" class="headerlink" title="deferå’Œasync"></a>deferå’Œasync</h4><p>æ—¢ç„¶è¯´åˆ°èµ„æºçš„åŠ è½½ï¼Œå°±ä¸å¾—ä¸è¯´åˆ°jsæ–‡ä»¶çš„å¼‚æ­¥åŠ è½½ã€‚</p><p><code>defer</code> å’Œ <code>async</code> æ˜¯scriptæ ‡ç­¾çš„ä¸¤ä¸ªå±æ€§ï¼Œç”¨äºåœ¨ä¸é˜»å¡é¡µé¢æ–‡æ¡£è§£æçš„å‰æä¸‹ï¼Œæ§åˆ¶è„šæœ¬çš„ä¸‹è½½å’Œæ‰§è¡Œã€‚</p><p><code>defer</code> çš„æ‰§è¡Œæ—¶é—´æ˜¯åœ¨æ‰€æœ‰å…ƒç´ è§£æå®Œæˆä¹‹åï¼Œ<code>DOMContentLoaded</code> äº‹ä»¶è§¦å‘ä¹‹å‰ã€‚</p><p><code>async</code> çš„æ‰§è¡Œæ—¶é—´æ˜¯åœ¨å½“å‰JSè„šæœ¬ä¸‹è½½å®Œæˆåï¼Œæ‰€ä»¥å¤šä¸ª<code>async</code> scriptæ˜¯æ‰§è¡Œé¡ºåºæ˜¯ä¸å›ºå®šçš„ã€‚<code>async</code> åªèƒ½ç”¨äºåŠ è½½ä¸€äº›ç‹¬ç«‹æ— ä¾èµ–çš„ä»£ç ï¼Œæ¯”å¦‚Google Analysisä¹‹ç±»ã€‚</p><p><img src="/images/script-load.png" alt="script-load"></p><p>æ‰€ä»¥ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç»“æ„å¦‚ä¸‹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Faster<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//cdn.com/"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"//cdn.com/"</span> <span class="attr">rel</span>=<span class="string">"preconnect"</span> <span class="attr">crossorigin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part1.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part2.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part3.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"prefetch"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/prefetch.js"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part1.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part2.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part3.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="vue-config-js"><a href="#vue-config-js" class="headerlink" title="vue.config.js"></a>vue.config.js</h4><p>é€šè¿‡è‡ªå®šä¹‰chunks æŠŠç¬¬ä¸‰æ–¹åŒ…å•ç‹¬æ‰“åŒ…ï¼Œæ¥å‡å°å…¥å£åŒ…çš„å¤§å°ã€‚</p><p>åœ¨<code>vue.config.js</code> ä¸­è®¾ç½®ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºæ˜¯å¤šé¡µé¢ï¼Œæ‰€ä»¥å–æ¶ˆ chunksï¼Œæ¯ä¸ªé¡µé¢åªå¯¹åº”ä¸€ä¸ªå•ç‹¬çš„ JS / CSS</span></span><br><span class="line">    config.optimization.splitChunks(&#123;</span><br><span class="line">      chunks: <span class="string">'all'</span>,</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        elementUI: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'element-ui'</span>,</span><br><span class="line">          test: <span class="regexp">/element-ui/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        xlsx: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'xlsx'</span>,</span><br><span class="line">          test: <span class="regexp">/xlsx/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        moment: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'moment'</span>,</span><br><span class="line">          test: <span class="regexp">/moment/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    config.optimization.runtimeChunk = &#123;</span><br><span class="line">      name: <span class="string">'manifest'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ‡’åŠ è½½æ¨¡å—çš„ prefetch preloadï¼Œé™ä½å¸¦å®½å‹åŠ›</span></span><br><span class="line">    <span class="comment">// config.plugins.delete('prefetch').delete('preload')</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å°±åƒä¸Šé¢å†™çš„ï¼Œè¿˜å¯ä»¥æŠŠ<code>prefetch</code> å’Œ <code>preload</code> åˆ é™¤, æ¥å‡å°‘æœåŠ¡å™¨å’Œå¸¦å®½çš„å‹åŠ›</p><h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><p>å¯¹äºæŸäº›ä¸å¸¸å˜åŠ¨ï¼Œæœ‰æ¯”ä»·åºå¤§çš„ç¬¬ä¸‰æ–¹åº“æ¥è¯´ï¼ˆä¾‹å¦‚ï¼šechartsï¼‰ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨CDNèµ„æºï¼Œæ¥å‡å°‘æœåŠ¡å™¨å‹åŠ›ã€‚<br>å¦‚æœæœ¬èº«æœåŠ¡å™¨è®¿é—®ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæˆ–è€…æ²¡æœ‰åšè¿‡åŠ é€Ÿå¤„ç†ï¼Œè¿˜æ˜¯å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç½‘é¡µè®¿é—®é€Ÿåº¦çš„ã€‚</p><p>è€Œä¸” <code>webpack</code> ä¹Ÿæ”¯æŒé€šè¿‡é…ç½®å¼•å…¥å¤–éƒ¨æ¨¡å—å¯¼å…¥ã€‚</p><p>å…·ä½“åšæ³•æ˜¯ï¼š</p><p>é¦–å…ˆåœ¨ <code>index.html</code> ä¸­å¼•å…¥ <code>echarts</code> çš„å¤–éƒ¨CDNï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;!-- others --&gt;</span><br><span class="line">    &lt;link rel=<span class="string">"preload"</span> href=<span class="string">"https://cdn.bootcss.com/echarts/4.2.1/echarts.min.js"</span> <span class="keyword">as</span>=<span class="string">"script"</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">  &lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!-- others --&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;!-- åŠ è½½echart --&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script type="text/</span>javascript<span class="string">" src="</span>https:<span class="comment">//cdn.bootcss.com/echarts/4.2.1/echarts.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line">  &lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ <code>vue.config.js</code> ä¸­ï¼Œåšå¦‚ä¸‹æ”¹åŠ¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    externals: &#123;</span><br><span class="line">      echarts: <span class="string">'echarts'</span> <span class="comment">// echarts ä»å¤–éƒ¨CDNä¸­åŠ è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½"><a href="#ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½" class="headerlink" title="ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½"></a>ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½</h3><p>é’ˆå¯¹æŸäº›å¤§çš„ä¾èµ–åº“ï¼Œå¦‚æœèƒ½æŒ‰éœ€åŠ è½½ï¼Œä¹Ÿå¯æé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚</p><h4 id="element-uiæŒ‰éœ€åŠ è½½"><a href="#element-uiæŒ‰éœ€åŠ è½½" class="headerlink" title="element-uiæŒ‰éœ€åŠ è½½"></a>element-uiæŒ‰éœ€åŠ è½½</h4><p><code>element-ui</code> å®˜ç½‘æœ‰æŒ‰éœ€åŠ è½½çš„<a href="https://element.eleme.cn/#/zh-CN/component/quickstart" target="_blank" rel="noopener">æ–‡æ¡£</a>.<br>æŒ‰ç…§è¯´æ˜é…ç½®ä¸‹é¡¹ç›®ã€‚</p><p>é¦–å…ˆï¼Œå®‰è£…<code>babel-plugin-component</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-plugin-component -D</span><br></pre></td></tr></table></figure></p><p>ç„¶åä¿®æ”¹ <code>babel.config.js</code> æ–‡ä»¶ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [<span class="string">'@vue/app'</span>],</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'component'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        libraryName: <span class="string">'element-ui'</span>,</span><br><span class="line">        styleLibraryName: <span class="string">'theme-chalk'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åå°±æ˜¯åœ¨ <code>src/main.js</code> ä¸­æŒ‰éœ€å¼•å…¥ç»„ä»¶ã€‚</p><h3 id="æ·»åŠ éª¨æ¶å±"><a href="#æ·»åŠ éª¨æ¶å±" class="headerlink" title="æ·»åŠ éª¨æ¶å±"></a>æ·»åŠ éª¨æ¶å±</h3><p>æ·»åŠ éª¨æ¶å±èƒ½è®©é¡µé¢æ›´å¿«çš„å‡ºç°å†…å®¹ï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚</p><p>ä¾‹å¦‚è¿™æ ·çš„ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éª¨æ¶å±çš„æ ·å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">      body &#123;</span></span><br><span class="line"><span class="undefined">        margin: 0;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 100vh;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f4f5f5</span>;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 97px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#132462</span>,<span class="selector-id">#0f1839</span>);</span></span><br><span class="line"><span class="css">        <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.1</span>);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header__content</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 100%;</span></span><br><span class="line"><span class="undefined">        max-width: 1200px;</span></span><br><span class="line"><span class="undefined">        margin: auto;</span></span><br><span class="line"><span class="undefined">        display: flex;</span></span><br><span class="line"><span class="undefined">        align-items: center;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header__content</span> <span class="selector-class">.mp-skeleton-bar</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#0d1a48</span>,<span class="selector-id">#152a75</span>,<span class="selector-id">#0d1a48</span>);</span></span><br><span class="line"><span class="undefined">        height: 28px;</span></span><br><span class="line"><span class="undefined">        border-radius: 3px;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-container</span> &#123;</span></span><br><span class="line"><span class="undefined">        box-sizing: border-box;</span></span><br><span class="line"><span class="undefined">        height: 120px;</span></span><br><span class="line"><span class="undefined">        max-width: 1200px;</span></span><br><span class="line"><span class="undefined">        margin: auto;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="undefined">        margin-top: 52px;</span></span><br><span class="line"><span class="undefined">        border-radius: 3px;</span></span><br><span class="line"><span class="undefined">        padding: 4px 20px;</span></span><br><span class="line"><span class="undefined">        overflow: hidden;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 16px;</span></span><br><span class="line"><span class="undefined">        margin: 16px 0;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#fff</span>,<span class="selector-id">#edeff1</span>,<span class="selector-id">#fff</span>);</span></span><br><span class="line"><span class="undefined">        background-size: 480px 480px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">animation</span>: <span class="selector-tag">skeleton-stripes-data</span> <span class="selector-class">.6s</span> <span class="selector-tag">linear</span> <span class="selector-tag">infinite</span>;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:first-of-type</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 40%;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:nth-of-type(2)</span>, <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:nth-of-type(3)</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 80%;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">o</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>We're sorry but matpool doesn't work properly without JavaScript enabled. Please enable it to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éª¨æ¶å…ƒç´  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"skeleton"</span> <span class="attr">class</span>=<span class="string">"mp-skeleton"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-header__content"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000011577248" target="_blank" rel="noopener">å¸¦ä½ ç©è½¬prefetch, preload, dns-prefetchï¼Œdeferå’Œasync</a></li><li><a href="https://github.com/fi3ework/blog/issues/32" target="_blank" rel="noopener">[è¯‘] èµ„æºæç¤º â€”â€” ä»€ä¹ˆæ˜¯ Preloadï¼ŒPrefetch å’Œ Preconnectï¼Ÿ</a></li><li><a href="https://juejin.im/post/5b0033c9518825056508075f" target="_blank" rel="noopener">è®°ä¸€æ¬¡vue+element+echartsé¡¹ç›®çš„ä¼˜åŒ–ï¼ˆå¦‚ä½•è½»æ¾å°†é¡¹ç›®æ€§èƒ½æå‡70%ï¼‰</a></li><li><a href="https://blog.csdn.net/jiaojiao51290/article/details/81381668" target="_blank" rel="noopener">Vueé¡¹ç›®ä½¿ç”¨CDNä¼˜åŒ–åŠ è½½</a></li><li><a href="https://segmentfault.com/a/1190000016178566#articleHeader3" target="_blank" rel="noopener">vue-cli3.0 èµ„æºåŠ è½½çš„ä¼˜åŒ–æ–¹æ¡ˆ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸‹ç›®å‰äº†è§£çš„ä¸€äº›ä¼˜åŒ–ç½‘é¡µæ€§èƒ½çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆæ¬¡åŠ è½½æ—¶é—´ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;webpack&quot;&gt;&lt;a href=&quot;#webpack&quot; class=&quot;headerlink&quot; title=&quot;webpack&quot;&gt;&lt;/a&gt;webpack&lt;/h3&gt;&lt;p&gt;ç›®å‰å¼€å‘çš„é¡¹ç›®éƒ½æ˜¯ &lt;code&gt;vue&lt;/code&gt; é¡¹ç›®ï¼Œ&lt;code&gt;vue cli3&lt;/code&gt; é»˜è®¤ä½¿ç”¨ &lt;code&gt;webpack&lt;/code&gt; æ‰“åŒ…ï¼Œæ‰€ä»¥ä» &lt;code&gt;webpack&lt;/code&gt; æ–¹é¢å…¥æ‰‹ä¼˜åŒ–é¡¹ç›®æ˜¯ä¸ªæŒºå¥½çš„è§’åº¦ã€‚&lt;/p&gt;
&lt;h4 id=&quot;preload-prefetch&quot;&gt;&lt;a href=&quot;#preload-prefetch&quot; class=&quot;headerlink&quot; title=&quot;preload prefetch&quot;&gt;&lt;/a&gt;preload prefetch&lt;/h4&gt;&lt;p&gt;å¯åŠ¨ä¸€ä¸ª &lt;code&gt;vue cli3&lt;/code&gt; åˆ›å»ºçš„é¡¹ç›®ï¼Œå‘ç°åœ¨ &lt;code&gt;network&lt;/code&gt; ä¸­å¤šäº†å¾ˆå¤šçš„è¯·æ±‚ï¼Œç‰¹æ®Šçš„è¯·æ±‚ã€‚è¿™äº›è¯·æ±‚è¢«å½’ç±»åˆ° &lt;code&gt;other&lt;/code&gt; ä¸­ã€‚&lt;br&gt;è€Œä¸”è¿™äº›èµ„æºè¢«è¯·æ±‚äº†ä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥æ‰¾äº†ä¸‹èµ„æ–™å‘ç°ï¼ŒåŸæ¥æ˜¯å› ä¸ºè¿™äº› &lt;code&gt;other&lt;/code&gt; èµ„æºä½¿ç”¨äº† &lt;code&gt;preload&lt;/code&gt; æˆ– &lt;code&gt;prefetch&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="vue" scheme="https://sampwood.github.io/categories/coding/vue/"/>
    
    
      <category term="vue" scheme="https://sampwood.github.io/tags/vue/"/>
    
      <category term="æ€§èƒ½" scheme="https://sampwood.github.io/tags/%E6%80%A7%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡ç½‘é¡µå¼€å‘ç¬”è®°</title>
    <link href="https://sampwood.github.io/2019/08/19/wechat-web/"/>
    <id>https://sampwood.github.io/2019/08/19/wechat-web/</id>
    <published>2019-08-19T15:39:06.000Z</published>
    <updated>2019-08-19T15:45:11.569Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™å‡ å¤©å¼€å‘äº†ä¸€ä¸ªå¾®ä¿¡æœåŠ¡å·ï¼Œä¹Ÿç®—æ˜¯å…¥é—¨äº†ï¼Œçºªå½•ä¸‹å…¶ä¸­çš„è¿‡ç¨‹å’Œé‡åˆ°çš„å‘ã€‚</p><h3 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h3><p>è¦åœ¨å¾®ä¿¡çš„å¹³å°ä¸Šè¿›è¡Œå¼€å‘ï¼Œéœ€è¦ä¸€äº›åŸºç¡€çš„ç¯å¢ƒã€‚å…¶ä¸­åŒ…æ‹¬ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼ŒæœåŠ¡å™¨ï¼ŒåŸŸåã€‚</p><h4 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h4><p>åŸŸåéœ€è¦å¤‡æ¡ˆï¼Œä¸”éœ€è¦é…ç½®åœ¨ <code>å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„â€œå¼€å‘ - æ¥å£æƒé™ - ç½‘é¡µæœåŠ¡ - ç½‘é¡µå¸å· - ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€çš„é…ç½®é€‰é¡¹ä¸­</code></p><p>åŸŸåçš„é…ç½®éœ€è¦éªŒè¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®ä¸‹ <code>nginx</code> å°±å¯ä»¥äº†ã€‚</p><p>å½“ç„¶æœ¬åœ°å¼€å‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½æ—¶æ—¶å‘å¸ƒçš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹æœ¬åœ° <code>host</code> çš„æ–¹å¼æ¥å¿«é€Ÿå¼€å‘ã€‚</p><a id="more"></a><h4 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h4><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¾®ä¿¡æä¾›äº†ä¸€ä¸ª <code>å¾®ä¿¡webå¼€å‘è€…å·¥å…·</code> ï¼ˆæ¡Œé¢åº”ç”¨ï¼‰ï¼Œç”¨äºå¼€å‘å’Œè°ƒè¯•åŸºäºå¾®ä¿¡çš„ç½‘é¡µã€‚</p><p>æ­£å¸¸å¼€å‘ç§»åŠ¨ç«¯åªè¦åœ¨æµè§ˆå™¨ä¸­é€‰ç”¨ <code>å“åº”å¼å¼€å‘å·¥å…·</code> å°±å¯ä»¥åˆ‡æ¢åˆ° ç§»åŠ¨ç«¯çš„æœºå‹ã€‚<br>æ‰€ä»¥ï¼Œè¿™ä¸ªå¾®ä¿¡å¼€å‘å·¥å…·ä¸»è¦çš„ä»·å€¼æ˜¯ä½“ç°åœ¨<strong>å®ƒèƒ½å¦‚åŒå¾®ä¿¡ä¸€æ ·è·å–ç”¨æˆ·æˆæƒï¼Œä»è€Œæ‹¿åˆ°éƒ¨åˆ†ç”¨æˆ·ä¿¡æ¯</strong>ã€‚</p><p>è¦ä½¿ç”¨å¼€å‘å·¥å…·ï¼Œè¿˜å¾—æŠŠè‡ªå·±åŠ åˆ° <code>å¾®ä¿¡å…¬ä¼—å¹³å°-å¼€å‘-å¼€å‘è€…å·¥å…·-webå¼€å‘è€…å·¥å…·-å¼€å‘è€…å¾®ä¿¡å·</code> ä¸­ã€‚</p><h4 id="js-sdk"><a href="#js-sdk" class="headerlink" title="js-sdk"></a>js-sdk</h4><p>å’Œä¸Šé¢å·®ä¸å¤šï¼Œæ­£å¸¸çš„ç§»åŠ¨ç«¯å¼€å‘æ˜¯ç”¨ä¸ä¸Š <code>å¾®ä¿¡js-sdk</code> çš„ã€‚</p><p>å®ƒçš„ä½œç”¨æ˜¯èƒ½é€šè¿‡ <code>js</code> è°ƒç”¨ä¸€äº›ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šè‡ªå®šä¹‰åˆ†äº«å†…å®¹ï¼Œå›¾åƒæ¥å£ï¼Œåœ°ç†ä½ç½®ç­‰ã€‚</p><p>è¿™æ¬¡å¼€å‘çš„åŠŸèƒ½åªç”¨åˆ°äº† <code>è‡ªå®šä¹‰åˆ†äº«å†…å®¹</code> çš„åŠŸèƒ½ã€‚ï¼ˆPSï¼šå°±æ˜¯è¿™ä¸ªåˆ†äº«ç•¥å‘ï¼Œå‘äº†æˆ‘ä¸€å¤©æ—¶é—´ã€‚åé¢å†ç»†è¯´ï¼‰</p><h4 id="æ ·å¼åº“"><a href="#æ ·å¼åº“" class="headerlink" title="æ ·å¼åº“"></a>æ ·å¼åº“</h4><p>å¾®ä¿¡æœ‰æä¾›ä¸€å¥—webæ ·å¼åº“- <code>weui</code>ï¼Œå¦‚æœæ²¡æœ‰è®¾è®¡æˆ–è€…è®¾è®¡é£æ ¼è´´è¿‘å¾®ä¿¡çš„å¯ä»¥ç”¨ä¸€ä¸‹ï¼Œæˆ–è€…å‚è€ƒä¸‹å®ƒçš„ç»„ä»¶è®¾è®¡ã€‚</p><p>å› ä¸ºè¿™æ¬¡è®¾è®¡é£æ ¼å’Œè¿™ä¸ªæ ·å¼åº“å·®å¾ˆå¤šï¼Œè€Œä¸”é¡µé¢ä¹Ÿæ¯”è¾ƒå°‘ã€‚æ‰€ä»¥å°±éƒ½è‡ªå·±ç”»äº†ã€‚</p><h3 id="å¾®ä¿¡ç½‘é¡µæˆæƒ"><a href="#å¾®ä¿¡ç½‘é¡µæˆæƒ" class="headerlink" title="å¾®ä¿¡ç½‘é¡µæˆæƒ"></a>å¾®ä¿¡ç½‘é¡µæˆæƒ</h3><blockquote><p>å¦‚æœç”¨æˆ·åœ¨å¾®ä¿¡å®¢æˆ·ç«¯ä¸­è®¿é—®ç¬¬ä¸‰æ–¹ç½‘é¡µï¼Œå…¬ä¼—å·å¯ä»¥é€šè¿‡å¾®ä¿¡ç½‘é¡µæˆæƒæœºåˆ¶ï¼Œæ¥è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼Œè¿›è€Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚</p></blockquote><p>è¿™è¾¹åªè¯´ä¸‹å‰ç«¯çš„é€»è¾‘ã€‚</p><p>ç½‘é¡µæˆæƒçš„é€»è¾‘ï¼š</p><ol><li>ç”¨æˆ·åŒæ„æˆæƒï¼Œè·å–codeï¼› ä¹Ÿå°±æ˜¯æ‰“å¼€ç‰¹å®šçš„å¾®ä¿¡é¡µé¢ï¼Œç„¶åå¾®ä¿¡ä¼šè·³è½¬åˆ°æˆ‘ä»¬è®¾å®šçš„ <code>redirect_uri</code> ä¸Šï¼Œ<br>å¹¶ä¸”é€šè¿‡ <code>$route.query.code</code> æ¥è¿”å› <code>code</code></li><li>é€šè¿‡ <code>code</code> æ¢å–ç½‘é¡µæˆæƒ <code>access_token</code>ã€‚é€šè¿‡ <code>access_token</code> æ‹‰å–ç”¨æˆ·ä¿¡æ¯ã€‚<br>è¿™æ­¥æ˜¯åç«¯æ¥å®ç°çš„ï¼Œæ‰€ä»¥å‰ç«¯åªè¦é€šè¿‡è°ƒç”¨åç«¯æ¥å£å°±è¡Œäº†ã€‚ğŸ˜Š</li></ol><p>ç”¨æˆ·ä¿¡æ¯åŒ…å«ï¼šåŸå¸‚ï¼Œçœï¼Œå›½å®¶ï¼Œå¤´åƒï¼Œæ˜µç§°ï¼Œæ€§åˆ«ï¼Œopenid</p><h3 id="js-sdk-ä¹‹è‡ªå®šä¹‰åˆ†äº«"><a href="#js-sdk-ä¹‹è‡ªå®šä¹‰åˆ†äº«" class="headerlink" title="js-sdk ä¹‹è‡ªå®šä¹‰åˆ†äº«"></a><code>js-sdk</code> ä¹‹è‡ªå®šä¹‰åˆ†äº«</h3><blockquote><p>å¾®ä¿¡JS-SDKæ˜¯å¾®ä¿¡å…¬ä¼—å¹³å° é¢å‘ç½‘é¡µå¼€å‘è€…æä¾›çš„åŸºäºå¾®ä¿¡å†…çš„ç½‘é¡µå¼€å‘å·¥å…·åŒ…ã€‚</p></blockquote><h4 id="js-sdkä½¿ç”¨æ­¥éª¤"><a href="#js-sdkä½¿ç”¨æ­¥éª¤" class="headerlink" title="js-sdkä½¿ç”¨æ­¥éª¤"></a>js-sdkä½¿ç”¨æ­¥éª¤</h4><ol><li>å¼•å…¥jsæ–‡ä»¶ï¼šï¼ˆæ”¯æŒhttpsï¼‰ï¼š<a href="http://res.wx.qq.com/open/js/jweixin-1.4.0.js" target="_blank" rel="noopener">http://res.wx.qq.com/open/js/jweixin-1.4.0.js</a></li><li>æ³¨å…¥æƒé™éªŒè¯é…ç½®</li></ol><blockquote><p>æ‰€æœ‰éœ€è¦ä½¿ç”¨JS-SDKçš„é¡µé¢å¿…é¡»å…ˆæ³¨å…¥é…ç½®ä¿¡æ¯ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨ï¼ˆåŒä¸€ä¸ªurlä»…éœ€è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹äºå˜åŒ–urlçš„SPAçš„web appå¯åœ¨æ¯æ¬¡urlå˜åŒ–æ—¶è¿›è¡Œè°ƒç”¨)</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wx.config(&#123;</span><br><span class="line">    debug: <span class="literal">true</span>, <span class="comment">// å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚</span></span><br><span class="line">    appId: <span class="string">''</span>, <span class="comment">// å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    timestamp: , <span class="comment">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³</span></span><br><span class="line">    nonceStr: <span class="string">''</span>, <span class="comment">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸²</span></span><br><span class="line">    signature: <span class="string">''</span>,<span class="comment">// å¿…å¡«ï¼Œç­¾å</span></span><br><span class="line">    jsApiList: [] <span class="comment">// å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™äº›æ•°æ®éƒ½å¯ä»¥è®©åç«¯ç”Ÿæˆï¼ŒğŸ˜Šã€‚</p><p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‘ã€‚å¯¹äºandroidè®¾å¤‡ï¼Œvueé¡¹ç›®ä¸€åˆ‡æ­£å¸¸ï¼ˆå¯èƒ½æ˜¯å’Œå®˜ç½‘è¯´çš„ä¿®å¤æœ‰å…³ï¼‰ã€‚</p><p><strong>å¯¹äºiosè®¾å¤‡ï¼Œvueé¡¹ç›®çš„URLæ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œåªå¯¹ç¬¬ä¸€æ¬¡è¿›å…¥çš„URLèƒ½éªŒè¯æˆåŠŸã€‚</strong><br>å½“ç„¶é¡µé¢freshï¼Œæ˜¯ä¼šåˆ·æ–°çš„urlçš„ã€‚è¿™ä¸ªè¯´çš„ä¸ä¼šå˜åŒ–æ˜¯æŒ‡ <code>$router.push</code> æ–¹æ³•ã€‚</p><ol start="3"><li>é€šè¿‡readyæ¥å£å¤„ç†æˆåŠŸéªŒè¯</li><li>è‡ªå®šä¹‰åˆ†äº«å†…å®¹<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wx.ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;   <span class="comment">//éœ€åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»åˆ†äº«æŒ‰é’®å‰å°±å…ˆè°ƒç”¨</span></span><br><span class="line">  wx.updateAppMessageShareData(&#123; <span class="comment">// åˆ†äº«åˆ°æœ‹å‹</span></span><br><span class="line">    title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">    desc: <span class="string">''</span>, <span class="comment">// åˆ†äº«æè¿°</span></span><br><span class="line">    link: <span class="string">''</span>, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">    imgUrl: <span class="string">''</span>, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// è®¾ç½®æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.updateTimelineShareData(&#123; <span class="comment">// åˆ†äº«åˆ°æœ‹å‹åœˆ</span></span><br><span class="line">    title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">    link: <span class="string">''</span>, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">    imgUrl: <span class="string">''</span>, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// è®¾ç½®æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h5 id="vueé¡¹ç›®"><a href="#vueé¡¹ç›®" class="headerlink" title="vueé¡¹ç›®"></a>vueé¡¹ç›®</h5><p>å› ä¸ºä¸Šé¢è¯´çš„é‚£ä¸ªå‘ï¼Œæ‰€ä»¥åœ¨vueé¡¹ç›®ä¸­ï¼Œéœ€è¦åšä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚</p><p>å¤„ç†åŸç†æ˜¯ï¼Œåœ¨æœ€å¼€å§‹è¿›å…¥é¡µé¢çš„æ—¶å€™çºªå½•ä¸‹urlï¼Œç„¶ååœ¨æ¯æ¬¡è·¯ç”±åˆ·æ–°çš„æ—¶å€™åˆ¤æ–­æ˜¯<code>andriod</code>æœºè¿˜æ˜¯<code>ios</code>æœºå­ï¼Œåšä¸åŒçš„å¤„ç†.</p><p>ä¸‹é¢ç»™å‡ºå…·ä½“ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; wechatAuth &#125; <span class="keyword">from</span> <span class="string">'@/utils/wechatConfig.js'</span></span><br><span class="line"></span><br><span class="line">router.afterEach(<span class="function"><span class="params">to</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> authUrl = <span class="string">`<span class="subst">$&#123;<span class="built_in">window</span>.location.origin&#125;</span><span class="subst">$&#123;to.fullPath&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.__wxjs_is_wkwebview) &#123;</span><br><span class="line">    <span class="comment">// IOS</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">window</span>.entryUrl) &#123;</span><br><span class="line">      <span class="built_in">window</span>.entryUrl = authUrl <span class="comment">// å°†åé¢çš„å‚æ•°å»é™¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    wechatAuth(authUrl, <span class="string">'ios'</span>, to.meta.title)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å®‰å“</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      wechatAuth(authUrl, <span class="string">'android'</span>, to.meta.title)</span><br><span class="line">    &#125;, <span class="number">500</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wechatAuth</span></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@/lib/jweixin-1.4.0.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> indexOfConfig = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateShareData = <span class="function">(<span class="params">shareConfig, shareSuccessCallback</span>) =&gt;</span> &#123;</span><br><span class="line">  wx.updateAppMessageShareData(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    desc: shareConfig.desc,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.updateTimelineShareData(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;,</span><br><span class="line">    fail: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.onMenuShareTimeline(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.onMenuShareAppMessage(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    desc: shareConfig.desc,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> wechatAuth = <span class="keyword">async</span> (authUrl, device, title, allowShare = <span class="literal">true</span>, shareSuccessCallback = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> shareConfig = &#123;</span><br><span class="line">    title: <span class="string">'title'</span>,</span><br><span class="line">    desc: <span class="string">'desc'</span>,</span><br><span class="line">    link: allowShare ? authUrl : <span class="built_in">window</span>.location.origin,</span><br><span class="line">    imgUrl: <span class="built_in">window</span>.location.origin + <span class="string">'/favicon-matpool.ico'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œåœ¨åˆ«äººçš„ä»£ç ä¸­è°ƒç”¨äº†encodeURIComponentï¼Œä½†æˆ‘æµ‹è¯•çš„ç»“æœæ˜¯ï¼šæ²¡æœ‰encodeURIComponentæ‰èƒ½æ­£ç¡®åˆ†äº«ã€‚</span></span><br><span class="line">    url: device === <span class="string">'ios'</span> ? <span class="built_in">window</span>.entryUrl : authUrl </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> authRes = <span class="keyword">await</span> api.getWxConfig(params)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (authRes &amp;&amp; wx) &#123;</span><br><span class="line">    <span class="keyword">if</span> (device !== <span class="string">'ios'</span> || indexOfConfig === <span class="number">0</span>) &#123;</span><br><span class="line">      indexOfConfig++</span><br><span class="line"></span><br><span class="line">      wx.config(&#123;</span><br><span class="line">        debug: <span class="literal">false</span>,</span><br><span class="line">        appId: authRes.app_id,</span><br><span class="line">        timestamp: authRes.timestamp,</span><br><span class="line">        nonceStr: authRes.nonce,</span><br><span class="line">        signature: authRes.signature,</span><br><span class="line">        jsApiList: [</span><br><span class="line">          <span class="string">'updateAppMessageShareData'</span>,</span><br><span class="line">          <span class="string">'updateTimelineShareData'</span>,</span><br><span class="line">          <span class="string">'onMenuShareAppMessage'</span>,</span><br><span class="line">          <span class="string">'onMenuShareTimeline'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      wx.ready(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        updateShareData(shareConfig, shareSuccessCallback)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      updateShareData(shareConfig, shareSuccessCallback)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>NOTE</strong>ï¼šå°±æ˜¯è¿™ä¸ªencodeURIComponentå‘äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ã€‚ğŸ˜…</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://mp.weixin.qq.com/wiki" target="_blank" rel="noopener">å¾®ä¿¡å…¬ä¼—å¹³å°æŠ€æœ¯æ–‡æ¡£</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784140" target="_blank" rel="noopener">å¾®ä¿¡webå¼€å‘è€…å·¥å…·</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115" target="_blank" rel="noopener">å¾®ä¿¡js-sdk</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784134" target="_blank" rel="noopener">å¾®ä¿¡ç½‘é¡µå¼€å‘æ ·å¼åº“</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‡ å¤©å¼€å‘äº†ä¸€ä¸ªå¾®ä¿¡æœåŠ¡å·ï¼Œä¹Ÿç®—æ˜¯å…¥é—¨äº†ï¼Œçºªå½•ä¸‹å…¶ä¸­çš„è¿‡ç¨‹å’Œé‡åˆ°çš„å‘ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#å¼€å‘ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;/a&gt;å¼€å‘ç¯å¢ƒ&lt;/h3&gt;&lt;p&gt;è¦åœ¨å¾®ä¿¡çš„å¹³å°ä¸Šè¿›è¡Œå¼€å‘ï¼Œéœ€è¦ä¸€äº›åŸºç¡€çš„ç¯å¢ƒã€‚å…¶ä¸­åŒ…æ‹¬ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼ŒæœåŠ¡å™¨ï¼ŒåŸŸåã€‚&lt;/p&gt;
&lt;h4 id=&quot;åŸŸå&quot;&gt;&lt;a href=&quot;#åŸŸå&quot; class=&quot;headerlink&quot; title=&quot;åŸŸå&quot;&gt;&lt;/a&gt;åŸŸå&lt;/h4&gt;&lt;p&gt;åŸŸåéœ€è¦å¤‡æ¡ˆï¼Œä¸”éœ€è¦é…ç½®åœ¨ &lt;code&gt;å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„â€œå¼€å‘ - æ¥å£æƒé™ - ç½‘é¡µæœåŠ¡ - ç½‘é¡µå¸å· - ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€çš„é…ç½®é€‰é¡¹ä¸­&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŸŸåçš„é…ç½®éœ€è¦éªŒè¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®ä¸‹ &lt;code&gt;nginx&lt;/code&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶æœ¬åœ°å¼€å‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½æ—¶æ—¶å‘å¸ƒçš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹æœ¬åœ° &lt;code&gt;host&lt;/code&gt; çš„æ–¹å¼æ¥å¿«é€Ÿå¼€å‘ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="wechat" scheme="https://sampwood.github.io/categories/coding/wechat/"/>
    
    
      <category term="mobile" scheme="https://sampwood.github.io/tags/mobile/"/>
    
      <category term="vue" scheme="https://sampwood.github.io/tags/vue/"/>
    
      <category term="html5" scheme="https://sampwood.github.io/tags/html5/"/>
    
  </entry>
  
  <entry>
    <title>project åŸºç¡€è®¾ç½®</title>
    <link href="https://sampwood.github.io/2019/05/15/project-basic-configuration/"/>
    <id>https://sampwood.github.io/2019/05/15/project-basic-configuration/</id>
    <published>2019-05-15T12:59:36.000Z</published>
    <updated>2019-10-08T10:53:38.740Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è®¾ç½®ä¸€äº›åŸºç¡€é…ç½®ï¼Œè®©ä¸åŒå¼€å‘äººå‘˜åœ¨ä¸åŒç¯å¢ƒä¸‹èƒ½å†™å‡ºç»Ÿä¸€è§„èŒƒçš„ä»£ç ã€‚<br>ä¸‹é¢å°±è®°å½•ä¸‹æœ¬äººåœ¨ä½¿ç”¨çš„ä¸€äº›é€šç”¨è®¾ç½®ã€‚</p><h3 id="eslint-prettier"><a href="#eslint-prettier" class="headerlink" title="eslint + prettier"></a>eslint + prettier</h3><p><code>eslint</code> ç”¨æ¥è¿›è¡Œä»£ç çš„æ ¡éªŒï¼Œ<code>prettier</code> ç”¨äºç»Ÿä¸€ä»£ç é£æ ¼</p><p><code>eslint</code> çš„å®‰è£…å’Œä½¿ç”¨åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»è¯´æ˜ã€‚ä¸‹é¢ä»‹ç»ä¸‹ <code>prettier</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D prettier eslint-plugin-prettier eslint-config-prettier</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>eslint-plugin-prettier</code> æ’ä»¶ä¼šè°ƒç”¨ <code>prettier</code> å¯¹ä½ çš„ä»£ç é£æ ¼è¿›è¡Œæ£€æŸ¥.<br>å…¶åŸç†æ˜¯å…ˆä½¿ç”¨ <code>prettier</code> å¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¸æ ¼å¼åŒ–ä¹‹å‰çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¿‡å‡ºç°äº†ä¸ä¸€è‡´ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šè¢« <code>prettier</code> è¿›è¡Œæ ‡è®°ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>eslint-config-prettier</code> é…ç½®ï¼Œèƒ½å¤Ÿå…³é—­ä¸€äº›ä¸å¿…è¦çš„æˆ–è€…æ˜¯ä¸ <code>prettier</code> å†²çªçš„linté€‰é¡¹ã€‚<br>è¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šçœ‹åˆ°ä¸€äº› <code>error</code> åŒæ—¶å‡ºç°ä¸¤æ¬¡ã€‚ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç¡®ä¿ï¼Œè¿™ä¸ªé…ç½®åœ¨ <code>extends</code> çš„æœ€åä¸€é¡¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">  extends: [</span><br><span class="line">    <span class="string">'standard'</span>, <span class="comment">//ä½¿ç”¨standardåšä»£ç è§„èŒƒ</span></span><br><span class="line">    <span class="comment">// https://github.com/vuejs/eslint-plugin-vue#priority-a-essential-error-prevention</span></span><br><span class="line">    <span class="comment">// consider switching to `plugin:vue/strongly-recommended` or `plugin:vue/recommended` for stricter rules.</span></span><br><span class="line">    <span class="string">'plugin:vue/essential'</span>,</span><br><span class="line">    <span class="string">'plugin:prettier/recommended'</span>,</span><br><span class="line">  ],</span><br><span class="line">  plugins: [<span class="string">'prettier'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'no-console'</span>: process.env.NODE_ENV === <span class="string">'production'</span> ? <span class="string">'error'</span> : <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'no-debugger'</span>: process.env.NODE_ENV === <span class="string">'production'</span> ? <span class="string">'error'</span> : <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'prettier/prettier'</span>: [</span><br><span class="line">      <span class="string">'error'</span>,</span><br><span class="line">      &#123; <span class="comment">// prettier é…ç½®</span></span><br><span class="line">        semi: <span class="literal">false</span>,</span><br><span class="line">        singleQuote: <span class="literal">true</span>,</span><br><span class="line">        printWidth: <span class="number">120</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>NOTE: é…ç½®æ–¹æ³•æœ‰å¥½å‡ ç§ï¼Œæœ¬äººåœ¨ <code>.eslintrc.js</code> ä¸­å¯¹ <code>prettier</code> è¿›è¡Œé…ç½®</strong></p><h3 id="husky-lint-staged"><a href="#husky-lint-staged" class="headerlink" title="husky + lint-staged"></a>husky + lint-staged</h3><p>è¿™ä¸ªåœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æœ‰ä»‹ç»ã€‚</p><p>å½“ç„¶ï¼Œç°åœ¨ <code>husky</code> åœ¨ <code>package.json</code> æä¾›äº†é¢å¤–çš„é…ç½®å‚æ•° <code>husky</code>ï¼Œè€Œä¸æ˜¯åœ¨ <code>script</code> ä¸­å†™ <code>precommit</code></p><h3 id="Commitizen-Commitlint"><a href="#Commitizen-Commitlint" class="headerlink" title="Commitizen + Commitlint"></a>Commitizen + Commitlint</h3><p>ç”¨è¿™ä¸¤ä¸ªæ’ä»¶æ¥è®©ä½ çš„ git commit message æ›´åŠ çš„è§„èŒƒå’Œç»Ÿä¸€ã€‚<br><code>Commitizen</code> æ˜¯ä¸€å¥—æ¨¡ç‰ˆåŒ–çš„commit message, <code>Commitlint</code> ç”¨æ¥æ£€æŸ¥commit message æ˜¯å¦ç¬¦åˆåˆ¶å®šæ¨¡æ¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -D commitizen cz-customizable</span><br><span class="line">npm install -D commitlint-config-cz @commitlint/cli @commitlint/config-conventional</span><br></pre></td></tr></table></figure><p>ç»“åˆ <code>husky</code> æ’ä»¶å°±èƒ½æ‹¥æœ‰åŒæ ·çš„ <code>git commit</code> å‘½ä»¤ï¼Œä¸ä¸€æ ·çš„ä½“éªŒï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>git cz</code>å‘½ä»¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"husky"</span>: &#123;</span><br><span class="line">    <span class="attr">"hooks"</span>: &#123;</span><br><span class="line">      <span class="attr">"pre-commit"</span>: <span class="string">"lint-staged"</span>,</span><br><span class="line">      <span class="attr">"prepare-commit-msg"</span>: <span class="string">"exec &lt; /dev/tty &amp;&amp; git cz --hook"</span>,</span><br><span class="line">      <span class="attr">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"lint-staged"</span>: &#123;</span><br><span class="line">    <span class="attr">"src/**/*.&#123;js,vue&#125;"</span>: [</span><br><span class="line">      <span class="string">"eslint --fix"</span>,</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"config"</span>: &#123;</span><br><span class="line">    <span class="attr">"commitizen"</span>: &#123;</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"cz-customizable"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢å¤–éœ€è¦å¢åŠ ä¸‹é¢è¿™äº›æ–‡ä»¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .cz-config.js</span></span><br><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"></span><br><span class="line">  types: [</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'WIP'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ’ª  WIP:      Work in progress'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'feat'</span>,</span><br><span class="line">      name : <span class="string">'âœ¨  feat:     A new feature'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'fix'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ  fix:      A bug fix'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'refactor'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ›   refactor: A code change that neither fixes a bug nor adds a feature'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'docs'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ“š  docs:     Documentation only changes'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'test'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ  test:     Add missing tests or correcting existing tests'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'chore'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ—¯  chore:    Changes that don\'t modify src or test files. Such as updating build tasks, package manager'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'style'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ’…  style:    Code Style, Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'revert'</span>,</span><br><span class="line">      name : <span class="string">'âª  revert:   Revert to a commit'</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  scopes: [],</span><br><span class="line"></span><br><span class="line">  allowCustomScopes: <span class="literal">true</span>,</span><br><span class="line">  allowBreakingChanges: [<span class="string">"feat"</span>, <span class="string">"fix"</span>]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .commitlintrc.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [<span class="string">'@commitlint/config-conventional'</span>, <span class="string">'cz'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'type-enum'</span>: [<span class="number">2</span>, <span class="string">'always'</span>, [<span class="string">'WIP'</span>, <span class="string">'feat'</span>, <span class="string">'fix'</span>, <span class="string">'refactor'</span>, <span class="string">'docs'</span>, <span class="string">'test'</span>, <span class="string">'chore'</span>, <span class="string">'style'</span>, <span class="string">'revert'</span>]],</span><br><span class="line">    <span class="string">'type-case'</span>: [<span class="number">0</span>, <span class="string">'never'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="standard-version"><a href="#standard-version" class="headerlink" title="standard-version"></a>standard-version</h3><p>å¦‚æœä½¿ç”¨ä¸Šé¢çš„æ’ä»¶æ¥è§„èŒƒæˆ‘ä»¬çš„git commit messageï¼Œ<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ© standard-version è¿™æ ·çš„å·¥å…·, è‡ªåŠ¨ç”Ÿæˆ CHANGELOG, ç”šè‡³æ˜¯ è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å·(Semantic Version).</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D standard-version</span><br></pre></td></tr></table></figure><p>åœ¨ <code>package.json</code> ä¸­é…ç½®ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scirpt"</span>: &#123;</span><br><span class="line">    ...,</span><br><span class="line">    "release": "HUSKY_SKIP_HOOKS=1 standard-version"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: <code>HUSKY_SKIP_HOOKS=1</code> ç”¨äºå–æ¶ˆhuskyä¸­ç¬¬äºŒä¸ªhookï¼ˆ<code>prepare-commit-msg</code>ï¼‰,è¿™ä¸ªéœ€è¦<code>husky</code>å‡çº§åˆ°<code>3.0.0</code>ç‰ˆæœ¬ä»¥ä¸Š</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://juejin.im/post/5b27a326e51d45588a7dac57" target="_blank" rel="noopener">ä½¿ç”¨ESLint+Prettieræ¥ç»Ÿä¸€å‰ç«¯ä»£ç é£æ ¼</a></li><li><a href="https://juejin.im/post/5afc5242f265da0b7f44bee4#heading-7" target="_blank" rel="noopener">ä¼˜é›…çš„æäº¤ä½ çš„ Git Commit Message</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è®¾ç½®ä¸€äº›åŸºç¡€é…ç½®ï¼Œè®©ä¸åŒå¼€å‘äººå‘˜åœ¨ä¸åŒç¯å¢ƒä¸‹èƒ½å†™å‡ºç»Ÿä¸€è§„èŒƒçš„ä»£ç ã€‚&lt;br&gt;ä¸‹é¢å°±è®°å½•ä¸‹æœ¬äººåœ¨ä½¿ç”¨çš„ä¸€äº›é€šç”¨è®¾ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&quot;eslint-prettier&quot;&gt;&lt;a href=&quot;#eslint-prettier&quot; class=&quot;headerlink&quot; title=&quot;eslint + prettier&quot;&gt;&lt;/a&gt;eslint + prettier&lt;/h3&gt;&lt;p&gt;&lt;code&gt;eslint&lt;/code&gt; ç”¨æ¥è¿›è¡Œä»£ç çš„æ ¡éªŒï¼Œ&lt;code&gt;prettier&lt;/code&gt; ç”¨äºç»Ÿä¸€ä»£ç é£æ ¼&lt;/p&gt;
&lt;p&gt;&lt;code&gt;eslint&lt;/code&gt; çš„å®‰è£…å’Œä½¿ç”¨åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»è¯´æ˜ã€‚ä¸‹é¢ä»‹ç»ä¸‹ &lt;code&gt;prettier&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm i -D prettier eslint-plugin-prettier eslint-config-prettier&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>npm scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•</title>
    <link href="https://sampwood.github.io/2019/04/01/npm-scripts%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%96%B9%E6%B3%95/"/>
    <id>https://sampwood.github.io/2019/04/01/npm-scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•/</id>
    <published>2019-04-01T00:59:06.000Z</published>
    <updated>2019-04-01T01:07:24.544Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ <code>package.json</code> ä¸­ï¼Œå¦‚æœå¸Œæœ›åœ¨ <code>script</code> å±æ€§çš„è¿è¡Œè„šæœ¬ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ¥åŒºåˆ†å¼€å‘ç¯å¢ƒ æˆ– ç”Ÿäº§ç¯å¢ƒã€‚<br>unixä¸windowsç¯å¢ƒçš„è®¾ç½®æ–¹å¼æ˜¯ä¸åŒçš„ã€‚<br>è¿™ä¸ªä¸åŒå¯ä»¥é€šè¿‡<code>cross-env</code>æ¥å®ç°è·¨å¹³å°è®¾ç½®ã€‚</p><a id="more"></a><p>windows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set NODE_ENV=production</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;set NODE_ENV=production &amp;&amp; npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;set NODE_ENV=development &amp;&amp; npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>linux &amp; mac:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export NODE_ENV=production</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;NODE_ENV=production npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;NODE_ENV=development npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>cross-envè·¨å¹³å°è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm i cross-env -D</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;cross-env NODE_ENV=production npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;cross-env NODE_ENV=development npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.cnblogs.com/mengff/p/7350030.html" target="_blank" rel="noopener">npm scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•</a></li><li><a href="https://www.jianshu.com/p/60c4ce9111c0" target="_blank" rel="noopener">package.jsoné‡Œscriptè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œunixä¸windowsçš„åŒºåˆ«</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ &lt;code&gt;package.json&lt;/code&gt; ä¸­ï¼Œå¦‚æœå¸Œæœ›åœ¨ &lt;code&gt;script&lt;/code&gt; å±æ€§çš„è¿è¡Œè„šæœ¬ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ¥åŒºåˆ†å¼€å‘ç¯å¢ƒ æˆ– ç”Ÿäº§ç¯å¢ƒã€‚&lt;br&gt;unixä¸windowsç¯å¢ƒçš„è®¾ç½®æ–¹å¼æ˜¯ä¸åŒçš„ã€‚&lt;br&gt;è¿™ä¸ªä¸åŒå¯ä»¥é€šè¿‡&lt;code&gt;cross-env&lt;/code&gt;æ¥å®ç°è·¨å¹³å°è®¾ç½®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="linux" scheme="https://sampwood.github.io/tags/linux/"/>
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="npm" scheme="https://sampwood.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>indexDBçš„ä½¿ç”¨</title>
    <link href="https://sampwood.github.io/2019/02/28/%E6%B5%8F%E8%A7%88%E5%99%A8indexDB%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>https://sampwood.github.io/2019/02/28/æµè§ˆå™¨indexDBçš„ä½¿ç”¨/</id>
    <published>2019-02-28T06:27:33.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ç°ä»£æµè§ˆå™¨æä¾›äº†ä¸€äº›æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œä¾‹å¦‚<code>cookie</code>ã€<code>sessionStorage</code>ã€<code>localStorage</code>å’Œ<code>indexedDB</code>ã€‚</p><p>è¿™äº›éƒ½èƒ½åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·çš„<code>application</code>æ ‡ç­¾é¡µä¸­èƒ½çœ‹åˆ°ã€‚</p><p>åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œ<code>indexedDB</code>çš„åŸºæœ¬ç”¨æ³•ã€‚</p><blockquote><p>é€šä¿—åœ°è¯´ï¼Œ<code>IndexedDB</code> å°±æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚<br><code>IndexedDB</code> å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚<br>è¿™äº›éƒ½æ˜¯ <code>LocalStorage</code> æ‰€ä¸å…·å¤‡çš„ã€‚<br>å°±æ•°æ®åº“ç±»å‹è€Œè¨€ï¼Œ<code>IndexedDB</code> ä¸å±äºå…³ç³»å‹æ•°æ®åº“ï¼ˆä¸æ”¯æŒ <code>SQL</code> æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œæ›´æ¥è¿‘ <code>NoSQL</code> æ•°æ®åº“ã€‚</p></blockquote><a id="more"></a><blockquote><p>IndexedDB å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ã€‚<br>ï¼ˆ1ï¼‰<strong>é”®å€¼å¯¹å‚¨å­˜</strong> IndexedDB å†…éƒ¨é‡‡ç”¨å¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰å­˜æ”¾æ•°æ®ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚å¯¹è±¡ä»“åº“ä¸­ï¼Œæ•°æ®ä»¥â€é”®å€¼å¯¹â€çš„å½¢å¼ä¿å­˜ï¼Œæ¯ä¸€ä¸ªæ•°æ®è®°å½•éƒ½æœ‰å¯¹åº”çš„ä¸»é”®ï¼Œä¸»é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸èƒ½æœ‰é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚<br>ï¼ˆ2ï¼‰<strong>å¼‚æ­¥</strong> IndexedDB æ“ä½œæ—¶ä¸ä¼šé”æ­»æµè§ˆå™¨ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè¿™ä¸ LocalStorage å½¢æˆå¯¹æ¯”ï¼Œåè€…çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚å¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å¤§é‡æ•°æ®çš„è¯»å†™ï¼Œæ‹–æ…¢ç½‘é¡µçš„è¡¨ç°ã€‚<br>ï¼ˆ3ï¼‰<strong>æ”¯æŒäº‹åŠ¡</strong> IndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œè¿™æ„å‘³ç€ä¸€ç³»åˆ—æ“ä½œæ­¥éª¤ä¹‹ä¸­ï¼Œåªè¦æœ‰ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±éƒ½å–æ¶ˆï¼Œæ•°æ®åº“å›æ»šåˆ°äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œä¸å­˜åœ¨åªæ”¹å†™ä¸€éƒ¨åˆ†æ•°æ®çš„æƒ…å†µã€‚<br>ï¼ˆ4ï¼‰<strong>åŒæºé™åˆ¶</strong> IndexedDB å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚ç½‘é¡µåªèƒ½è®¿é—®è‡ªèº«åŸŸåä¸‹çš„æ•°æ®åº“ï¼Œè€Œä¸èƒ½è®¿é—®è·¨åŸŸçš„æ•°æ®åº“ã€‚<br>ï¼ˆ5ï¼‰<strong>å‚¨å­˜ç©ºé—´å¤§</strong> IndexedDB çš„å‚¨å­˜ç©ºé—´æ¯” LocalStorage å¤§å¾—å¤šï¼Œä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ã€‚<br>ï¼ˆ6ï¼‰<strong>æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜</strong> IndexedDB ä¸ä»…å¯ä»¥å‚¨å­˜å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥å‚¨å­˜äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚</p></blockquote><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ul><li>æ•°æ®åº“ï¼šIDBDatabase å¯¹è±¡</li><li>å¯¹è±¡ä»“åº“ï¼šIDBObjectStore å¯¹è±¡</li><li>ç´¢å¼•ï¼š IDBIndex å¯¹è±¡</li><li>äº‹åŠ¡ï¼š IDBTransaction å¯¹è±¡</li><li>æ“ä½œè¯·æ±‚ï¼šIDBRequest å¯¹è±¡</li><li>æŒ‡é’ˆï¼š IDBCursor å¯¹è±¡</li><li>ä¸»é”®é›†åˆï¼šIDBKeyRange å¯¹è±¡</li></ul><h3 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h3><p>ä¸€ä¸ªåŸºæœ¬çš„<code>indexDB</code>æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>æ‰“å¼€æ•°æ®åº“</li><li>åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“</li><li>å¼€å¯äº‹åŠ¡ï¼Œå¹¶å‘èµ·æ•°æ®åº“æ“ä½œè¯·æ±‚</li><li>ç›‘å¬ç‰¹å®šäº‹ä»¶ï¼Œç­‰å¾…æ“ä½œå®Œæˆ</li><li>å¯¹è¿”å›ç»“æœè¿›è¡Œå¤„ç†</li></ol><h4 id="æ‰“å¼€æ•°æ®åº“"><a href="#æ‰“å¼€æ•°æ®åº“" class="headerlink" title="æ‰“å¼€æ•°æ®åº“"></a>æ‰“å¼€æ•°æ®åº“</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> db</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">require</span> = <span class="built_in">window</span>.indexedDB.open(databaseName, version)</span><br><span class="line"></span><br><span class="line">request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“æ‰“å¼€æŠ¥é”™'</span>)</span><br><span class="line">&#125;</span><br><span class="line">request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“æ‰“å¼€æˆåŠŸ'</span>)</span><br><span class="line">  db = event.target.result</span><br><span class="line">&#125;</span><br><span class="line">request.onupgradeneeded = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“å‡çº§æˆåŠŸ'</span>)</span><br><span class="line">  db = event.target.result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>window.indexedDB.open</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ<br>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„åå­—ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºæ•°æ®åº“ã€‚<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•´æ•°ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚<br>å¦‚æœçœç•¥ï¼Œæ‰“å¼€å·²æœ‰æ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸ºå½“å‰ç‰ˆæœ¬ï¼›æ–°å»ºæ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸º1ã€‚<br>å¦‚æœæŒ‡å®šçš„ç‰ˆæœ¬å·ï¼Œå¤§äºæ•°æ®åº“çš„å®é™…ç‰ˆæœ¬å·ï¼Œå°±ä¼šå‘ç”Ÿæ•°æ®åº“å‡çº§äº‹ä»¶<code>onupgradeneeded</code>ã€‚</p><p><strong>Note: æ•°æ®åº“å‡çº§æˆåŠŸä¹‹åä¼šè°ƒç”¨<code>onsuccess</code>çš„å›è°ƒ</strong></p><h4 id="æ–°å»ºå¯¹è±¡ä»“åº“"><a href="#æ–°å»ºå¯¹è±¡ä»“åº“" class="headerlink" title="æ–°å»ºå¯¹è±¡ä»“åº“"></a>æ–°å»ºå¯¹è±¡ä»“åº“</h4><p>æ–°å»º/åˆ é™¤/æ›´æ–°å¯¹è±¡ä»“åº“åªèƒ½åœ¨æ•°æ®åº“å‡çº§çš„å›è°ƒå‡½æ•°ä¸­ï¼Œ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This event is only implemented in recent browsers   </span></span><br><span class="line">request.onupgradeneeded = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123; </span><br><span class="line">  <span class="comment">// Save the IDBDatabase interface </span></span><br><span class="line">  db = event.target.result;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create an objectStore for this database</span></span><br><span class="line">  <span class="keyword">const</span> objectStore = db.createObjectStore(<span class="string">"name"</span>, &#123; <span class="attr">keyPath</span>: <span class="string">"myKey"</span> &#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>ä¸»é”®ï¼ˆkeyï¼‰æ˜¯é»˜è®¤å»ºç«‹ç´¢å¼•çš„å±æ€§ã€‚<br>æ¯”å¦‚ï¼Œæ•°æ®è®°å½•æ˜¯<code>{ id: 1, name: &#39;å¼ ä¸‰&#39; }</code>ï¼Œé‚£ä¹ˆ<code>id</code>å±æ€§å¯ä»¥ä½œä¸ºä¸»é”®ã€‚<br>ä¸»é”®ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸‹ä¸€å±‚å¯¹è±¡çš„å±æ€§ï¼Œæ¯”å¦‚<code>{ foo: { bar: &#39;baz&#39; } }</code>çš„<code>foo.bar</code>ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸»é”®ã€‚</p><p>å¦‚æœè¦æŒ‡å®šä¸»é”®ä¸ºä¸€ä¸ªé€’å¢çš„æ•´æ•°ï¼Œå¯ä»¥ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createObjectStore(&quot;name&quot;, &#123; keyPath: &quot;myKey&quot;, autoIncrement: true &#125;)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¦åˆ›å»ºç´¢å¼•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objectStore.createIndex(&apos;name&apos;, &apos;name&apos;, &#123; unique: false &#125;);</span><br><span class="line">objectStore.createIndex(&apos;email&apos;, &apos;email&apos;, &#123; unique: true &#125;);</span><br></pre></td></tr></table></figure></p><h4 id="å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ"><a href="#å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ" class="headerlink" title="å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ"></a>å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ</h4><p>å¼€å¯äº‹åŠ¡çš„æ–¹æ³•æ˜¯<code>IDBDatabase.transaction([&#39;person&#39;], &#39;readwrite&#39;)</code>ã€‚<br>å…¶ä¸­<code>person</code>æ˜¯å¯¹è±¡ä»“åº“åï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡æ˜è¯»å†™æƒé™ï¼š<code>&#39;readwrite&#39;/&#39;readonly&#39;</code>ã€‚</p><p>å¼€å¯äº‹åŠ¡ä¹‹åé€šè¿‡<code>IDBTransaction.objectStore(name)</code>ï¼Œæ‹¿åˆ° <code>IDBObjectStore</code> å¯¹è±¡ã€‚<br>åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨å¢åˆ æ”¹æŸ¥çš„æ–¹æ³•ã€‚</p><p><strong>Note: å½“ä¸€æ¬¡äº‹åŠ¡éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå¤šæ¬¡æ“ä½œçš„æ—¶å€™ï¼Œå°±è¦ç›‘å¬äº‹åŠ¡çš„å›è°ƒ<code>oncomplete</code>å’Œ<code>onerror</code></strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Do something when all the data is added to the database.</span></span><br><span class="line">transaction.oncomplete = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">"All done!"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">transaction.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Don't forget to handle errors!</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.objectStore(<span class="string">"customers"</span>);</span><br><span class="line">customerData.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">customer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = objectStore.add(customer);</span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// event.target.result === customer.ssn;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h5 id="å¢"><a href="#å¢" class="headerlink" title="å¢"></a>å¢</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .add(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'å¼ ä¸‰'</span>, <span class="attr">age</span>: <span class="number">24</span>, <span class="attr">email</span>: <span class="string">'zhangsan@example.com'</span> &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®å†™å…¥æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®å†™å…¥å¤±è´¥'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add();</span><br></pre></td></tr></table></figure><h5 id="åˆ "><a href="#åˆ " class="headerlink" title="åˆ "></a>åˆ </h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .delete(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åˆ é™¤æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">remove();</span><br></pre></td></tr></table></figure><p><strong>Note: deleteæ–¹æ³•çš„å‚æ•°æ˜¯ä¸»é”®å€¼</strong></p><h5 id="æ”¹"><a href="#æ”¹" class="headerlink" title="æ”¹"></a>æ”¹</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .put(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'æå››'</span>, <span class="attr">age</span>: <span class="number">35</span>, <span class="attr">email</span>: <span class="string">'lisi@example.com'</span> &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°å¤±è´¥'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">update();</span><br></pre></td></tr></table></figure><p><strong>Note: putæ–¹æ³•æ˜¯æŒ‰ç…§ä¸»é”®å€¼æ¥è¿›è¡Œæ›´æ–°ã€‚</strong></p><h5 id="æŸ¥"><a href="#æŸ¥" class="headerlink" title="æŸ¥"></a>æŸ¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">const</span> transaction = db.transaction([<span class="string">'person'</span>]);</span><br><span class="line">   <span class="keyword">const</span> objectStore = transaction.objectStore(<span class="string">'person'</span>);</span><br><span class="line">   <span class="keyword">const</span> request = objectStore.get(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">   request.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'æŸ¥è¯¢å¤±è´¥'</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   request.onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params"> event</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (request.result) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Name: '</span> + request.result.name);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Age: '</span> + request.result.age);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Email: '</span> + request.result.email);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æœªè·å¾—æ•°æ®è®°å½•'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">read();</span><br></pre></td></tr></table></figure><p><strong>Note: getæ–¹æ³•çš„å‚æ•°æ˜¯ä¸»é”®å€¼</strong></p><h4 id="ç´¢å¼•çš„ä½¿ç”¨"><a href="#ç´¢å¼•çš„ä½¿ç”¨" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨"></a>ç´¢å¼•çš„ä½¿ç”¨</h4><p>ç´¢å¼•çš„æ„ä¹‰åœ¨äºï¼Œå¯ä»¥è®©ä½ æœç´¢ä»»æ„å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä»»æ„å­—æ®µæ‹¿åˆ°æ•°æ®è®°å½•ã€‚å¦‚æœä¸å»ºç«‹ç´¢å¼•ï¼Œé»˜è®¤åªèƒ½æœç´¢ä¸»é”®ï¼ˆå³ä»ä¸»é”®å–å€¼ï¼‰ã€‚</p><p>åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å¯¹<code>name</code>å’Œ<code>email</code>å»ºç«‹äº†ç´¢å¼•ã€‚<br>ç°åœ¨ï¼Œå°±å¯ä»¥ä»<code>name</code>æ‰¾åˆ°å¯¹åº”çš„æ•°æ®è®°å½•äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.transaction([<span class="string">'person'</span>], <span class="string">'readonly'</span>);</span><br><span class="line"><span class="keyword">const</span> store = transaction.objectStore(<span class="string">'person'</span>);</span><br><span class="line"><span class="keyword">const</span> index = store.index(<span class="string">'name'</span>);</span><br><span class="line"><span class="keyword">const</span> request = index.get(<span class="string">'æå››'</span>);</span><br><span class="line"></span><br><span class="line">request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = e.target.result;</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note: å› ä¸ºâ€™nameâ€™ç´¢å¼•è®¾ç½®æˆä¸æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå‡ºç°é‡åã€‚è¿™ç§æƒ…å†µåªä¼šè¿”å›ä¸€æ¡æ•°æ®ï¼ˆkeyæœ€å°çš„æ•°æ®ï¼‰ã€‚å¦‚æœæƒ³è¦è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æ‰€è¯´çš„æ¸¸æ ‡</strong></p><h4 id="æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨"><a href="#æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨" class="headerlink" title="æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨"></a>æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨</h4><p>å½“éœ€è¦éå†æ•°æ®åº“æ‰€æœ‰æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ¸¸æ ‡ï¼ˆcursorï¼‰ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectStore = db.transaction(<span class="string">"customers"</span>).objectStore(<span class="string">"customers"</span>);</span><br><span class="line"></span><br><span class="line">objectStore.openCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    alert(<span class="string">"Name for SSN "</span> + cursor.key + <span class="string">" is "</span> + cursor.value.name);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    alert(<span class="string">"No more entries!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><strong>Note: å¦‚æœåªæ˜¯æƒ³è·å–åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨<code>objectStore.getAll()</code>æˆ–<code>objectStore.getAllKeys()</code></strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">objectStore.getAll().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">"Got all customers: "</span> + event.target.result);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œç´¢å¼•ä¹Ÿå¯ä»¥ä½¿ç”¨æ¸¸æ ‡:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ™®é€šçš„æ¸¸æ ‡ï¼Œä¼šè·å–æ•´ä¸ªæ•°æ®å¯¹è±¡</span></span><br><span class="line">index.openCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="comment">// cursor.key is a name, like "Bill", and cursor.value is the whole object.</span></span><br><span class="line">    alert(<span class="string">"Name: "</span> + cursor.key + <span class="string">", SSN: "</span> + cursor.value.ssn + <span class="string">", email: "</span> + cursor.value.email);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨keyæ¸¸æ ‡ï¼Œä¼šè·å–æ•°æ®å¯¹è±¡çš„key</span></span><br><span class="line">index.openKeyCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="comment">// cursor.key is a name, like "Bill", and cursor.value is the SSN.</span></span><br><span class="line">    <span class="comment">// No way to directly get the rest of the stored object.</span></span><br><span class="line">    alert(<span class="string">"Name: "</span> + cursor.key + <span class="string">", SSN: "</span> + cursor.primaryKey);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.ruanyifeng.com/blog/2018/07/indexeddb.html" target="_blank" rel="noopener">æµè§ˆå™¨æ•°æ®åº“ IndexedDB å…¥é—¨æ•™ç¨‹</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB" target="_blank" rel="noopener">Using IndexedDB</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;ç°ä»£æµè§ˆå™¨æä¾›äº†ä¸€äº›æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œä¾‹å¦‚&lt;code&gt;cookie&lt;/code&gt;ã€&lt;code&gt;sessionStorage&lt;/code&gt;ã€&lt;code&gt;localStorage&lt;/code&gt;å’Œ&lt;code&gt;indexedDB&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›éƒ½èƒ½åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·çš„&lt;code&gt;application&lt;/code&gt;æ ‡ç­¾é¡µä¸­èƒ½çœ‹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œ&lt;code&gt;indexedDB&lt;/code&gt;çš„åŸºæœ¬ç”¨æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šä¿—åœ°è¯´ï¼Œ&lt;code&gt;IndexedDB&lt;/code&gt; å°±æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚&lt;br&gt;&lt;code&gt;IndexedDB&lt;/code&gt; å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚&lt;br&gt;è¿™äº›éƒ½æ˜¯ &lt;code&gt;LocalStorage&lt;/code&gt; æ‰€ä¸å…·å¤‡çš„ã€‚&lt;br&gt;å°±æ•°æ®åº“ç±»å‹è€Œè¨€ï¼Œ&lt;code&gt;IndexedDB&lt;/code&gt; ä¸å±äºå…³ç³»å‹æ•°æ®åº“ï¼ˆä¸æ”¯æŒ &lt;code&gt;SQL&lt;/code&gt; æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œæ›´æ¥è¿‘ &lt;code&gt;NoSQL&lt;/code&gt; æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="https://sampwood.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>ä»£ç æ£€æŸ¥å·¥ä½œæµä¹‹husky+lint-staged</title>
    <link href="https://sampwood.github.io/2019/02/28/husky-lint-staged/"/>
    <id>https://sampwood.github.io/2019/02/28/husky-lint-staged/</id>
    <published>2019-02-28T06:13:09.000Z</published>
    <updated>2019-03-06T05:51:53.737Z</updated>
    
    <content type="html"><![CDATA[<p>è™½ç„¶å¤§å®¶éƒ½ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨eslintç­‰å·¥å…·æ¥è¿›è¡Œä»£ç æ ¼å¼æ£€æŸ¥ã€‚<br>ä½†å¦‚æœæ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘<code>npm run lint</code>æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¿˜è®°ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>åœ¨è¿™é‡Œæˆ‘ç”¨è¿™ä¸ªåŠæ³•ï¼šåœ¨<code>git commit</code>çš„æ—¶å€™æ¥è‡ªåŠ¨è·‘eslintæ¥æ£€æŸ¥ä»£ç ã€‚</p><p>éœ€è¦çš„å·¥å…·æ˜¯ï¼š <code>husky</code> + <code>lint-staged</code></p><p><code>husky</code>çš„ä½œç”¨æ˜¯æä¾›<code>git commit hook</code>ï¼Œ<code>lint-staged</code>çš„ä½œç”¨æ˜¯è®©eslintçš„èŒƒå›´é™å®šåœ¨æœ¬æ¬¡çš„æ”¹åŠ¨æ–‡ä»¶ä¸­ã€‚</p><a id="more"></a><h3 id="é…ç½®husky-lint-staged"><a href="#é…ç½®husky-lint-staged" class="headerlink" title="é…ç½®husky+lint-staged"></a>é…ç½®<code>husky</code>+<code>lint-staged</code></h3><p>å®‰è£…æ’ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D husky lint-staged</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹<code>package.json</code>æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;precommit&quot;: &quot;lint-staged&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;lint-staged&quot;: &#123;</span><br><span class="line">    &quot;src/**/*.js&quot;: &quot;eslint&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000009546913" target="_blank" rel="noopener">ç”¨ husky å’Œ lint-staged æ„å»ºè¶…æºœçš„ä»£ç æ£€æŸ¥å·¥ä½œæµ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è™½ç„¶å¤§å®¶éƒ½ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨eslintç­‰å·¥å…·æ¥è¿›è¡Œä»£ç æ ¼å¼æ£€æŸ¥ã€‚&lt;br&gt;ä½†å¦‚æœæ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘&lt;code&gt;npm run lint&lt;/code&gt;æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¿˜è®°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ç”¨è¿™ä¸ªåŠæ³•ï¼šåœ¨&lt;code&gt;git commit&lt;/code&gt;çš„æ—¶å€™æ¥è‡ªåŠ¨è·‘eslintæ¥æ£€æŸ¥ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦çš„å·¥å…·æ˜¯ï¼š &lt;code&gt;husky&lt;/code&gt; + &lt;code&gt;lint-staged&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;husky&lt;/code&gt;çš„ä½œç”¨æ˜¯æä¾›&lt;code&gt;git commit hook&lt;/code&gt;ï¼Œ&lt;code&gt;lint-staged&lt;/code&gt;çš„ä½œç”¨æ˜¯è®©eslintçš„èŒƒå›´é™å®šåœ¨æœ¬æ¬¡çš„æ”¹åŠ¨æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linter" scheme="https://sampwood.github.io/categories/coding/linter/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="eslint" scheme="https://sampwood.github.io/tags/eslint/"/>
    
  </entry>
  
  <entry>
    <title>sshçš„ä½¿ç”¨å’Œé…ç½®</title>
    <link href="https://sampwood.github.io/2019/02/28/ssh%E7%9A%84%E4%BD%BF%E7%94%A8%E5%92%8C%E9%85%8D%E7%BD%AE/"/>
    <id>https://sampwood.github.io/2019/02/28/sshçš„ä½¿ç”¨å’Œé…ç½®/</id>
    <published>2019-02-28T05:55:00.000Z</published>
    <updated>2019-03-28T01:17:58.778Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys"><a href="#æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys" class="headerlink" title="æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys"></a>æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -al ~/.ssh</span><br></pre></td></tr></table></figure><h3 id="æ–°å»ºssh-key"><a href="#æ–°å»ºssh-key" class="headerlink" title="æ–°å»ºssh key"></a>æ–°å»ºssh key</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">"your_email@example.com"</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key"><a href="#ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key" class="headerlink" title="ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key"></a>ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> $(ssh-agent -s)</span><br><span class="line">ssh-add ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="ä¿®æ”¹ssh-keyçš„å¯†ç "><a href="#ä¿®æ”¹ssh-keyçš„å¯†ç " class="headerlink" title="ä¿®æ”¹ssh keyçš„å¯†ç "></a>ä¿®æ”¹ssh keyçš„å¯†ç </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -f ~/.ssh/id_rsa -p</span><br></pre></td></tr></table></figure><h3 id="é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh"><a href="#é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh" class="headerlink" title="é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh"></a>é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh</h3><p>åœ¨<code>~/.ssh</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»º<code>config</code>æ–‡ä»¶å¹¶å†™å…¥ä¸‹é¢çš„ä»£ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Host xxx.com</span><br><span class="line">  HostName 192.168.1.1</span><br><span class="line">  IdentityFile ~/.ssh/id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br><span class="line">Host github.com</span><br><span class="line">  HostName github.com</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~/.ssh/sampwood_id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br><span class="line">Host gitlab.com</span><br><span class="line">  HostName gitlab.com</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~/.ssh/sampwood_id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://help.github.com/en/articles/connecting-to-github-with-ssh" target="_blank" rel="noopener">Connecting to GitHub with SSH</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys&quot;&gt;&lt;a href=&quot;#æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys&quot; class=&quot;headerlink&quot; title=&quot;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys&quot;&gt;&lt;/a&gt;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ls -al ~/.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;æ–°å»ºssh-key&quot;&gt;&lt;a href=&quot;#æ–°å»ºssh-key&quot; class=&quot;headerlink&quot; title=&quot;æ–°å»ºssh key&quot;&gt;&lt;/a&gt;æ–°å»ºssh key&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssh-keygen -t rsa -b 4096 -C &lt;span class=&quot;string&quot;&gt;&quot;your_email@example.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key&quot;&gt;&lt;/a&gt;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt; $(ssh-agent -s)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh-add ~/.ssh/id_rsa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>èŠ‚æµå’Œé˜²æŠ–</title>
    <link href="https://sampwood.github.io/2019/01/11/%E8%8A%82%E6%B5%81%E5%92%8C%E9%98%B2%E6%8A%96/"/>
    <id>https://sampwood.github.io/2019/01/11/èŠ‚æµå’Œé˜²æŠ–/</id>
    <published>2019-01-11T06:21:07.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p><strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰</strong></p><blockquote><p>å½“è°ƒç”¨åŠ¨ä½œè¿‡næ¯«ç§’åï¼Œæ‰ä¼šæ‰§è¡Œè¯¥åŠ¨ä½œï¼Œè‹¥åœ¨è¿™næ¯«ç§’å†…åˆè°ƒç”¨æ­¤åŠ¨ä½œåˆ™å°†é‡æ–°è®¡ç®—æ‰§è¡Œæ—¶é—´</p></blockquote><p><strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong></p><blockquote><p>é¢„å…ˆè®¾å®šä¸€ä¸ªæ‰§è¡Œå‘¨æœŸï¼Œå½“è°ƒç”¨åŠ¨ä½œçš„æ—¶åˆ»å¤§äºç­‰äºæ‰§è¡Œå‘¨æœŸåˆ™æ‰§è¡Œè¯¥åŠ¨ä½œï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªæ–°å‘¨æœŸ</p></blockquote><p><strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong>ä¸ <strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰</strong>éƒ½æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘æ¬¡ï¼Œ<br>ä»¥ä¼˜åŒ–å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜å¯¼è‡´çš„å“åº”é€Ÿåº¦è·Ÿä¸ä¸Šè§¦å‘é¢‘ç‡ï¼Œå‡ºç°å»¶è¿Ÿï¼Œå‡æ­»æˆ–å¡é¡¿çš„ç°è±¡ã€‚</p><a id="more"></a><p>å¸¸ç”¨çš„åœºæ™¯æœ‰ï¼š</p><ul><li>windowå¯¹è±¡çš„resizeã€scrolläº‹ä»¶</li><li>æ‹–æ‹½æ—¶çš„mousemoveäº‹ä»¶</li><li>æ–‡å­—è¾“å…¥ã€è‡ªåŠ¨å®Œæˆçš„keyupäº‹ä»¶ </li></ul><p><strong>è¯å¥è¯æ¥è¯´è¿™ä¸¤è€…çš„åŒºåˆ«å°±æ˜¯ï¼Œæ˜¯å¦åœ¨åŠ¨ä½œæŒç»­çš„è¿‡ç¨‹ä¸­ï¼Œé‡æ–°è®¡ç®—è¿‡æœŸæ—¶é—´ã€‚</strong></p><p>é˜²æŠ– åªä¼šåœ¨åŠ¨ä½œâ€œçœŸæ­£ç»“æŸâ€åæ‰è§¦å‘å‡½æ•°ï¼ŒèŠ‚æµ ä¼šåœ¨è¶…è¿‡é¢„å®šæ—¶å€™åå°±ä¼šè§¦å‘å‡½æ•°</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>å‡½æ•°é˜²æŠ–ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, wait</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> context = <span class="keyword">this</span></span><br><span class="line">      <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">      <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">          clearTimeout(timer);</span><br><span class="line">          timer = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          fn.apply(context, args)</span><br><span class="line">      &#125;, wait)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'boom'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(debounce(fn,<span class="number">500</span>),<span class="number">1000</span>) <span class="comment">// ç¬¬ä¸€æ¬¡åœ¨1500msåè§¦å‘ï¼Œä¹‹åæ¯1000msè§¦å‘ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line">setInterval(debounce(fn,<span class="number">2000</span>),<span class="number">1000</span>) <span class="comment">// ä¸ä¼šè§¦å‘ä¸€æ¬¡ï¼ˆæˆ‘æŠŠå‡½æ•°é˜²æŠ–çœ‹å‡ºæŠ€èƒ½è¯»æ¡ï¼Œå¦‚æœè¯»æ¡æ²¡å®Œæˆå°±ç”¨æŠ€èƒ½ï¼Œä¾¿ä¼šå¤±è´¥è€Œä¸”é‡æ–°è¯»æ¡ï¼‰</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°èŠ‚æµï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, gapTime</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _lastTime = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _nowTime = + <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    <span class="keyword">if</span> (_nowTime - _lastTime &gt; gapTime || !_lastTime) &#123;</span><br><span class="line">      fn();</span><br><span class="line">      _lastTime = _nowTime</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'boom'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(throttle(fn,<span class="number">1000</span>),<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000008768202" target="_blank" rel="noopener">å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–</a></li><li><a href="https://juejin.im/post/5a35ed25f265da431d3cc1b1" target="_blank" rel="noopener">è½»æ¾ç†è§£JSå‡½æ•°èŠ‚æµå’Œå‡½æ•°é˜²æŠ–</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µ&quot;&gt;&lt;/a&gt;æ¦‚å¿µ&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“è°ƒç”¨åŠ¨ä½œè¿‡næ¯«ç§’åï¼Œæ‰ä¼šæ‰§è¡Œè¯¥åŠ¨ä½œï¼Œè‹¥åœ¨è¿™næ¯«ç§’å†…åˆè°ƒç”¨æ­¤åŠ¨ä½œåˆ™å°†é‡æ–°è®¡ç®—æ‰§è¡Œæ—¶é—´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢„å…ˆè®¾å®šä¸€ä¸ªæ‰§è¡Œå‘¨æœŸï¼Œå½“è°ƒç”¨åŠ¨ä½œçš„æ—¶åˆ»å¤§äºç­‰äºæ‰§è¡Œå‘¨æœŸåˆ™æ‰§è¡Œè¯¥åŠ¨ä½œï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªæ–°å‘¨æœŸ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰&lt;/strong&gt;ä¸ &lt;strong&gt;å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰&lt;/strong&gt;éƒ½æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘æ¬¡ï¼Œ&lt;br&gt;ä»¥ä¼˜åŒ–å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜å¯¼è‡´çš„å“åº”é€Ÿåº¦è·Ÿä¸ä¸Šè§¦å‘é¢‘ç‡ï¼Œå‡ºç°å»¶è¿Ÿï¼Œå‡æ­»æˆ–å¡é¡¿çš„ç°è±¡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="utils" scheme="https://sampwood.github.io/tags/utils/"/>
    
  </entry>
  
  <entry>
    <title>è·¨åŸŸé—®é¢˜</title>
    <link href="https://sampwood.github.io/2019/01/08/%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
    <id>https://sampwood.github.io/2019/01/08/è·¨åŸŸé—®é¢˜/</id>
    <published>2019-01-08T02:22:54.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<p>è·¨åŸŸåœ¨å‰ç«¯æ˜¯ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ã€‚<br>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œä»€ä¹ˆæƒ…å†µä¸‹å‡ºç°è·¨åŸŸã€‚</p><h3 id="æ¦‚å¿µä»¥åŠåœºæ™¯"><a href="#æ¦‚å¿µä»¥åŠåœºæ™¯" class="headerlink" title="æ¦‚å¿µä»¥åŠåœºæ™¯"></a>æ¦‚å¿µä»¥åŠåœºæ™¯</h3><p>è·¨åŸŸçš„å§‹ä½œä¿‘è€…æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener">åŒæºç­–ç•¥</a>:</p><blockquote><p>åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚</p></blockquote><p>æ¢å¥è¯è¯´å°±æ˜¯ï¼Œæµè§ˆå™¨é™åˆ¶äº†ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªé¡µé¢ä¸‹é¢å»è°ƒç”¨å¦å¤–ä¸€ä¸ªæºçš„èµ„æºã€‚<br>æœ€å¸¸è§çš„åœºæ™¯æ˜¯æˆ‘ä»¬åœ¨å½“å‰é¡µé¢ä¸‹è°ƒç”¨äº†å¦ä¸€ä¸ªæºçš„æ¥å£ã€‚ç»“æœæµè§ˆå™¨ç›´æ¥æŠ¥é”™äº†ï¼Œè¯´ä¸è¡Œï¼Œä¸èƒ½è¿™æ ·å¹²ã€‚</p><p>ä¸‹é¢æ˜¯åŒæºçš„å®šä¹‰ï¼š</p><blockquote><p>å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æºã€‚</p></blockquote><a id="more"></a><h4 id="é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥"><a href="#é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥" class="headerlink" title="é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥"></a>é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥</h4><p>æµè§ˆå™¨çš„åŒæºç­–ç•¥ä¼šå¯¼è‡´è·¨åŸŸï¼Œè¿™é‡ŒåŒæºç­–ç•¥åˆåˆ†ä¸ºä»¥ä¸‹ä¸¤ç§</p><ol><li>DOMåŒæºç­–ç•¥ï¼šç¦æ­¢å¯¹ä¸åŒæºé¡µé¢DOMè¿›è¡Œæ“ä½œã€‚è¿™é‡Œä¸»è¦åœºæ™¯æ˜¯iframeè·¨åŸŸçš„æƒ…å†µï¼Œä¸åŒåŸŸåçš„iframeæ˜¯é™åˆ¶äº’ç›¸è®¿é—®çš„ã€‚</li><li>XmlHttpRequeståŒæºç­–ç•¥ï¼šç¦æ­¢ä½¿ç”¨XHRå¯¹è±¡å‘ä¸åŒæºçš„æœåŠ¡å™¨åœ°å€å‘èµ·HTTPè¯·æ±‚ã€‚</li></ol><h3 id="è·¨åŸŸè§£å†³æ–¹æ¡ˆ"><a href="#è·¨åŸŸè§£å†³æ–¹æ¡ˆ" class="headerlink" title="è·¨åŸŸè§£å†³æ–¹æ¡ˆ"></a>è·¨åŸŸè§£å†³æ–¹æ¡ˆ</h3><p>è·¨åŸŸçš„é—®é¢˜æ˜¯æœ‰è§£å†³æ–¹æ¡ˆçš„ã€‚</p><h4 id="è·¨åŸŸèµ„æºå…±äº«"><a href="#è·¨åŸŸèµ„æºå…±äº«" class="headerlink" title="è·¨åŸŸèµ„æºå…±äº«"></a>è·¨åŸŸèµ„æºå…±äº«</h4><p>CORSæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ã€‚ å¯¹äºè¿™ä¸ªæ–¹å¼ï¼Œé˜®ä¸€å³°è€å¸ˆæ€»ç»“çš„æ–‡ç« ç‰¹åˆ«å¥½ï¼Œå¸Œæœ›æ·±å…¥äº†è§£çš„å¯ä»¥çœ‹ä¸€ä¸‹<a href="http://www.ruanyifeng.com/blog/2016/04/cors.htmlã€‚" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2016/04/cors.htmlã€‚</a></p><h4 id="jsnop"><a href="#jsnop" class="headerlink" title="jsnop"></a>jsnop</h4><p>åˆ©ç”¨ â€œåœ¨HTMLæ ‡ç­¾é‡Œï¼Œä¸€äº›æ ‡ç­¾æ¯”å¦‚scriptã€imgè¿™æ ·çš„è·å–èµ„æºçš„æ ‡ç­¾æ˜¯æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„â€ æ¥å®ç°è·¨åŸŸ</p><h4 id="æœåŠ¡å™¨ä»£ç†"><a href="#æœåŠ¡å™¨ä»£ç†" class="headerlink" title="æœåŠ¡å™¨ä»£ç†"></a>æœåŠ¡å™¨ä»£ç†</h4><h4 id="document-domainæ¥è·¨å­åŸŸ"><a href="#document-domainæ¥è·¨å­åŸŸ" class="headerlink" title="document.domainæ¥è·¨å­åŸŸ"></a>document.domainæ¥è·¨å­åŸŸ</h4><p>å¯¹äºä¸»åŸŸåç›¸åŒï¼Œè€Œå­åŸŸåä¸åŒçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨document.domainæ¥è·¨åŸŸ è¿™ç§æ–¹å¼éå¸¸é€‚ç”¨äºiframeè·¨åŸŸçš„æƒ…å†µã€‚</p><h4 id="window-nameè¿›è¡Œè·¨åŸŸ"><a href="#window-nameè¿›è¡Œè·¨åŸŸ" class="headerlink" title="window.nameè¿›è¡Œè·¨åŸŸ"></a>window.nameè¿›è¡Œè·¨åŸŸ</h4><p>window.nameè·¨åŸŸåŒæ ·æ˜¯å—åˆ°åŒæºç­–ç•¥é™åˆ¶ï¼Œçˆ¶æ¡†æ¶å’Œå­æ¡†æ¶çš„srcå¿…é¡»æŒ‡å‘ç»Ÿä¸€åŸŸåã€‚<br>window.nameçš„ä¼˜åŠ¿åœ¨äºï¼Œnameçš„å€¼åœ¨ä¸åŒçš„é¡µé¢(æˆ–è€…ä¸åŒçš„åŸŸå)ï¼ŒåŠ è½½åä»ç„¶å­˜åœ¨ï¼Œé™¤éä½ æ˜¾ç¤ºçš„æ›´æ”¹ã€‚å¹¶ä¸”æ”¯æŒçš„é•¿åº¦è¾¾åˆ°2M.</p><h4 id="location-hashè·¨åŸŸ"><a href="#location-hashè·¨åŸŸ" class="headerlink" title="location.hashè·¨åŸŸ"></a>location.hashè·¨åŸŸ</h4><p>location.hashæ–¹å¼è·¨åŸŸï¼Œæ˜¯å­æ¡†æ¶å…·æœ‰ä¿®æ”¹çˆ¶æ¡†æ¶srcçš„hashå€¼ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§è¿›è¡Œä¼ é€’æ•°æ®ï¼Œä¸”æ›´æ”¹hashå€¼ï¼Œé¡µé¢ä¸ä¼šåˆ·æ–°ã€‚<br>ä½†æ˜¯ä¼ é€’çš„æ•°æ®çš„å­—èŠ‚æ•°æ˜¯æœ‰é™çš„ã€‚</p><blockquote><p>è¡¥å……ï¼š å…¶å®è¿˜æœ‰ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚window.nameå’Œlocation.hashã€‚<br>å°±å¾ˆé€‚ç”¨äºiframeçš„è·¨åŸŸï¼Œä¸è¿‡iframeç”¨çš„æ¯”è¾ƒå°‘äº†ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•ä¹Ÿå°±æœ‰ç‚¹è¿‡æ—¶äº†ã€‚</p></blockquote><h4 id="ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡"><a href="#ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡" class="headerlink" title="ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡"></a>ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡</h4><p>window.postMessageæ˜¯ä¸€ä¸ªHTML5çš„apiï¼Œå…è®¸ä¸¤ä¸ªçª—å£ä¹‹é—´è¿›è¡Œè·¨åŸŸå‘é€æ¶ˆæ¯ã€‚<br>è¿™ä¸ªåº”è¯¥å°±æ˜¯ä»¥åè§£å†³domè·¨åŸŸé€šç”¨æ–¹æ³•äº†ï¼Œå…·ä½“å¯ä»¥å‚ç…§MDNã€‚</p><h3 id="ä¸€äº›å®ç”¨æ–¹æ³•"><a href="#ä¸€äº›å®ç”¨æ–¹æ³•" class="headerlink" title="ä¸€äº›å®ç”¨æ–¹æ³•"></a>ä¸€äº›å®ç”¨æ–¹æ³•</h3><ul><li>è·¨åŸŸä¸‹è·å–iframeçš„çˆ¶é¡µé¢URLï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getParentHost = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> host = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (parent !== <span class="built_in">window</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      host = parent.location.origin;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">const</span> url = <span class="built_in">document</span>.referrer;</span><br><span class="line">      host = url.split(<span class="string">'/'</span>).splice(<span class="number">0</span>, <span class="number">3</span>).join(<span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> host;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/28562290" target="_blank" rel="noopener">è·¨åŸŸçš„é‚£äº›äº‹å„¿</a></li><li><a href="https://www.jianshu.com/p/06529543f03a" target="_blank" rel="noopener">å‰ç«¯è·¨åŸŸæ•´ç†</a></li><li><a href="https://segmentfault.com/a/1190000015597029" target="_blank" rel="noopener">ä¸è¦å†é—®æˆ‘è·¨åŸŸçš„é—®é¢˜äº†</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è·¨åŸŸåœ¨å‰ç«¯æ˜¯ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ã€‚&lt;br&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œä»€ä¹ˆæƒ…å†µä¸‹å‡ºç°è·¨åŸŸã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ¦‚å¿µä»¥åŠåœºæ™¯&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µä»¥åŠåœºæ™¯&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µä»¥åŠåœºæ™¯&quot;&gt;&lt;/a&gt;æ¦‚å¿µä»¥åŠåœºæ™¯&lt;/h3&gt;&lt;p&gt;è·¨åŸŸçš„å§‹ä½œä¿‘è€…æ˜¯&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŒæºç­–ç•¥&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¢å¥è¯è¯´å°±æ˜¯ï¼Œæµè§ˆå™¨é™åˆ¶äº†ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªé¡µé¢ä¸‹é¢å»è°ƒç”¨å¦å¤–ä¸€ä¸ªæºçš„èµ„æºã€‚&lt;br&gt;æœ€å¸¸è§çš„åœºæ™¯æ˜¯æˆ‘ä»¬åœ¨å½“å‰é¡µé¢ä¸‹è°ƒç”¨äº†å¦ä¸€ä¸ªæºçš„æ¥å£ã€‚ç»“æœæµè§ˆå™¨ç›´æ¥æŠ¥é”™äº†ï¼Œè¯´ä¸è¡Œï¼Œä¸èƒ½è¿™æ ·å¹²ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åŒæºçš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="http" scheme="https://sampwood.github.io/categories/coding/http/"/>
    
    
      <category term="è·¨åŸŸ" scheme="https://sampwood.github.io/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>gitå¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜(LF/CRLF)</title>
    <link href="https://sampwood.github.io/2019/01/07/git%E5%A4%9A%E5%B9%B3%E5%8F%B0%E6%8D%A2%E8%A1%8C%E7%AC%A6%E9%97%AE%E9%A2%98-LF-CRLF/"/>
    <id>https://sampwood.github.io/2019/01/07/gitå¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜-LF-CRLF/</id>
    <published>2019-01-07T08:51:29.000Z</published>
    <updated>2019-03-06T05:51:53.735Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å·®å¼‚"><a href="#å·®å¼‚" class="headerlink" title="å·®å¼‚"></a>å·®å¼‚</h3><p>ç›®å‰å¤§éƒ¨åˆ†çš„å‰ç«¯å¼€å‘ç”¨macos/windowsæ¥å¼€å‘ï¼Œlinuxç³»ç»Ÿä½¿ç”¨çš„è¾ƒå°‘ã€‚<br>ä¸€ä¸ªå¤šäººå¼€å‘çš„é¡¹ç›®å¿…ç„¶ä¼šè¦†ç›–windowså’Œunixç³»ç»Ÿã€‚<br>è€Œè¿™ä¸ªä¸¤ä¸ªç³»ç»Ÿé—´å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚</p><p>CRLF, LF éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚ä¸»æµçš„æ“ä½œç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨CRLFæˆ–è€…LFä½œä¸ºå…¶æ–‡æœ¬çš„æ¢è¡Œç¬¦ã€‚<br>CR(Carriage Return) ä»£è¡¨å›è½¦ï¼Œå¯¹åº”å­—ç¬¦ <code>\r</code>ï¼›LF(Line Feed) ä»£è¡¨æ¢è¡Œï¼Œå¯¹åº”å­—ç¬¦ <code>\n</code>ã€‚</p><p>unix/linux(macos)ä½¿ç”¨çš„æ˜¯LFï¼Œwindowsä½¿ç”¨çš„æ˜¯CRLFã€‚</p><p>è·¨å¹³å°åä½œå¼€å‘æ˜¯å¸¸æœ‰çš„ï¼Œä¸ç»Ÿä¸€çš„æ¢è¡Œç¬¦ç¡®å®å¯¹è·¨å¹³å°çš„æ–‡ä»¶äº¤æ¢å¸¦æ¥äº†éº»çƒ¦ã€‚<br>æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¸åŒå¹³å°ä¸Šï¼Œæ¢è¡Œç¬¦å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒGit ä¼šè®¤ä¸ºæ•´ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œè¿™å°±é€ æˆæˆ‘ä»¬ <code>diff</code> ä¸èƒ½æ­£ç¡®åæ˜ æœ¬æ¬¡çš„ä¿®æ”¹ã€‚</p><p>ä¾‹å¦‚åœ¨æŸ¥çœ‹<code>diff</code>çš„æ—¶å€™ï¼Œå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">warning: LF will be replaced by CRLF in .gitignore.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in README.md.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p><a id="more"></a><h3 id="gitå¤„ç†"><a href="#gitå¤„ç†" class="headerlink" title="gitå¤„ç†"></a>gitå¤„ç†</h3><p>è¿˜å¥½ Git åœ¨è®¾è®¡æ—¶å°±è€ƒè™‘äº†è¿™ä¸€ç‚¹ï¼Œæä¾›äº†æ¢è¡Œç¬¦ç›¸å…³çš„å¤„ç†æ–¹å¼ã€‚</p><p>è¿™é‡Œå…ˆæŒ‡å®šä¸¤ä¸ªéå®˜æ–¹çš„æ¦‚å¿µï¼Œæ–¹ä¾¿åé¢è§£é‡Šä¸æè¿°ï¼š(é‡è¦ï¼Œå¦åˆ™åé¢çœ‹ä¸æ‡‚)</p><ol><li><strong>æ ‡å‡†åŒ–</strong> æŒ‡åœ¨æäº¤ä»£ç åˆ°gitæ•°æ®åº“(æœ¬åœ°åº“) ä¸­å°†æ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦CRLFè½¬ä¸ºLFçš„è¿‡ç¨‹</li><li><strong>è½¬æ¢</strong> æŒ‡åœ¨æ£€å‡ºGitæ•°æ®åº“ä»£ç è¿‡ç¨‹ä¸­å°†æ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦LFè½¬æ¢ä¸ºCRLFçš„è¿‡ç¨‹</li></ol><h4 id="core-autocrlf"><a href="#core-autocrlf" class="headerlink" title="core.autocrlf"></a>core.autocrlf</h4><p>gitæä¾›äº†ä¸€ä¸ª <code>autocrlf</code> çš„é…ç½®é¡¹ï¼Œç”¨äºåœ¨æäº¤å’Œæ£€å‡ºæ—¶è‡ªåŠ¨è½¬æ¢æ¢è¡Œç¬¦ï¼Œè¯¥é…ç½®æœ‰ä¸‰ä¸ªå¯é€‰é¡¹ï¼š</p><ul><li>true: æäº¤æ—¶è½¬æ¢ä¸º LFï¼Œæ£€å‡ºæ—¶è½¬æ¢ä¸º CRLF</li><li>false: æäº¤æ£€å‡ºå‡ä¸è½¬æ¢</li><li>input: æäº¤æ—¶è½¬æ¢ä¸ºLFï¼Œæ£€å‡ºæ—¶ä¸è½¬æ¢</li></ul><blockquote><p>CRLF ä¸ LF æ··åˆçš„æ–‡æœ¬æ–‡ä»¶ä¸å—æ­¤é…ç½®æ§åˆ¶ã€‚</p></blockquote><blockquote><p>Git å®‰è£…åé»˜è®¤ä¸º false</p></blockquote><p>æ‰€ä»¥ï¼Œä¸€ç§è§„èŒƒæ¢è¡Œç¬¦çš„æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š</p><p>ä½¿ç”¨ Windows ç³»ç»Ÿçš„å¼€å‘è€…è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.aurocrlf true</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ Linux/MacOS çš„å¼€å‘è€…è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.autocrlf input</span><br></pre></td></tr></table></figure></p><h4 id="core-safecrlf"><a href="#core-safecrlf" class="headerlink" title="core.safecrlf"></a>core.safecrlf</h4><p>gitåŒæ—¶æä¾›äº†å¦ä¸€ä¸ªé…ç½®é¡¹ <code>safecrlf</code>ï¼Œç”¨äºæ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒ…å«æ··åˆæ¢è¡Œç¬¦ï¼Œè¯¥é…ç½®ä¹Ÿæœ‰ä¸‰ä¸ªå¯é€‰é¡¹ï¼š</p><ul><li>true ç¦æ­¢æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶(git add çš„æ—¶å€™ä¼šè¢«æ‹¦æˆªï¼Œæç¤ºå¼‚å¸¸)</li><li>warn æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶çš„æ—¶å€™å‘å‡ºè­¦å‘Šï¼Œä½†æ˜¯ä¸ä¼šé˜»æ­¢ git add æ“ä½œ</li><li>false ä¸ç¦æ­¢æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶ï¼ˆé»˜è®¤é…ç½®ï¼‰</li></ul><p>è¯¥é…ç½®ç”¨æ¥é˜²æ­¢é”™è¯¯çš„æ ‡å‡†åŒ–ä¸è½¬æ¢ã€‚</p><h4 id="gitattributes-æ–‡ä»¶"><a href="#gitattributes-æ–‡ä»¶" class="headerlink" title=".gitattributes æ–‡ä»¶"></a><code>.gitattributes</code> æ–‡ä»¶</h4><p><code>core.autocrlf</code> çš„é…ç½®ä¾èµ–äºæ¯ä¸€ä½å‚ä¸é¡¹ç›®çš„å¼€å‘æœºå™¨ä¸Šçš„é…ç½®ï¼Œè¿™å¾ˆéš¾ç¡®ä¿æ¯ä¸ªäººéƒ½èƒ½æ­£ç¡®é…ç½®ã€‚<br>äºæ˜¯åœ¨è§„èŒƒé¡¹ç›®ä¸­çš„æ¢è¡Œç¬¦æ–¹é¢ï¼Œè¿˜æœ‰ä¸€å¥—æ·»åŠ é…ç½®æ–‡ä»¶çš„æ–¹æ¡ˆã€‚<br>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹å¯ä»¥æ·»åŠ ä¸€ä¸ª<code>.gitattributes</code> æ–‡ä»¶ã€‚<br>å®ƒçš„ä¼˜å…ˆçº§é«˜äº<code>core.autocrlf</code>çš„è®¾ç½®ï¼Œå¯ä»¥è¦†ç›–<code>core.autocrlf</code>çš„ã€‚<br>å®ƒç±»ä¼¼äº <code>.gitignore</code> æ–‡ä»¶ï¼Œéšæäº¤ä¿®æ”¹ç”Ÿæ•ˆï¼Œä¸€ä¸ªé¡¹ç›®ä¸­å¯ä»¥ç»´æŒä¸€ä»½ç›¸åŒçš„é…ç½®ã€‚<br>æ‰€ä»¥ï¼Œå®ƒèƒ½å¤Ÿé¿å…æ¯ä¸ªå¼€å‘äººå‘˜é…ç½®ä¸åŒçš„é—®é¢˜ã€‚</p><p><code>.gitattributes</code>æ–‡ä»¶çš„åŠŸèƒ½ä¸åªæœ‰é…ç½®æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥å®ƒçš„é…ç½®ç›¸å¯¹å¤æ‚ä¸€ä¸‹ã€‚<br>è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£å¯ä»¥å‚è€ƒ <a href="http://schacon.github.io/git/gitattributes.html" target="_blank" rel="noopener">åœ°å€</a>ã€‚<br>è¿™é‡Œåªé’ˆå¯¹æ¢è¡Œç¬¦çš„é…ç½®åšä¸€ä¸‹ç®€å•çš„ä»‹ç»ï¼š</p><p>æ¯è¡ŒåŸºæœ¬å½¢å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter attr1 attr2 ....</span><br></pre></td></tr></table></figure><p>filter ä»£è¡¨åŒ¹é…æ–‡ä»¶çš„é€šé…ç¬¦ï¼Œåœ¨å®ƒåé¢è·Ÿç€ç›¸åº”çš„å±æ€§ï¼Œç”¨ç©ºæ ¼é—´éš”ã€‚</p><p>filter çš„é€‰é¡¹æ¯”è¾ƒç®€å•ï¼Œå¸¸è§çš„:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* åŒ¹é…æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">*.txt  åŒ¹é…æ–‡ä»¶åä»¥txtç»“å°¾çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>attrçš„é€‰æ‹©æ¯”è¾ƒå¤šï¼Œå…¶ä¸­ä¸æ¢è¡Œç¬¦ç›¸å…³çš„å±æ€§åªæœ‰å‡ æ¡ï¼š</p><ul><li>text<ul><li>text è‡ªåŠ¨å®Œæˆæ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>-text ä¸æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>text=auto æ ¹æ® Git å†³å®šæ˜¯å¦éœ€è¦æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬åŒ–</li><li>ä¸è®¾ç½® ä½¿ç”¨core.autocrlfé…ç½®å†³å®šæ˜¯å¦æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬æ¢</li></ul></li><li>eol<ul><li>eol=lf å¼ºåˆ¶å®Œæˆæ ‡å‡†åŒ–ï¼Œä¸æ‰§è¡Œè½¬æ¢ï¼ˆç›¸å½“äºæŒ‡å®šè½¬æ¢ä¸ºLFæ ¼å¼ï¼‰</li><li>eol=crlf å¼ºåˆ¶å®Œæˆæ ‡å‡†åŒ–ï¼ŒæŒ‡å®šè½¬æ¢ä¸ºCRLFæ ¼å¼</li></ul></li><li>binary<ul><li>binary äºŒè¿›åˆ¶æ–‡ä»¶ä¸å‚ä¸æ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>ä¸è®¾ç½® ç”± Git å†³å®šæ˜¯å¦ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</li></ul></li></ul><blockquote><p>text è®¾ç½®çš„æ—¶å€™ï¼Œè½¬æ¢è‡ªåŠ¨è½¬æ¢åˆ°å¯¹åº”å¹³å°çš„æ¢è¡Œç¬¦</p></blockquote><blockquote><p>è¡Œå·é«˜çš„è®¾ç½®ä¼šè¦†ç›–è¡Œå·ä½çš„è®¾ç½®</p></blockquote><p>è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Set the default behavior, in case people don&apos;t have core.autocrlf set.</span><br><span class="line">* text eol=lf</span><br><span class="line"></span><br><span class="line"># Denote all files that are truly binary and should not be modified.</span><br><span class="line">*.png binary</span><br><span class="line">*.jpg binary</span><br></pre></td></tr></table></figure></p><p><strong>æ¨èä½¿ç”¨.gitattributesæ¥è§„èŒƒé¡¹ç›®ä¸­æ¢è¡Œç¬¦ã€‚ç®€å•ï¼Œæ–¹ä¾¿ï¼Œçµæ´»ã€‚</strong></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.jianshu.com/p/ec9564fe1c2b" target="_blank" rel="noopener">ç†è§£ CRLFï¼ŒLF</a></li><li><a href="http://blog.konghy.cn/2017/03/19/git-lf-or-crlf/" target="_blank" rel="noopener">Git å¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜(LF or CRLF)</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å·®å¼‚&quot;&gt;&lt;a href=&quot;#å·®å¼‚&quot; class=&quot;headerlink&quot; title=&quot;å·®å¼‚&quot;&gt;&lt;/a&gt;å·®å¼‚&lt;/h3&gt;&lt;p&gt;ç›®å‰å¤§éƒ¨åˆ†çš„å‰ç«¯å¼€å‘ç”¨macos/windowsæ¥å¼€å‘ï¼Œlinuxç³»ç»Ÿä½¿ç”¨çš„è¾ƒå°‘ã€‚&lt;br&gt;ä¸€ä¸ªå¤šäººå¼€å‘çš„é¡¹ç›®å¿…ç„¶ä¼šè¦†ç›–windowså’Œunixç³»ç»Ÿã€‚&lt;br&gt;è€Œè¿™ä¸ªä¸¤ä¸ªç³»ç»Ÿé—´å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;CRLF, LF éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚ä¸»æµçš„æ“ä½œç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨CRLFæˆ–è€…LFä½œä¸ºå…¶æ–‡æœ¬çš„æ¢è¡Œç¬¦ã€‚&lt;br&gt;CR(Carriage Return) ä»£è¡¨å›è½¦ï¼Œå¯¹åº”å­—ç¬¦ &lt;code&gt;\r&lt;/code&gt;ï¼›LF(Line Feed) ä»£è¡¨æ¢è¡Œï¼Œå¯¹åº”å­—ç¬¦ &lt;code&gt;\n&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;unix/linux(macos)ä½¿ç”¨çš„æ˜¯LFï¼Œwindowsä½¿ç”¨çš„æ˜¯CRLFã€‚&lt;/p&gt;
&lt;p&gt;è·¨å¹³å°åä½œå¼€å‘æ˜¯å¸¸æœ‰çš„ï¼Œä¸ç»Ÿä¸€çš„æ¢è¡Œç¬¦ç¡®å®å¯¹è·¨å¹³å°çš„æ–‡ä»¶äº¤æ¢å¸¦æ¥äº†éº»çƒ¦ã€‚&lt;br&gt;æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¸åŒå¹³å°ä¸Šï¼Œæ¢è¡Œç¬¦å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒGit ä¼šè®¤ä¸ºæ•´ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œè¿™å°±é€ æˆæˆ‘ä»¬ &lt;code&gt;diff&lt;/code&gt; ä¸èƒ½æ­£ç¡®åæ˜ æœ¬æ¬¡çš„ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚åœ¨æŸ¥çœ‹&lt;code&gt;diff&lt;/code&gt;çš„æ—¶å€™ï¼Œå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;warning: LF will be replaced by CRLF in .gitignore.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The file will have its original line endings in your working directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;warning: LF will be replaced by CRLF in README.md.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The file will have its original line endings in your working directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="version-control" scheme="https://sampwood.github.io/categories/coding/version-control/"/>
    
    
      <category term="git" scheme="https://sampwood.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>å…¨å±€é…ç½®ESLint</title>
    <link href="https://sampwood.github.io/2019/01/04/%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AEESLint/"/>
    <id>https://sampwood.github.io/2019/01/04/å…¨å±€é…ç½®ESLint/</id>
    <published>2019-01-04T06:23:58.000Z</published>
    <updated>2019-03-06T05:51:53.742Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ESLintæ˜¯ä¸€ä¸ªJavascripté™æ€æ£€æŸ¥å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®ä½ å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œä½¿ä½ çš„javascriptä»£ç è¾¾åˆ°å›½é™…åŒ–çš„æ°´å‡†ã€‚ESLintæ˜¯æ‰€æœ‰Javascrpté™æ€æ£€æŸ¥å·¥å…·é‡Œæœ€æ™šè¯ç”Ÿçš„ä¸€ä¸ªï¼Œä¹‹å‰è¿˜æ›¾ç»æœ‰è¿‡JSLintä»¥åŠJSHintç­‰å·¥å…·ï¼Œä½†JSLintå’ŒJSHintéƒ½æ˜¯ç”¨çš„ä¸€å¥—æ ‡å‡†ï¼Œåœ¨ç›®å‰è¿™ä¸ªå‰ç«¯æŠ€æœ¯é£é€Ÿå‘å±•çš„æ—¶ä»£å·²ç»æ˜¾å¾—æœ‰ç‚¹è½ä¼ã€‚ESLintçš„å¥½å¤„æ˜¯æ—¢æä¾›äº†å›½é™…å¤§å‚çš„æ ‡å‡†ï¼ŒåŒæ—¶åˆç»™äº†ä½ è‡ªå®šä¹‰æ ‡å‡†çš„å¯èƒ½æ€§ã€‚ESLintçš„æ¨èè®¾ç½®æ–¹å¼æ˜¯æŒ‰é¡¹ç›®è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šä¸ªä¸åŒçš„javascripté¡¹ç›®çš„è¯ï¼Œä¸€ä¸ªä¸€ä¸ªå»è®¾ç½®æœªå…å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä»‹ç»çš„æ˜¯å…¨å±€è®¾ç½®æ–¹æ³•ï¼Œä¸€æ¬¡è®¾ç½®ï¼Œæ‰€æœ‰é¡¹ç›®å…¨éƒ¨é‡‡ç”¨åŒä¸€æ ‡å‡†ã€‚</p></blockquote><p>ç›®å‰åœ¨è‡ªå·±çš„æœºå­ä¸Šé¢ç”¨åˆ°çš„eslinté…ç½®æ˜¯ï¼š<code>airbnb</code>+<code>eslint-plugin-vue</code>ã€‚</p><a id="more"></a><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>éœ€è¦å®‰è£…çš„åŒ…æœ‰ï¼š<code>eslint</code>, <code>eslint-config-airbnb-base</code>, <code>eslint-plugin-import</code>, <code>eslint-plugin-vue</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g eslint eslint-config-airbnb-base eslint-plugin-import eslint-plugin-vue</span><br></pre></td></tr></table></figure></p><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>å®‰è£…å¥½ä¾èµ–åŒ…ä¹‹åï¼Œéœ€è¦ç¼–å†™å…¨å±€<code>.eslintrc</code>æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;extends&quot;: [</span><br><span class="line">    &quot;airbnb-base&quot;,</span><br><span class="line">    &quot;plugin:vue/recommended&quot;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦‚æ­¤è¿™èˆ¬ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹jsæ–‡ä»¶ä¸­ä½¿ç”¨åŒä¸€å¥—æ ‡å‡†å»æ£€æŸ¥äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651230875&amp;idx=1&amp;sn=092211db96adfc85a26b457f7e9421a0&amp;chksm=bd494b1f8a3ec20902ad0df7d6a3735b536fe585086abc9035fe24d69549bb4c81cf88658515&amp;mpshare=1&amp;scene=1&amp;srcid=0104C1J16lllbEgkIyFIFJmp#rd" target="_blank" rel="noopener">ã€ç¬¬1495æœŸã€‘ ESLint å·¥ä½œåŸç†æ¢è®¨</a></li><li><a href="https://segmentfault.com/a/1190000005984309" target="_blank" rel="noopener">atomä½¿ç”¨å…¨å±€é…ç½®ESLint</a></li><li><a href="https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb" target="_blank" rel="noopener">airbnb/javascript</a></li><li><a href="https://vuejs.github.io/eslint-plugin-vue/user-guide/" target="_blank" rel="noopener">eslint-plugin-vue</a></li><li><a href="https://github.com/dustinspecker/awesome-eslint" target="_blank" rel="noopener">dustinspecker/awesome-eslint</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ESLintæ˜¯ä¸€ä¸ªJavascripté™æ€æ£€æŸ¥å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®ä½ å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œä½¿ä½ çš„javascriptä»£ç è¾¾åˆ°å›½é™…åŒ–çš„æ°´å‡†ã€‚ESLintæ˜¯æ‰€æœ‰Javascrpté™æ€æ£€æŸ¥å·¥å…·é‡Œæœ€æ™šè¯ç”Ÿçš„ä¸€ä¸ªï¼Œä¹‹å‰è¿˜æ›¾ç»æœ‰è¿‡JSLintä»¥åŠJSHintç­‰å·¥å…·ï¼Œä½†JSLintå’ŒJSHintéƒ½æ˜¯ç”¨çš„ä¸€å¥—æ ‡å‡†ï¼Œåœ¨ç›®å‰è¿™ä¸ªå‰ç«¯æŠ€æœ¯é£é€Ÿå‘å±•çš„æ—¶ä»£å·²ç»æ˜¾å¾—æœ‰ç‚¹è½ä¼ã€‚ESLintçš„å¥½å¤„æ˜¯æ—¢æä¾›äº†å›½é™…å¤§å‚çš„æ ‡å‡†ï¼ŒåŒæ—¶åˆç»™äº†ä½ è‡ªå®šä¹‰æ ‡å‡†çš„å¯èƒ½æ€§ã€‚ESLintçš„æ¨èè®¾ç½®æ–¹å¼æ˜¯æŒ‰é¡¹ç›®è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šä¸ªä¸åŒçš„javascripté¡¹ç›®çš„è¯ï¼Œä¸€ä¸ªä¸€ä¸ªå»è®¾ç½®æœªå…å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä»‹ç»çš„æ˜¯å…¨å±€è®¾ç½®æ–¹æ³•ï¼Œä¸€æ¬¡è®¾ç½®ï¼Œæ‰€æœ‰é¡¹ç›®å…¨éƒ¨é‡‡ç”¨åŒä¸€æ ‡å‡†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›®å‰åœ¨è‡ªå·±çš„æœºå­ä¸Šé¢ç”¨åˆ°çš„eslinté…ç½®æ˜¯ï¼š&lt;code&gt;airbnb&lt;/code&gt;+&lt;code&gt;eslint-plugin-vue&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linter" scheme="https://sampwood.github.io/categories/coding/linter/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="eslint" scheme="https://sampwood.github.io/tags/eslint/"/>
    
  </entry>
  
</feed>
