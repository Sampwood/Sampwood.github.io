<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sampwoodçš„One Piece</title>
  
  <subtitle>step by step</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://sampwood.github.io/"/>
  <updated>2019-10-25T05:55:06.534Z</updated>
  <id>https://sampwood.github.io/</id>
  
  <author>
    <name>Sampwood</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>webç«¯çš„éŸ³é¢‘æµ</title>
    <link href="https://sampwood.github.io/2019/10/25/stream-web/"/>
    <id>https://sampwood.github.io/2019/10/25/stream-web/</id>
    <published>2019-10-25T01:39:09.000Z</published>
    <updated>2019-10-25T05:55:06.534Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„é¢˜ç›®ï¼šæ€ä¹ˆä½¿ç”¨HTML5å®ç°å½•éŸ³çš„åŠŸèƒ½ï¼Ÿ</p><p>ç„¶åè¯•ç€äº†è§£äº†ä¸‹ï¼Œå®ç°åŸç†ä¸»è¦æ˜¯ç”¨äº†<code>MediaStream</code>è¿™ä¸ªå¯¹è±¡ã€‚</p><blockquote><p>The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks.<br>Each track is specified as an instance of MediaStreamTrack.<br>You can obtain a MediaStream object either by using the constructor or by calling MediaDevices.getUserMedia().</p></blockquote><p>è¿™æ˜¯æ¥è‡ª<code>MDNæ–‡æ¡£</code> å¯¹ <code>MediaStream</code> çš„è¯´æ˜ã€‚</p><p>ä»ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ <code>MediaDevices.getUserMedia()</code> æ–¹æ³•æ¥è·å–è®¾å¤‡çš„éŸ³é¢‘è¾“å…¥åŠŸèƒ½ã€‚</p><a id="more"></a><h3 id="è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½"><a href="#è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½" class="headerlink" title="è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½"></a>è·å–è®¾å¤‡çš„æ‘„åƒå¤´å’Œéº¦å…‹é£åŠŸèƒ½</h3><blockquote><p>The MediaDevices.getUserMedia() method prompts the user for permission to use a media input<br>which produces a MediaStream with tracks containing the requested types of media.<br>That stream can include, for example,<br>a video track (produced by either a hardware or virtual video source such as a camera, video recording device, screen sharing service, and so forth),<br>an audio track (similarly, produced by a physical or virtual audio source like a microphone, A/D converter, or the like), and possibly other track types.</p></blockquote><p>è¿™æ˜¯æ¥è‡ª<code>MDNæ–‡æ¡£</code>çš„è¯´æ˜ã€‚</p><p><code>MediaDevices.getUserMedia()</code> è¿™ä¸ªæ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>constraints</code> , æ¥æŒ‡å®šå¯¹è¯­éŸ³/è§†é¢‘çš„é™åˆ¶ï¼Œä¾‹å¦‚ï¼š <code>{ audio: true, video: true }</code></p><p>ç„¶åå‚è€ƒå®ƒæä¾›çš„demoï¼Œå†™äº†ä¸ª å®æ—¶å½•éŸ³å¹¶æ’­æ”¾çš„åŠŸèƒ½ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"padding: 50px;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Older browsers might not implement mediaDevices at all, so we set an empty object first</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (navigator.mediaDevices === <span class="literal">undefined</span>) &#123;</span></span><br><span class="line"><span class="undefined">      navigator.mediaDevices = &#123;&#125;;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Some browsers partially implement mediaDevices. We can't just assign an object</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// with getUserMedia as it would overwrite existing properties.</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// Here, we will just add the getUserMedia property if it's missing.</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (navigator.mediaDevices.getUserMedia === <span class="literal">undefined</span>) &#123;</span></span><br><span class="line"><span class="javascript">      navigator.mediaDevices.getUserMedia = <span class="function"><span class="keyword">function</span>(<span class="params">constraints</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// First get ahold of the legacy getUserMedia, if present</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// Some browsers just don't implement it - return a rejected promise with an error</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// to keep a consistent interface</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (!getUserMedia) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'getUserMedia is not implemented in this browser'</span>));</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// Otherwise, wrap the call to the old navigator.getUserMedia with a Promise</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">          getUserMedia.call(navigator, constraints, resolve, reject);</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    navigator.mediaDevices.getUserMedia(&#123; <span class="attr">audio</span>: <span class="literal">true</span>, <span class="attr">video</span>: <span class="literal">false</span> &#125;)</span></span><br><span class="line"><span class="javascript">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">stream</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// Older browsers may not have srcObject</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (<span class="string">"srcObject"</span> <span class="keyword">in</span> audio) &#123;</span></span><br><span class="line"><span class="undefined">        audio.srcObject = stream;</span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// Avoid using this in new browsers, as it is going away.</span></span></span><br><span class="line"><span class="javascript">        audio.src = <span class="built_in">window</span>.URL.createObjectURL(stream);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="javascript">      audio.onloadedmetadata = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">        audio.play();</span></span><br><span class="line"><span class="undefined">      &#125;;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="javascript">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(err.name + <span class="string">": "</span> + err.message);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šå¯ä»¥çœ‹å‡ºï¼Œåªè¦æŠŠ <code>audio.srcObject</code> è®¾ç½®æˆè·å–åˆ°çš„ <code>stream</code> å°±å¯ä»¥æ’­æ”¾å½•éŸ³äº†ã€‚</p><h3 id="å¦‚ä½•åœæ­¢å½•éŸ³"><a href="#å¦‚ä½•åœæ­¢å½•éŸ³" class="headerlink" title="å¦‚ä½•åœæ­¢å½•éŸ³"></a>å¦‚ä½•åœæ­¢å½•éŸ³</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†éŸ³é¢‘æµçš„è¾“å…¥å’Œè¾“å‡ºã€‚ä½†æ˜¯è¿™ä¸ª <code>audio</code> çš„æš‚åœä¼¼ä¹åªæ§åˆ¶äº†éŸ³é¢‘çš„è¾“å‡ºï¼Œé‚£å¦‚ä½•åœæ­¢éŸ³é¢‘çš„è¾“å…¥å‘¢ï¼Ÿ<br><code>MediaStream</code> æœ¬èº«æ²¡æœ‰æä¾› <code>stop/end</code> ä¹‹ç±»çš„æ–¹æ³•ã€‚</p><p>ä»<code>MediaStream</code> çš„è¯´æ˜ä¸­ï¼Œå¯ä»¥çœ‹å‡º <code>MediaStream</code> æ˜¯ç”± <code>MediaStreamTrack</code> ç»„æˆçš„ã€‚</p><blockquote><p>The MediaStreamTrack interface represents a single media track within a stream;<br>typically, these are audio or video tracks, but other track types may exist as well.</p></blockquote><p><code>MediaStreamTrack</code> æä¾›äº† <code>stop</code> æ–¹æ³•ï¼š</p><blockquote><p>Stops playing the source associated to the track, both the source and the track are deassociated. The track state is set to ended.</p></blockquote><blockquote><p>Calling stop() tells the user agent that the trackâ€™s sourceâ€”whatever that source may be, including files, network streams, or a local camera or microphoneâ€”is no longer needed by the MediaStreamTrack.  Since multiple tracks may use the same source (for example, if two tabs are using the deviceâ€™s microphone), the source itself isnâ€™t necessarily immediately stopped. It is instead disassociated from the track and the track object is stopped. Once no media tracks are using the source, the source may actually be completely stopped.</p></blockquote><blockquote><p>Immediately after calling stop(), the track state is set to ended.</p></blockquote><p>æ‰€ä»¥åœæ­¢å½•éŸ³çš„æ–¹æ³•æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stream.getTracks()tracks.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">track</span>) </span>&#123;</span><br><span class="line">  track.stop();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="éŸ³é¢‘æµçš„ä¿å­˜"><a href="#éŸ³é¢‘æµçš„ä¿å­˜" class="headerlink" title="éŸ³é¢‘æµçš„ä¿å­˜"></a>éŸ³é¢‘æµçš„ä¿å­˜</h3><p>å½“æˆ‘ä»¬è°ƒç”¨äº†è®¾å¤‡çš„éº¦å…‹é£ä¹‹åï¼Œå¾—åˆ°äº† <code>stream</code>ã€‚é€šè¿‡ <code>audio</code> æ ‡ç­¾å®ç°äº† <code>stream</code> çš„è¾“å‡ºã€‚æ­¤æ—¶å¦‚æœè¦æŠŠå¾—åˆ°è¿™æ®µ<code>stream</code> ä¿å­˜ä¸‹æ¥è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ</p><blockquote><p>The MediaStream Recording API, sometimes simply referred to as the Media Recording API or the MediaRecorder API, is closely affiliated with the Media Capture and Streams API and the WebRTC API. The MediaStream Recording API makes it possible to capture the data generated by a MediaStream or HTMLMediaElement object for analysis, processing, or saving to disk. Itâ€™s also surprisingly easy to work with.</p></blockquote><blockquote><p>The MediaStream Recording API is comprised of a single major interface, MediaRecorder, which does all the work of taking the data from a MediaStream and delivering it to you for processing. The data is delivered by a series of dataavailable events, already in the format you specify when creating the MediaRecorder. You can then process the data further or write it to file as desired.</p></blockquote><p>åŸæ¥è¿˜æœ‰ä¸ª <code>MediaRecorder</code> ç”¨ä»¥å®Œæˆæ•°æ®çš„ä¿å­˜ğŸ˜„</p><p>å‚è€ƒ<code>MDN</code> æä¾›çš„demoï¼Œå®ç°éŸ³é¢‘çš„ä¿å­˜å’Œé‡æ’­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> recordedChunks = []</span><br><span class="line"><span class="keyword">const</span> mediaRecorder = <span class="keyword">new</span> MediaRecorder(stream) <span class="comment">// stream å°±æ˜¯æˆ‘ä»¬å‰é¢è·å–åˆ°çš„ stream</span></span><br><span class="line"></span><br><span class="line">mediaRecorder.ondataavailable = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  recordedChunks.push(e.data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mediaRecorder.onstop = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> blob = <span class="keyword">new</span> Blob(recordedChunks, &#123; <span class="string">'type'</span> : <span class="string">'audio/ogg; codecs=opus'</span> &#125;)</span><br><span class="line">  <span class="keyword">const</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>) <span class="comment">// æˆ–è€…å…¶ä»–çš„ audio å¯¹è±¡</span></span><br><span class="line">  audio.src = URL.createObjectURL(blob)</span><br><span class="line">  audio.srcObject = <span class="literal">null</span> <span class="comment">// å¦‚æœä¹‹å‰çš„ audioè®¾ç½®äº† srcObject åˆ™éœ€è¦åœ¨æ­¤å¤„è®¾ç½®ä¸ºnullï¼›å¦åˆ™ä¸éœ€è¦æ¬¡æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mediaRecorder.start() <span class="comment">// å¼€å§‹è®°å½•</span></span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  mediaRecorder.stop() <span class="comment">// ç»“æŸè®°å½•</span></span><br><span class="line">&#125;, <span class="number">5000</span>) <span class="comment">// è‡ªå®šä¹‰5såç»“æŸè®°å½•ï¼Œæˆ–è€…æ‰‹åŠ¨ç»“æŸ</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¦ä¸‹è½½çš„è¯ï¼Œåªéœ€æŠŠä¸Šé¢åˆ›å»ºçš„ <code>url</code> æ”¾åˆ° <code>a</code> æ ‡ç­¾ä¸­å°±å¯å®ç°ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API" target="_blank" rel="noopener">Media Capture and Streams API (Media Stream)</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" target="_blank" rel="noopener">MediaDevices.getUserMedia()</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/stop" target="_blank" rel="noopener">MediaStreamTrack.stop()</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API" target="_blank" rel="noopener">MediaStream Recording API</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ˜¨å¤©çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„é¢˜ç›®ï¼šæ€ä¹ˆä½¿ç”¨HTML5å®ç°å½•éŸ³çš„åŠŸèƒ½ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç„¶åè¯•ç€äº†è§£äº†ä¸‹ï¼Œå®ç°åŸç†ä¸»è¦æ˜¯ç”¨äº†&lt;code&gt;MediaStream&lt;/code&gt;è¿™ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks.&lt;br&gt;Each track is specified as an instance of MediaStreamTrack.&lt;br&gt;You can obtain a MediaStream object either by using the constructor or by calling MediaDevices.getUserMedia().&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯æ¥è‡ª&lt;code&gt;MDNæ–‡æ¡£&lt;/code&gt; å¯¹ &lt;code&gt;MediaStream&lt;/code&gt; çš„è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;MediaDevices.getUserMedia()&lt;/code&gt; æ–¹æ³•æ¥è·å–è®¾å¤‡çš„éŸ³é¢‘è¾“å…¥åŠŸèƒ½ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="html" scheme="https://sampwood.github.io/categories/coding/html/"/>
    
    
      <category term="html5" scheme="https://sampwood.github.io/tags/html5/"/>
    
  </entry>
  
  <entry>
    <title>å¼•å…¥stylelintå¯¹é¡¹ç›®åšä»£ç æ ·å¼å®¡æŸ¥</title>
    <link href="https://sampwood.github.io/2019/10/09/stylelint/"/>
    <id>https://sampwood.github.io/2019/10/09/stylelint/</id>
    <published>2019-10-09T03:05:09.000Z</published>
    <updated>2019-10-12T03:32:50.336Z</updated>
    
    <content type="html"><![CDATA[<p>æ—©å°±çœ‹åˆ°<code>stylelint</code> çš„ä»‹ç»æ–‡ç« ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚å› ä¸ºæ‡’ï¼Œè¿™å‡ å¤©æ‰æ¥å…¥äº†è¿™ä¸ªæ ·å¼æ£€æŸ¥çš„å·¥å…·ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹å¦‚ä½•å¼•å…¥è¿™ä¸ªåº“å§ã€‚</p><h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><p>å®‰è£…ç›¸å…³ä¾èµ–åº“<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add stylelint stylelint-config-standard stylelint-config-prettier</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>ä»è¿™é‡Œçœ‹å¥½åƒå¹¶æ²¡æœ‰å®‰è£…<code>webpack</code>ç›¸å…³çš„<code>plugin</code>å•Šï¼Œéš¾é“é›†æˆåˆ°<code>webpack</code>ä¸­ä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿ</p><p>è¿™é‡Œå°±ä¸å¾—ä¸è¯´ä¸‹äº†ï¼Œåœ¨<a href="https://vue-loader.vuejs.org/zh/guide/linting.html#eslint" target="_blank" rel="noopener">Vue Loader-ä»£ç æ ¡éªŒ (Linting)</a>ä¸­æœ‰ä»‹ç»å¦‚ä½•é›†æˆ<br><code>stylelint</code> åˆ° <code>webpack</code>ï¼Œåšè‡ªåŠ¨åŒ–æ£€æµ‹ã€‚</p><p>ä½†æ˜¯è¿™ä¸ªé…ç½®å…¶å®ä¸é€‚ç”¨åœ¨ç”±<code>vue cli3</code>ç”Ÿæˆçš„é¡¹ç›®ä¸­ã€‚é…ç½®<code>stylelint-webpack-plugin</code>æ’ä»¶åˆ°<code>vue.config.js</code>ä¸­ä¹‹åï¼Œé¡¹ç›®è¿è¡Œä¸èµ·æ¥ã€‚ğŸ˜£</p><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><h4 id="è§„åˆ™æ–‡ä»¶"><a href="#è§„åˆ™æ–‡ä»¶" class="headerlink" title="è§„åˆ™æ–‡ä»¶"></a>è§„åˆ™æ–‡ä»¶</h4><p>æ–°å»ºè§„åˆ™æ–‡ä»¶ï¼š<code>.stylelintrc.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [</span><br><span class="line">    <span class="string">'stylelint-config-standard'</span>,</span><br><span class="line">    <span class="string">'stylelint-config-prettier'</span></span><br><span class="line">  ],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'rule-empty-line-before'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'at-rule-empty-line-before'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'no-descending-specificity'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'font-family-no-missing-generic-family-keyword'</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">'max-empty-lines'</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">'block-opening-brace-space-before'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'indentation'</span>: [<span class="number">2</span>],</span><br><span class="line">    <span class="string">'function-comma-space-after'</span>: <span class="string">'always-single-line'</span>,</span><br><span class="line">    <span class="string">'selector-list-comma-newline-after'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'value-list-comma-newline-after'</span>: <span class="string">'always-multi-line'</span>,</span><br><span class="line">    <span class="string">'declaration-block-trailing-semicolon'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'declaration-colon-space-after'</span>: <span class="string">'always'</span>,</span><br><span class="line">    <span class="string">'color-hex-case'</span>: <span class="string">'lower'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å› ä¸ºæˆ‘åœ¨é¡¹ç›®ç”¨äº†<code>prettier</code> æ¥æ ¼å¼åŒ–jsä»£ç ï¼Œä¸ºäº†ä¿è¯å…¶ä¸<code>stylelint</code> ä¸å†²çªï¼Œæˆ‘<code>extends</code>äº†<code>stylelint-config-prettier</code>ã€‚<br>è¿™æ ·æˆ‘å°±ä¸å¾—ä¸åŠ ä¸€äº›è‡ªå®šä¹‰çš„<code>rules</code>äº†ã€‚å› ä¸º<code>stylelint-config-prettier</code>çš„è§„åˆ™çœŸçš„å¾ˆå¼±ï¼Œå¾ˆå¤šéƒ½ä¸æ£€æŸ¥ã€‚</p><p>å½“ç„¶å¦‚æœè¦å¿½ç•¥æŸäº›æ–‡ä»¶ï¼Œå¯ä»¥å»ºä¸€ä¸ª<code>.stylelintignore</code>æ–‡ä»¶ã€‚</p><h4 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h4><p>åœ¨<code>package.json</code> ä¸­å®šä¹‰<code>script</code>æ¥è‡ªåŠ¨è¿è¡Œç›‘æµ‹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    "lint": "vue-cli-service lint", // vue cli3ç”Ÿäº§é¡¹ç›®è‡ªå¸¦çš„</span><br><span class="line">    "lint:style": "stylelint 'public/index.html' 'src/**/*.&#123;css,less,vue&#125;'", //æ–°åŠ çš„</span><br><span class="line">  &#125;,</span><br><span class="line">  "lint-staged": &#123;</span><br><span class="line">    "*.&#123;js,vue&#125;": [ // è¿™ä¸ªæ˜¯prettierç”¨çš„ï¼Œå¦‚æœæ²¡æœ‰åœ¨é¡¹ç›®ç”¨prettierï¼Œå°±ä¸éœ€è¦è¿™ä¸ª</span><br><span class="line">      "vue-cli-service lint",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ],</span><br><span class="line">    "*.&#123;html,vue,css,less&#125;": [ // è¿™ä¸ªæ˜¯stylelintç”¨çš„</span><br><span class="line">      "stylelint 'public/index.html' 'src/**/*.&#123;css,less,vue&#125;' --fix",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®<code>package.json</code>æ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥æ‰‹åŠ¨è¿è¡Œ<code>yarn lint:style</code>æ¥æ£€æŸ¥æ ·å¼ä»£ç äº†ï¼Œæˆ–è€…<code>yarn lint:style --fix</code>æ¥è‡ªåŠ¨çŸ«æ­£</p><p>åœ¨<code>lint-staged</code>ä¸­åŠ çš„ä»£ç ï¼Œæ˜¯ä¸ºäº†èƒ½åœ¨ä»£ç <code>git commit</code>ä¹‹å‰è‡ªåŠ¨åšä¸€ä¸ªæ£€æŸ¥ï¼Œä¹Ÿå°±ä¸éœ€è¦æ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘å‘½ä»¤äº†ã€‚</p><h3 id="vscodeå·¥å…·"><a href="#vscodeå·¥å…·" class="headerlink" title="vscodeå·¥å…·"></a>vscodeå·¥å…·</h3><p>åœ¨<code>vscode</code>ä¸­å®‰è£…<code>stylelint</code>æ’ä»¶ï¼ŒæŒ‰ç…§ä»–çš„è¦æ±‚ä¿®æ”¹ä¸‹<code>settings.json</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"css.validate": false,</span><br><span class="line">"less.validate": false,</span><br><span class="line">"scss.validate": false</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæ’ä»¶ç›®å‰è¿˜ä¸æ”¯æŒåœ¨ä¿å­˜æ—¶è‡ªåŠ¨fixã€‚<code>stylelint-plus</code>å¯ä»¥ï¼Œä½†æ˜¯ä¸‹è½½é‡è¿˜æ˜¯è¾ƒå°‘</p><p>Soï¼Œåˆ°æ­¤ï¼Œå¼•å…¥<code>stylelint</code>æˆåŠŸã€‚ğŸ‘ğŸ‘ğŸ‘</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://stylelint.io/" target="_blank" rel="noopener">stylelintå®˜ç½‘</a></li><li><a href="https://prettier.io/docs/en/integrating-with-linters.html#recommended-configuration-2" target="_blank" rel="noopener">prettier-Integrating with Linters</a></li><li><a href="https://vue-loader.vuejs.org/zh/guide/linting.html#eslint" target="_blank" rel="noopener">Vue Loader-ä»£ç æ ¡éªŒ (Linting)</a></li><li><a href="https://segmentfault.com/a/1190000008708473" target="_blank" rel="noopener">å¼•å…¥stylelintå¯¹CSS/Sassåšä»£ç å®¡æŸ¥</a></li><li><a href="https://juejin.im/post/5c31c9a16fb9a049f8197000" target="_blank" rel="noopener">å¦‚ä½•ä¸ºä½ çš„ Vue é¡¹ç›®æ·»åŠ é…ç½® Stylelint</a></li><li><a href="https://segmentfault.com/a/1190000020168436" target="_blank" rel="noopener">åœ¨Vueé¡¹ç›®ä¸­ä½¿ç”¨Eslint+Prettier+Stylelint</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ—©å°±çœ‹åˆ°&lt;code&gt;stylelint&lt;/code&gt; çš„ä»‹ç»æ–‡ç« ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚å› ä¸ºæ‡’ï¼Œè¿™å‡ å¤©æ‰æ¥å…¥äº†è¿™ä¸ªæ ·å¼æ£€æŸ¥çš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹å¦‚ä½•å¼•å…¥è¿™ä¸ªåº“å§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h3&gt;&lt;p&gt;å®‰è£…ç›¸å…³ä¾èµ–åº“&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yarn add stylelint stylelint-config-standard stylelint-config-prettier&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="css" scheme="https://sampwood.github.io/categories/coding/css/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="css" scheme="https://sampwood.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘é¡µæ€§èƒ½ä¼˜åŒ–</title>
    <link href="https://sampwood.github.io/2019/10/08/web-performance/"/>
    <id>https://sampwood.github.io/2019/10/08/web-performance/</id>
    <published>2019-10-08T10:47:33.000Z</published>
    <updated>2019-10-08T10:49:40.311Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸‹ç›®å‰äº†è§£çš„ä¸€äº›ä¼˜åŒ–ç½‘é¡µæ€§èƒ½çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆæ¬¡åŠ è½½æ—¶é—´ç­‰ã€‚</p><h3 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h3><p>ç›®å‰å¼€å‘çš„é¡¹ç›®éƒ½æ˜¯ <code>vue</code> é¡¹ç›®ï¼Œ<code>vue cli3</code> é»˜è®¤ä½¿ç”¨ <code>webpack</code> æ‰“åŒ…ï¼Œæ‰€ä»¥ä» <code>webpack</code> æ–¹é¢å…¥æ‰‹ä¼˜åŒ–é¡¹ç›®æ˜¯ä¸ªæŒºå¥½çš„è§’åº¦ã€‚</p><h4 id="preload-prefetch"><a href="#preload-prefetch" class="headerlink" title="preload prefetch"></a>preload prefetch</h4><p>å¯åŠ¨ä¸€ä¸ª <code>vue cli3</code> åˆ›å»ºçš„é¡¹ç›®ï¼Œå‘ç°åœ¨ <code>network</code> ä¸­å¤šäº†å¾ˆå¤šçš„è¯·æ±‚ï¼Œç‰¹æ®Šçš„è¯·æ±‚ã€‚è¿™äº›è¯·æ±‚è¢«å½’ç±»åˆ° <code>other</code> ä¸­ã€‚<br>è€Œä¸”è¿™äº›èµ„æºè¢«è¯·æ±‚äº†ä¸¤æ¬¡ã€‚</p><p>æŸ¥æ‰¾äº†ä¸‹èµ„æ–™å‘ç°ï¼ŒåŸæ¥æ˜¯å› ä¸ºè¿™äº› <code>other</code> èµ„æºä½¿ç”¨äº† <code>preload</code> æˆ– <code>prefetch</code>ã€‚</p><p>é‚£è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><a id="more"></a><h5 id="preload"><a href="#preload" class="headerlink" title="preload"></a>preload</h5><p><code>preload</code> æŒ‡ä»¤è®©æµè§ˆå™¨ä»¥<strong>é«˜ä¼˜ç§€çº§</strong>é¢„åŠ è½½æŒ‡å®šçš„èµ„æºã€‚æµè§ˆå™¨åœ¨é‡åˆ°<code>preload</code> åä¼šå·²å¼‚æ­¥çš„æ–¹å¼ä¸‹è½½èµ„æºï¼Œä¹Ÿä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ã€‚</p><p>åœ¨ä¸‹è½½å®Œæˆä¹‹åå­˜åœ¨å†…å­˜ä¸­ï¼Œåœ¨é¡µé¢è§£æåˆ°scriptåŠ è½½çš„æ—¶å€™ï¼Œç›´æ¥è¯»å–æ‰§è¡Œã€‚</p><p>ä½†æ˜¯å‡å¦‚ä½ åœ¨å½“å‰é¡µé¢æ²¡æœ‰ç”¨åˆ°<code>preload</code> çš„èµ„æºï¼ŒChrome ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šã€‚</p><p>è¿™å…¶å®æ˜¯<code>preload</code> å’Œ <code>prefetch</code> çš„åŒºåˆ«ã€‚<br><code>preload</code> æ˜¯ä»¥<code>é«˜ä¼˜å…ˆçº§</code>å»åŠ è½½å½“å‰é¡µé¢å°†è¦ä½¿ç”¨çš„èµ„æºï¼Œè€Œ<code>prefetch</code> æ˜¯ä»¥<code>ä½ä¼˜å…ˆçº§</code>å»åŠ è½½ä¸‹ä¸ªé¡µé¢å°†ä¼šä½¿ç”¨åˆ°çš„èµ„æºã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"/main.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="prefetch"><a href="#prefetch" class="headerlink" title="prefetch"></a>prefetch</h5><p><code>Prefetch</code> æ˜¯ä¸€ä¸ªä½ä¼˜å…ˆçº§çš„èµ„æºæç¤ºï¼Œå…è®¸æµè§ˆå™¨åœ¨<strong>åå°ï¼ˆç©ºé—²æ—¶ï¼‰</strong>è·å–å°†æ¥å¯èƒ½ç”¨å¾—åˆ°çš„èµ„æºï¼Œå¹¶ä¸”å°†ä»–ä»¬å­˜å‚¨åœ¨æµè§ˆå™¨çš„ç¼“å­˜ä¸­ã€‚<br>ä¸€æ—¦ä¸€ä¸ªé¡µé¢åŠ è½½å®Œæ¯•å°±ä¼šå¼€å§‹ä¸‹è½½å…¶ä»–çš„èµ„æºï¼Œç„¶åå½“ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªå¸¦æœ‰ prefetched çš„è¿æ¥ï¼Œå®ƒå°†å¯ä»¥ç«‹åˆ»ä»ç¼“å­˜ä¸­åŠ è½½å†…å®¹ã€‚<br>æœ‰ä¸‰ç§ä¸åŒçš„ <code>prefetch</code> çš„ç±»å‹ï¼Œ<code>link</code>ï¼Œ<code>DNS</code> å’Œ <code>prerender</code>ï¼Œä¸‹é¢æ¥è¯¦ç»†åˆ†æã€‚</p><p><code>link</code> ç”¨äºåŠ è½½èµ„æºï¼Œ<code>DNS</code> ç”¨äºè§£æDNSï¼Œ<code>prerender</code> ç”¨äºæ¸²æŸ“é¡µé¢ã€‚</p><h5 id="é¢„å…ˆè§£æDNS"><a href="#é¢„å…ˆè§£æDNS" class="headerlink" title="é¢„å…ˆè§£æDNS"></a>é¢„å…ˆè§£æDNS</h5><p><code>DNS prefetching</code> å…è®¸æµè§ˆå™¨åœ¨ç”¨æˆ·æµè§ˆé¡µé¢æ—¶åœ¨åå°è¿è¡Œ DNS çš„è§£æã€‚å¦‚æ­¤ä¸€æ¥ï¼Œ<code>DNS</code> çš„è§£æåœ¨ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æ—¶å·²ç»å®Œæˆï¼Œæ‰€ä»¥å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚<br>å¯ä»¥åœ¨ä¸€ä¸ª <code>link</code> æ ‡ç­¾çš„å±æ€§ä¸­æ·»åŠ  <code>rel=&quot;dns-prefetch&#39;</code> æ¥å¯¹æŒ‡å®šçš„ <code>URL</code> è¿›è¡Œ <code>DNS prefetching</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨headæ ‡ç­¾ä¸­ï¼Œè¶Šæ—©è¶Šå¥½--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"https://cdn.bootcss.com/"</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="preconnect"><a href="#preconnect" class="headerlink" title="preconnect"></a>preconnect</h5><p><code>preconnect</code> å…è®¸æµè§ˆå™¨åœ¨ä¸€ä¸ª <code>HTTP</code> è¯·æ±‚æ­£å¼å‘ç»™æœåŠ¡å™¨å‰é¢„å…ˆæ‰§è¡Œä¸€äº›æ“ä½œï¼Œè¿™åŒ…æ‹¬ <code>DNS</code> è§£æï¼Œ<code>TLS</code> åå•†ï¼Œ<code>TCP</code> æ¡æ‰‹ï¼Œè¿™æ¶ˆé™¤äº†å¾€è¿”å»¶è¿Ÿå¹¶ä¸ºç”¨æˆ·èŠ‚çœäº†æ—¶é—´ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.domain.com"</span> <span class="attr">rel</span>=<span class="string">"preconnect"</span> <span class="attr">crossorigin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="deferå’Œasync"><a href="#deferå’Œasync" class="headerlink" title="deferå’Œasync"></a>deferå’Œasync</h4><p>æ—¢ç„¶è¯´åˆ°èµ„æºçš„åŠ è½½ï¼Œå°±ä¸å¾—ä¸è¯´åˆ°jsæ–‡ä»¶çš„å¼‚æ­¥åŠ è½½ã€‚</p><p><code>defer</code> å’Œ <code>async</code> æ˜¯scriptæ ‡ç­¾çš„ä¸¤ä¸ªå±æ€§ï¼Œç”¨äºåœ¨ä¸é˜»å¡é¡µé¢æ–‡æ¡£è§£æçš„å‰æä¸‹ï¼Œæ§åˆ¶è„šæœ¬çš„ä¸‹è½½å’Œæ‰§è¡Œã€‚</p><p><code>defer</code> çš„æ‰§è¡Œæ—¶é—´æ˜¯åœ¨æ‰€æœ‰å…ƒç´ è§£æå®Œæˆä¹‹åï¼Œ<code>DOMContentLoaded</code> äº‹ä»¶è§¦å‘ä¹‹å‰ã€‚</p><p><code>async</code> çš„æ‰§è¡Œæ—¶é—´æ˜¯åœ¨å½“å‰JSè„šæœ¬ä¸‹è½½å®Œæˆåï¼Œæ‰€ä»¥å¤šä¸ª<code>async</code> scriptæ˜¯æ‰§è¡Œé¡ºåºæ˜¯ä¸å›ºå®šçš„ã€‚<code>async</code> åªèƒ½ç”¨äºåŠ è½½ä¸€äº›ç‹¬ç«‹æ— ä¾èµ–çš„ä»£ç ï¼Œæ¯”å¦‚Google Analysisä¹‹ç±»ã€‚</p><p><img src="/images/script-load.png" alt="script-load"></p><p>æ‰€ä»¥ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç»“æ„å¦‚ä¸‹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Faster<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//cdn.com/"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"//cdn.com/"</span> <span class="attr">rel</span>=<span class="string">"preconnect"</span> <span class="attr">crossorigin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part1.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part2.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/currentPage-part3.js"</span> <span class="attr">as</span>=<span class="string">"script"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"prefetch"</span> <span class="attr">href</span>=<span class="string">"//js.cdn.com/prefetch.js"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part1.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part2.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//js.cdn.com/currentPage-part3.js"</span> <span class="attr">defer</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="vue-config-js"><a href="#vue-config-js" class="headerlink" title="vue.config.js"></a>vue.config.js</h4><p>é€šè¿‡è‡ªå®šä¹‰chunks æŠŠç¬¬ä¸‰æ–¹åŒ…å•ç‹¬æ‰“åŒ…ï¼Œæ¥å‡å°å…¥å£åŒ…çš„å¤§å°ã€‚</p><p>åœ¨<code>vue.config.js</code> ä¸­è®¾ç½®ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºæ˜¯å¤šé¡µé¢ï¼Œæ‰€ä»¥å–æ¶ˆ chunksï¼Œæ¯ä¸ªé¡µé¢åªå¯¹åº”ä¸€ä¸ªå•ç‹¬çš„ JS / CSS</span></span><br><span class="line">    config.optimization.splitChunks(&#123;</span><br><span class="line">      chunks: <span class="string">'all'</span>,</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        elementUI: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'element-ui'</span>,</span><br><span class="line">          test: <span class="regexp">/element-ui/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        xlsx: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'xlsx'</span>,</span><br><span class="line">          test: <span class="regexp">/xlsx/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        moment: &#123;</span><br><span class="line">          priority: <span class="number">0</span>,</span><br><span class="line">          name: <span class="string">'moment'</span>,</span><br><span class="line">          test: <span class="regexp">/moment/</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    config.optimization.runtimeChunk = &#123;</span><br><span class="line">      name: <span class="string">'manifest'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ‡’åŠ è½½æ¨¡å—çš„ prefetch preloadï¼Œé™ä½å¸¦å®½å‹åŠ›</span></span><br><span class="line">    <span class="comment">// config.plugins.delete('prefetch').delete('preload')</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å°±åƒä¸Šé¢å†™çš„ï¼Œè¿˜å¯ä»¥æŠŠ<code>prefetch</code> å’Œ <code>preload</code> åˆ é™¤, æ¥å‡å°‘æœåŠ¡å™¨å’Œå¸¦å®½çš„å‹åŠ›</p><h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><p>å¯¹äºæŸäº›ä¸å¸¸å˜åŠ¨ï¼Œæœ‰æ¯”ä»·åºå¤§çš„ç¬¬ä¸‰æ–¹åº“æ¥è¯´ï¼ˆä¾‹å¦‚ï¼šechartsï¼‰ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨CDNèµ„æºï¼Œæ¥å‡å°‘æœåŠ¡å™¨å‹åŠ›ã€‚<br>å¦‚æœæœ¬èº«æœåŠ¡å™¨è®¿é—®ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæˆ–è€…æ²¡æœ‰åšè¿‡åŠ é€Ÿå¤„ç†ï¼Œè¿˜æ˜¯å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç½‘é¡µè®¿é—®é€Ÿåº¦çš„ã€‚</p><p>è€Œä¸” <code>webpack</code> ä¹Ÿæ”¯æŒé€šè¿‡é…ç½®å¼•å…¥å¤–éƒ¨æ¨¡å—å¯¼å…¥ã€‚</p><p>å…·ä½“åšæ³•æ˜¯ï¼š</p><p>é¦–å…ˆåœ¨ <code>index.html</code> ä¸­å¼•å…¥ <code>echarts</code> çš„å¤–éƒ¨CDNï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;!-- others --&gt;</span><br><span class="line">    &lt;link rel=<span class="string">"preload"</span> href=<span class="string">"https://cdn.bootcss.com/echarts/4.2.1/echarts.min.js"</span> <span class="keyword">as</span>=<span class="string">"script"</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">  &lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!-- others --&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;!-- åŠ è½½echart --&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script type="text/</span>javascript<span class="string">" src="</span>https:<span class="comment">//cdn.bootcss.com/echarts/4.2.1/echarts.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line">  &lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ <code>vue.config.js</code> ä¸­ï¼Œåšå¦‚ä¸‹æ”¹åŠ¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    externals: &#123;</span><br><span class="line">      echarts: <span class="string">'echarts'</span> <span class="comment">// echarts ä»å¤–éƒ¨CDNä¸­åŠ è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½"><a href="#ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½" class="headerlink" title="ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½"></a>ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½</h3><p>é’ˆå¯¹æŸäº›å¤§çš„ä¾èµ–åº“ï¼Œå¦‚æœèƒ½æŒ‰éœ€åŠ è½½ï¼Œä¹Ÿå¯æé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚</p><h4 id="element-uiæŒ‰éœ€åŠ è½½"><a href="#element-uiæŒ‰éœ€åŠ è½½" class="headerlink" title="element-uiæŒ‰éœ€åŠ è½½"></a>element-uiæŒ‰éœ€åŠ è½½</h4><p><code>element-ui</code> å®˜ç½‘æœ‰æŒ‰éœ€åŠ è½½çš„<a href="https://element.eleme.cn/#/zh-CN/component/quickstart" target="_blank" rel="noopener">æ–‡æ¡£</a>.<br>æŒ‰ç…§è¯´æ˜é…ç½®ä¸‹é¡¹ç›®ã€‚</p><p>é¦–å…ˆï¼Œå®‰è£…<code>babel-plugin-component</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-plugin-component -D</span><br></pre></td></tr></table></figure></p><p>ç„¶åä¿®æ”¹ <code>babel.config.js</code> æ–‡ä»¶ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [<span class="string">'@vue/app'</span>],</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'component'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        libraryName: <span class="string">'element-ui'</span>,</span><br><span class="line">        styleLibraryName: <span class="string">'theme-chalk'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åå°±æ˜¯åœ¨ <code>src/main.js</code> ä¸­æŒ‰éœ€å¼•å…¥ç»„ä»¶ã€‚</p><h3 id="æ·»åŠ éª¨æ¶å±"><a href="#æ·»åŠ éª¨æ¶å±" class="headerlink" title="æ·»åŠ éª¨æ¶å±"></a>æ·»åŠ éª¨æ¶å±</h3><p>æ·»åŠ éª¨æ¶å±èƒ½è®©é¡µé¢æ›´å¿«çš„å‡ºç°å†…å®¹ï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚</p><p>ä¾‹å¦‚è¿™æ ·çš„ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éª¨æ¶å±çš„æ ·å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">      body &#123;</span></span><br><span class="line"><span class="undefined">        margin: 0;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 100vh;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f4f5f5</span>;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 97px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#132462</span>,<span class="selector-id">#0f1839</span>);</span></span><br><span class="line"><span class="css">        <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0<span class="selector-class">.1</span>);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header__content</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 100%;</span></span><br><span class="line"><span class="undefined">        max-width: 1200px;</span></span><br><span class="line"><span class="undefined">        margin: auto;</span></span><br><span class="line"><span class="undefined">        display: flex;</span></span><br><span class="line"><span class="undefined">        align-items: center;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-header__content</span> <span class="selector-class">.mp-skeleton-bar</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#0d1a48</span>,<span class="selector-id">#152a75</span>,<span class="selector-id">#0d1a48</span>);</span></span><br><span class="line"><span class="undefined">        height: 28px;</span></span><br><span class="line"><span class="undefined">        border-radius: 3px;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-container</span> &#123;</span></span><br><span class="line"><span class="undefined">        box-sizing: border-box;</span></span><br><span class="line"><span class="undefined">        height: 120px;</span></span><br><span class="line"><span class="undefined">        max-width: 1200px;</span></span><br><span class="line"><span class="undefined">        margin: auto;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="undefined">        margin-top: 52px;</span></span><br><span class="line"><span class="undefined">        border-radius: 3px;</span></span><br><span class="line"><span class="undefined">        padding: 4px 20px;</span></span><br><span class="line"><span class="undefined">        overflow: hidden;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span> &#123;</span></span><br><span class="line"><span class="undefined">        height: 16px;</span></span><br><span class="line"><span class="undefined">        margin: 16px 0;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>,<span class="selector-id">#fff</span>,<span class="selector-id">#edeff1</span>,<span class="selector-id">#fff</span>);</span></span><br><span class="line"><span class="undefined">        background-size: 480px 480px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">animation</span>: <span class="selector-tag">skeleton-stripes-data</span> <span class="selector-class">.6s</span> <span class="selector-tag">linear</span> <span class="selector-tag">infinite</span>;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:first-of-type</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 40%;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:nth-of-type(2)</span>, <span class="selector-class">.mp-skeleton-bar</span><span class="selector-pseudo">:nth-of-type(3)</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 80%;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @-<span class="keyword">o</span>-<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="css">      @<span class="keyword">keyframes</span> skeleton-stripes-data &#123;</span></span><br><span class="line"><span class="undefined">        0% &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 0 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        to &#123;</span></span><br><span class="line"><span class="undefined">          background-position: 480px 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>We're sorry but matpool doesn't work properly without JavaScript enabled. Please enable it to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éª¨æ¶å…ƒç´  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"skeleton"</span> <span class="attr">class</span>=<span class="string">"mp-skeleton"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-header__content"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mp-skeleton-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000011577248" target="_blank" rel="noopener">å¸¦ä½ ç©è½¬prefetch, preload, dns-prefetchï¼Œdeferå’Œasync</a></li><li><a href="https://github.com/fi3ework/blog/issues/32" target="_blank" rel="noopener">[è¯‘] èµ„æºæç¤º â€”â€” ä»€ä¹ˆæ˜¯ Preloadï¼ŒPrefetch å’Œ Preconnectï¼Ÿ</a></li><li><a href="https://juejin.im/post/5b0033c9518825056508075f" target="_blank" rel="noopener">è®°ä¸€æ¬¡vue+element+echartsé¡¹ç›®çš„ä¼˜åŒ–ï¼ˆå¦‚ä½•è½»æ¾å°†é¡¹ç›®æ€§èƒ½æå‡70%ï¼‰</a></li><li><a href="https://blog.csdn.net/jiaojiao51290/article/details/81381668" target="_blank" rel="noopener">Vueé¡¹ç›®ä½¿ç”¨CDNä¼˜åŒ–åŠ è½½</a></li><li><a href="https://segmentfault.com/a/1190000016178566#articleHeader3" target="_blank" rel="noopener">vue-cli3.0 èµ„æºåŠ è½½çš„ä¼˜åŒ–æ–¹æ¡ˆ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸‹ç›®å‰äº†è§£çš„ä¸€äº›ä¼˜åŒ–ç½‘é¡µæ€§èƒ½çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆæ¬¡åŠ è½½æ—¶é—´ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;webpack&quot;&gt;&lt;a href=&quot;#webpack&quot; class=&quot;headerlink&quot; title=&quot;webpack&quot;&gt;&lt;/a&gt;webpack&lt;/h3&gt;&lt;p&gt;ç›®å‰å¼€å‘çš„é¡¹ç›®éƒ½æ˜¯ &lt;code&gt;vue&lt;/code&gt; é¡¹ç›®ï¼Œ&lt;code&gt;vue cli3&lt;/code&gt; é»˜è®¤ä½¿ç”¨ &lt;code&gt;webpack&lt;/code&gt; æ‰“åŒ…ï¼Œæ‰€ä»¥ä» &lt;code&gt;webpack&lt;/code&gt; æ–¹é¢å…¥æ‰‹ä¼˜åŒ–é¡¹ç›®æ˜¯ä¸ªæŒºå¥½çš„è§’åº¦ã€‚&lt;/p&gt;
&lt;h4 id=&quot;preload-prefetch&quot;&gt;&lt;a href=&quot;#preload-prefetch&quot; class=&quot;headerlink&quot; title=&quot;preload prefetch&quot;&gt;&lt;/a&gt;preload prefetch&lt;/h4&gt;&lt;p&gt;å¯åŠ¨ä¸€ä¸ª &lt;code&gt;vue cli3&lt;/code&gt; åˆ›å»ºçš„é¡¹ç›®ï¼Œå‘ç°åœ¨ &lt;code&gt;network&lt;/code&gt; ä¸­å¤šäº†å¾ˆå¤šçš„è¯·æ±‚ï¼Œç‰¹æ®Šçš„è¯·æ±‚ã€‚è¿™äº›è¯·æ±‚è¢«å½’ç±»åˆ° &lt;code&gt;other&lt;/code&gt; ä¸­ã€‚&lt;br&gt;è€Œä¸”è¿™äº›èµ„æºè¢«è¯·æ±‚äº†ä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥æ‰¾äº†ä¸‹èµ„æ–™å‘ç°ï¼ŒåŸæ¥æ˜¯å› ä¸ºè¿™äº› &lt;code&gt;other&lt;/code&gt; èµ„æºä½¿ç”¨äº† &lt;code&gt;preload&lt;/code&gt; æˆ– &lt;code&gt;prefetch&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="vue" scheme="https://sampwood.github.io/categories/coding/vue/"/>
    
    
      <category term="vue" scheme="https://sampwood.github.io/tags/vue/"/>
    
      <category term="æ€§èƒ½" scheme="https://sampwood.github.io/tags/%E6%80%A7%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡ç½‘é¡µå¼€å‘ç¬”è®°</title>
    <link href="https://sampwood.github.io/2019/08/19/wechat-web/"/>
    <id>https://sampwood.github.io/2019/08/19/wechat-web/</id>
    <published>2019-08-19T15:39:06.000Z</published>
    <updated>2019-08-19T15:45:11.569Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™å‡ å¤©å¼€å‘äº†ä¸€ä¸ªå¾®ä¿¡æœåŠ¡å·ï¼Œä¹Ÿç®—æ˜¯å…¥é—¨äº†ï¼Œçºªå½•ä¸‹å…¶ä¸­çš„è¿‡ç¨‹å’Œé‡åˆ°çš„å‘ã€‚</p><h3 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h3><p>è¦åœ¨å¾®ä¿¡çš„å¹³å°ä¸Šè¿›è¡Œå¼€å‘ï¼Œéœ€è¦ä¸€äº›åŸºç¡€çš„ç¯å¢ƒã€‚å…¶ä¸­åŒ…æ‹¬ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼ŒæœåŠ¡å™¨ï¼ŒåŸŸåã€‚</p><h4 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h4><p>åŸŸåéœ€è¦å¤‡æ¡ˆï¼Œä¸”éœ€è¦é…ç½®åœ¨ <code>å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„â€œå¼€å‘ - æ¥å£æƒé™ - ç½‘é¡µæœåŠ¡ - ç½‘é¡µå¸å· - ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€çš„é…ç½®é€‰é¡¹ä¸­</code></p><p>åŸŸåçš„é…ç½®éœ€è¦éªŒè¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®ä¸‹ <code>nginx</code> å°±å¯ä»¥äº†ã€‚</p><p>å½“ç„¶æœ¬åœ°å¼€å‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½æ—¶æ—¶å‘å¸ƒçš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹æœ¬åœ° <code>host</code> çš„æ–¹å¼æ¥å¿«é€Ÿå¼€å‘ã€‚</p><a id="more"></a><h4 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h4><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¾®ä¿¡æä¾›äº†ä¸€ä¸ª <code>å¾®ä¿¡webå¼€å‘è€…å·¥å…·</code> ï¼ˆæ¡Œé¢åº”ç”¨ï¼‰ï¼Œç”¨äºå¼€å‘å’Œè°ƒè¯•åŸºäºå¾®ä¿¡çš„ç½‘é¡µã€‚</p><p>æ­£å¸¸å¼€å‘ç§»åŠ¨ç«¯åªè¦åœ¨æµè§ˆå™¨ä¸­é€‰ç”¨ <code>å“åº”å¼å¼€å‘å·¥å…·</code> å°±å¯ä»¥åˆ‡æ¢åˆ° ç§»åŠ¨ç«¯çš„æœºå‹ã€‚<br>æ‰€ä»¥ï¼Œè¿™ä¸ªå¾®ä¿¡å¼€å‘å·¥å…·ä¸»è¦çš„ä»·å€¼æ˜¯ä½“ç°åœ¨<strong>å®ƒèƒ½å¦‚åŒå¾®ä¿¡ä¸€æ ·è·å–ç”¨æˆ·æˆæƒï¼Œä»è€Œæ‹¿åˆ°éƒ¨åˆ†ç”¨æˆ·ä¿¡æ¯</strong>ã€‚</p><p>è¦ä½¿ç”¨å¼€å‘å·¥å…·ï¼Œè¿˜å¾—æŠŠè‡ªå·±åŠ åˆ° <code>å¾®ä¿¡å…¬ä¼—å¹³å°-å¼€å‘-å¼€å‘è€…å·¥å…·-webå¼€å‘è€…å·¥å…·-å¼€å‘è€…å¾®ä¿¡å·</code> ä¸­ã€‚</p><h4 id="js-sdk"><a href="#js-sdk" class="headerlink" title="js-sdk"></a>js-sdk</h4><p>å’Œä¸Šé¢å·®ä¸å¤šï¼Œæ­£å¸¸çš„ç§»åŠ¨ç«¯å¼€å‘æ˜¯ç”¨ä¸ä¸Š <code>å¾®ä¿¡js-sdk</code> çš„ã€‚</p><p>å®ƒçš„ä½œç”¨æ˜¯èƒ½é€šè¿‡ <code>js</code> è°ƒç”¨ä¸€äº›ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šè‡ªå®šä¹‰åˆ†äº«å†…å®¹ï¼Œå›¾åƒæ¥å£ï¼Œåœ°ç†ä½ç½®ç­‰ã€‚</p><p>è¿™æ¬¡å¼€å‘çš„åŠŸèƒ½åªç”¨åˆ°äº† <code>è‡ªå®šä¹‰åˆ†äº«å†…å®¹</code> çš„åŠŸèƒ½ã€‚ï¼ˆPSï¼šå°±æ˜¯è¿™ä¸ªåˆ†äº«ç•¥å‘ï¼Œå‘äº†æˆ‘ä¸€å¤©æ—¶é—´ã€‚åé¢å†ç»†è¯´ï¼‰</p><h4 id="æ ·å¼åº“"><a href="#æ ·å¼åº“" class="headerlink" title="æ ·å¼åº“"></a>æ ·å¼åº“</h4><p>å¾®ä¿¡æœ‰æä¾›ä¸€å¥—webæ ·å¼åº“- <code>weui</code>ï¼Œå¦‚æœæ²¡æœ‰è®¾è®¡æˆ–è€…è®¾è®¡é£æ ¼è´´è¿‘å¾®ä¿¡çš„å¯ä»¥ç”¨ä¸€ä¸‹ï¼Œæˆ–è€…å‚è€ƒä¸‹å®ƒçš„ç»„ä»¶è®¾è®¡ã€‚</p><p>å› ä¸ºè¿™æ¬¡è®¾è®¡é£æ ¼å’Œè¿™ä¸ªæ ·å¼åº“å·®å¾ˆå¤šï¼Œè€Œä¸”é¡µé¢ä¹Ÿæ¯”è¾ƒå°‘ã€‚æ‰€ä»¥å°±éƒ½è‡ªå·±ç”»äº†ã€‚</p><h3 id="å¾®ä¿¡ç½‘é¡µæˆæƒ"><a href="#å¾®ä¿¡ç½‘é¡µæˆæƒ" class="headerlink" title="å¾®ä¿¡ç½‘é¡µæˆæƒ"></a>å¾®ä¿¡ç½‘é¡µæˆæƒ</h3><blockquote><p>å¦‚æœç”¨æˆ·åœ¨å¾®ä¿¡å®¢æˆ·ç«¯ä¸­è®¿é—®ç¬¬ä¸‰æ–¹ç½‘é¡µï¼Œå…¬ä¼—å·å¯ä»¥é€šè¿‡å¾®ä¿¡ç½‘é¡µæˆæƒæœºåˆ¶ï¼Œæ¥è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼Œè¿›è€Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚</p></blockquote><p>è¿™è¾¹åªè¯´ä¸‹å‰ç«¯çš„é€»è¾‘ã€‚</p><p>ç½‘é¡µæˆæƒçš„é€»è¾‘ï¼š</p><ol><li>ç”¨æˆ·åŒæ„æˆæƒï¼Œè·å–codeï¼› ä¹Ÿå°±æ˜¯æ‰“å¼€ç‰¹å®šçš„å¾®ä¿¡é¡µé¢ï¼Œç„¶åå¾®ä¿¡ä¼šè·³è½¬åˆ°æˆ‘ä»¬è®¾å®šçš„ <code>redirect_uri</code> ä¸Šï¼Œ<br>å¹¶ä¸”é€šè¿‡ <code>$route.query.code</code> æ¥è¿”å› <code>code</code></li><li>é€šè¿‡ <code>code</code> æ¢å–ç½‘é¡µæˆæƒ <code>access_token</code>ã€‚é€šè¿‡ <code>access_token</code> æ‹‰å–ç”¨æˆ·ä¿¡æ¯ã€‚<br>è¿™æ­¥æ˜¯åç«¯æ¥å®ç°çš„ï¼Œæ‰€ä»¥å‰ç«¯åªè¦é€šè¿‡è°ƒç”¨åç«¯æ¥å£å°±è¡Œäº†ã€‚ğŸ˜Š</li></ol><p>ç”¨æˆ·ä¿¡æ¯åŒ…å«ï¼šåŸå¸‚ï¼Œçœï¼Œå›½å®¶ï¼Œå¤´åƒï¼Œæ˜µç§°ï¼Œæ€§åˆ«ï¼Œopenid</p><h3 id="js-sdk-ä¹‹è‡ªå®šä¹‰åˆ†äº«"><a href="#js-sdk-ä¹‹è‡ªå®šä¹‰åˆ†äº«" class="headerlink" title="js-sdk ä¹‹è‡ªå®šä¹‰åˆ†äº«"></a><code>js-sdk</code> ä¹‹è‡ªå®šä¹‰åˆ†äº«</h3><blockquote><p>å¾®ä¿¡JS-SDKæ˜¯å¾®ä¿¡å…¬ä¼—å¹³å° é¢å‘ç½‘é¡µå¼€å‘è€…æä¾›çš„åŸºäºå¾®ä¿¡å†…çš„ç½‘é¡µå¼€å‘å·¥å…·åŒ…ã€‚</p></blockquote><h4 id="js-sdkä½¿ç”¨æ­¥éª¤"><a href="#js-sdkä½¿ç”¨æ­¥éª¤" class="headerlink" title="js-sdkä½¿ç”¨æ­¥éª¤"></a>js-sdkä½¿ç”¨æ­¥éª¤</h4><ol><li>å¼•å…¥jsæ–‡ä»¶ï¼šï¼ˆæ”¯æŒhttpsï¼‰ï¼š<a href="http://res.wx.qq.com/open/js/jweixin-1.4.0.js" target="_blank" rel="noopener">http://res.wx.qq.com/open/js/jweixin-1.4.0.js</a></li><li>æ³¨å…¥æƒé™éªŒè¯é…ç½®</li></ol><blockquote><p>æ‰€æœ‰éœ€è¦ä½¿ç”¨JS-SDKçš„é¡µé¢å¿…é¡»å…ˆæ³¨å…¥é…ç½®ä¿¡æ¯ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨ï¼ˆåŒä¸€ä¸ªurlä»…éœ€è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹äºå˜åŒ–urlçš„SPAçš„web appå¯åœ¨æ¯æ¬¡urlå˜åŒ–æ—¶è¿›è¡Œè°ƒç”¨)</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wx.config(&#123;</span><br><span class="line">    debug: <span class="literal">true</span>, <span class="comment">// å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚</span></span><br><span class="line">    appId: <span class="string">''</span>, <span class="comment">// å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    timestamp: , <span class="comment">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³</span></span><br><span class="line">    nonceStr: <span class="string">''</span>, <span class="comment">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸²</span></span><br><span class="line">    signature: <span class="string">''</span>,<span class="comment">// å¿…å¡«ï¼Œç­¾å</span></span><br><span class="line">    jsApiList: [] <span class="comment">// å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™äº›æ•°æ®éƒ½å¯ä»¥è®©åç«¯ç”Ÿæˆï¼ŒğŸ˜Šã€‚</p><p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‘ã€‚å¯¹äºandroidè®¾å¤‡ï¼Œvueé¡¹ç›®ä¸€åˆ‡æ­£å¸¸ï¼ˆå¯èƒ½æ˜¯å’Œå®˜ç½‘è¯´çš„ä¿®å¤æœ‰å…³ï¼‰ã€‚</p><p><strong>å¯¹äºiosè®¾å¤‡ï¼Œvueé¡¹ç›®çš„URLæ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œåªå¯¹ç¬¬ä¸€æ¬¡è¿›å…¥çš„URLèƒ½éªŒè¯æˆåŠŸã€‚</strong><br>å½“ç„¶é¡µé¢freshï¼Œæ˜¯ä¼šåˆ·æ–°çš„urlçš„ã€‚è¿™ä¸ªè¯´çš„ä¸ä¼šå˜åŒ–æ˜¯æŒ‡ <code>$router.push</code> æ–¹æ³•ã€‚</p><ol start="3"><li>é€šè¿‡readyæ¥å£å¤„ç†æˆåŠŸéªŒè¯</li><li>è‡ªå®šä¹‰åˆ†äº«å†…å®¹<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wx.ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;   <span class="comment">//éœ€åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»åˆ†äº«æŒ‰é’®å‰å°±å…ˆè°ƒç”¨</span></span><br><span class="line">  wx.updateAppMessageShareData(&#123; <span class="comment">// åˆ†äº«åˆ°æœ‹å‹</span></span><br><span class="line">    title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">    desc: <span class="string">''</span>, <span class="comment">// åˆ†äº«æè¿°</span></span><br><span class="line">    link: <span class="string">''</span>, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">    imgUrl: <span class="string">''</span>, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// è®¾ç½®æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.updateTimelineShareData(&#123; <span class="comment">// åˆ†äº«åˆ°æœ‹å‹åœˆ</span></span><br><span class="line">    title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">    link: <span class="string">''</span>, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">    imgUrl: <span class="string">''</span>, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// è®¾ç½®æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h5 id="vueé¡¹ç›®"><a href="#vueé¡¹ç›®" class="headerlink" title="vueé¡¹ç›®"></a>vueé¡¹ç›®</h5><p>å› ä¸ºä¸Šé¢è¯´çš„é‚£ä¸ªå‘ï¼Œæ‰€ä»¥åœ¨vueé¡¹ç›®ä¸­ï¼Œéœ€è¦åšä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚</p><p>å¤„ç†åŸç†æ˜¯ï¼Œåœ¨æœ€å¼€å§‹è¿›å…¥é¡µé¢çš„æ—¶å€™çºªå½•ä¸‹urlï¼Œç„¶ååœ¨æ¯æ¬¡è·¯ç”±åˆ·æ–°çš„æ—¶å€™åˆ¤æ–­æ˜¯<code>andriod</code>æœºè¿˜æ˜¯<code>ios</code>æœºå­ï¼Œåšä¸åŒçš„å¤„ç†.</p><p>ä¸‹é¢ç»™å‡ºå…·ä½“ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; wechatAuth &#125; <span class="keyword">from</span> <span class="string">'@/utils/wechatConfig.js'</span></span><br><span class="line"></span><br><span class="line">router.afterEach(<span class="function"><span class="params">to</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> authUrl = <span class="string">`<span class="subst">$&#123;<span class="built_in">window</span>.location.origin&#125;</span><span class="subst">$&#123;to.fullPath&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.__wxjs_is_wkwebview) &#123;</span><br><span class="line">    <span class="comment">// IOS</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">window</span>.entryUrl) &#123;</span><br><span class="line">      <span class="built_in">window</span>.entryUrl = authUrl <span class="comment">// å°†åé¢çš„å‚æ•°å»é™¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    wechatAuth(authUrl, <span class="string">'ios'</span>, to.meta.title)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å®‰å“</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      wechatAuth(authUrl, <span class="string">'android'</span>, to.meta.title)</span><br><span class="line">    &#125;, <span class="number">500</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wechatAuth</span></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@/lib/jweixin-1.4.0.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> indexOfConfig = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateShareData = <span class="function">(<span class="params">shareConfig, shareSuccessCallback</span>) =&gt;</span> &#123;</span><br><span class="line">  wx.updateAppMessageShareData(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    desc: shareConfig.desc,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.updateTimelineShareData(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;,</span><br><span class="line">    fail: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.onMenuShareTimeline(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  wx.onMenuShareAppMessage(&#123;</span><br><span class="line">    title: shareConfig.title,</span><br><span class="line">    desc: shareConfig.desc,</span><br><span class="line">    link: shareConfig.link,</span><br><span class="line">    imgUrl: shareConfig.imgUrl,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      shareSuccessCallback()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> wechatAuth = <span class="keyword">async</span> (authUrl, device, title, allowShare = <span class="literal">true</span>, shareSuccessCallback = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> shareConfig = &#123;</span><br><span class="line">    title: <span class="string">'title'</span>,</span><br><span class="line">    desc: <span class="string">'desc'</span>,</span><br><span class="line">    link: allowShare ? authUrl : <span class="built_in">window</span>.location.origin,</span><br><span class="line">    imgUrl: <span class="built_in">window</span>.location.origin + <span class="string">'/favicon-matpool.ico'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œåœ¨åˆ«äººçš„ä»£ç ä¸­è°ƒç”¨äº†encodeURIComponentï¼Œä½†æˆ‘æµ‹è¯•çš„ç»“æœæ˜¯ï¼šæ²¡æœ‰encodeURIComponentæ‰èƒ½æ­£ç¡®åˆ†äº«ã€‚</span></span><br><span class="line">    url: device === <span class="string">'ios'</span> ? <span class="built_in">window</span>.entryUrl : authUrl </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> authRes = <span class="keyword">await</span> api.getWxConfig(params)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (authRes &amp;&amp; wx) &#123;</span><br><span class="line">    <span class="keyword">if</span> (device !== <span class="string">'ios'</span> || indexOfConfig === <span class="number">0</span>) &#123;</span><br><span class="line">      indexOfConfig++</span><br><span class="line"></span><br><span class="line">      wx.config(&#123;</span><br><span class="line">        debug: <span class="literal">false</span>,</span><br><span class="line">        appId: authRes.app_id,</span><br><span class="line">        timestamp: authRes.timestamp,</span><br><span class="line">        nonceStr: authRes.nonce,</span><br><span class="line">        signature: authRes.signature,</span><br><span class="line">        jsApiList: [</span><br><span class="line">          <span class="string">'updateAppMessageShareData'</span>,</span><br><span class="line">          <span class="string">'updateTimelineShareData'</span>,</span><br><span class="line">          <span class="string">'onMenuShareAppMessage'</span>,</span><br><span class="line">          <span class="string">'onMenuShareTimeline'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      wx.ready(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        updateShareData(shareConfig, shareSuccessCallback)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      updateShareData(shareConfig, shareSuccessCallback)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>NOTE</strong>ï¼šå°±æ˜¯è¿™ä¸ªencodeURIComponentå‘äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ã€‚ğŸ˜…</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://mp.weixin.qq.com/wiki" target="_blank" rel="noopener">å¾®ä¿¡å…¬ä¼—å¹³å°æŠ€æœ¯æ–‡æ¡£</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784140" target="_blank" rel="noopener">å¾®ä¿¡webå¼€å‘è€…å·¥å…·</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115" target="_blank" rel="noopener">å¾®ä¿¡js-sdk</a></li><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784134" target="_blank" rel="noopener">å¾®ä¿¡ç½‘é¡µå¼€å‘æ ·å¼åº“</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‡ å¤©å¼€å‘äº†ä¸€ä¸ªå¾®ä¿¡æœåŠ¡å·ï¼Œä¹Ÿç®—æ˜¯å…¥é—¨äº†ï¼Œçºªå½•ä¸‹å…¶ä¸­çš„è¿‡ç¨‹å’Œé‡åˆ°çš„å‘ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#å¼€å‘ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;/a&gt;å¼€å‘ç¯å¢ƒ&lt;/h3&gt;&lt;p&gt;è¦åœ¨å¾®ä¿¡çš„å¹³å°ä¸Šè¿›è¡Œå¼€å‘ï¼Œéœ€è¦ä¸€äº›åŸºç¡€çš„ç¯å¢ƒã€‚å…¶ä¸­åŒ…æ‹¬ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼ŒæœåŠ¡å™¨ï¼ŒåŸŸåã€‚&lt;/p&gt;
&lt;h4 id=&quot;åŸŸå&quot;&gt;&lt;a href=&quot;#åŸŸå&quot; class=&quot;headerlink&quot; title=&quot;åŸŸå&quot;&gt;&lt;/a&gt;åŸŸå&lt;/h4&gt;&lt;p&gt;åŸŸåéœ€è¦å¤‡æ¡ˆï¼Œä¸”éœ€è¦é…ç½®åœ¨ &lt;code&gt;å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„â€œå¼€å‘ - æ¥å£æƒé™ - ç½‘é¡µæœåŠ¡ - ç½‘é¡µå¸å· - ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€çš„é…ç½®é€‰é¡¹ä¸­&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŸŸåçš„é…ç½®éœ€è¦éªŒè¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®ä¸‹ &lt;code&gt;nginx&lt;/code&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶æœ¬åœ°å¼€å‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½æ—¶æ—¶å‘å¸ƒçš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹æœ¬åœ° &lt;code&gt;host&lt;/code&gt; çš„æ–¹å¼æ¥å¿«é€Ÿå¼€å‘ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="wechat" scheme="https://sampwood.github.io/categories/coding/wechat/"/>
    
    
      <category term="mobile" scheme="https://sampwood.github.io/tags/mobile/"/>
    
      <category term="vue" scheme="https://sampwood.github.io/tags/vue/"/>
    
      <category term="html5" scheme="https://sampwood.github.io/tags/html5/"/>
    
  </entry>
  
  <entry>
    <title>project åŸºç¡€è®¾ç½®</title>
    <link href="https://sampwood.github.io/2019/05/15/project-basic-configuration/"/>
    <id>https://sampwood.github.io/2019/05/15/project-basic-configuration/</id>
    <published>2019-05-15T12:59:36.000Z</published>
    <updated>2019-10-08T10:53:38.740Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è®¾ç½®ä¸€äº›åŸºç¡€é…ç½®ï¼Œè®©ä¸åŒå¼€å‘äººå‘˜åœ¨ä¸åŒç¯å¢ƒä¸‹èƒ½å†™å‡ºç»Ÿä¸€è§„èŒƒçš„ä»£ç ã€‚<br>ä¸‹é¢å°±è®°å½•ä¸‹æœ¬äººåœ¨ä½¿ç”¨çš„ä¸€äº›é€šç”¨è®¾ç½®ã€‚</p><h3 id="eslint-prettier"><a href="#eslint-prettier" class="headerlink" title="eslint + prettier"></a>eslint + prettier</h3><p><code>eslint</code> ç”¨æ¥è¿›è¡Œä»£ç çš„æ ¡éªŒï¼Œ<code>prettier</code> ç”¨äºç»Ÿä¸€ä»£ç é£æ ¼</p><p><code>eslint</code> çš„å®‰è£…å’Œä½¿ç”¨åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»è¯´æ˜ã€‚ä¸‹é¢ä»‹ç»ä¸‹ <code>prettier</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D prettier eslint-plugin-prettier eslint-config-prettier</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>eslint-plugin-prettier</code> æ’ä»¶ä¼šè°ƒç”¨ <code>prettier</code> å¯¹ä½ çš„ä»£ç é£æ ¼è¿›è¡Œæ£€æŸ¥.<br>å…¶åŸç†æ˜¯å…ˆä½¿ç”¨ <code>prettier</code> å¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¸æ ¼å¼åŒ–ä¹‹å‰çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¿‡å‡ºç°äº†ä¸ä¸€è‡´ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šè¢« <code>prettier</code> è¿›è¡Œæ ‡è®°ã€‚</p><p>é€šè¿‡ä½¿ç”¨ <code>eslint-config-prettier</code> é…ç½®ï¼Œèƒ½å¤Ÿå…³é—­ä¸€äº›ä¸å¿…è¦çš„æˆ–è€…æ˜¯ä¸ <code>prettier</code> å†²çªçš„linté€‰é¡¹ã€‚<br>è¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šçœ‹åˆ°ä¸€äº› <code>error</code> åŒæ—¶å‡ºç°ä¸¤æ¬¡ã€‚ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç¡®ä¿ï¼Œè¿™ä¸ªé…ç½®åœ¨ <code>extends</code> çš„æœ€åä¸€é¡¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">  extends: [</span><br><span class="line">    <span class="string">'standard'</span>, <span class="comment">//ä½¿ç”¨standardåšä»£ç è§„èŒƒ</span></span><br><span class="line">    <span class="comment">// https://github.com/vuejs/eslint-plugin-vue#priority-a-essential-error-prevention</span></span><br><span class="line">    <span class="comment">// consider switching to `plugin:vue/strongly-recommended` or `plugin:vue/recommended` for stricter rules.</span></span><br><span class="line">    <span class="string">'plugin:vue/essential'</span>,</span><br><span class="line">    <span class="string">'plugin:prettier/recommended'</span>,</span><br><span class="line">  ],</span><br><span class="line">  plugins: [<span class="string">'prettier'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'no-console'</span>: process.env.NODE_ENV === <span class="string">'production'</span> ? <span class="string">'error'</span> : <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'no-debugger'</span>: process.env.NODE_ENV === <span class="string">'production'</span> ? <span class="string">'error'</span> : <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'prettier/prettier'</span>: [</span><br><span class="line">      <span class="string">'error'</span>,</span><br><span class="line">      &#123; <span class="comment">// prettier é…ç½®</span></span><br><span class="line">        semi: <span class="literal">false</span>,</span><br><span class="line">        singleQuote: <span class="literal">true</span>,</span><br><span class="line">        printWidth: <span class="number">120</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>NOTE: é…ç½®æ–¹æ³•æœ‰å¥½å‡ ç§ï¼Œæœ¬äººåœ¨ <code>.eslintrc.js</code> ä¸­å¯¹ <code>prettier</code> è¿›è¡Œé…ç½®</strong></p><h3 id="husky-lint-staged"><a href="#husky-lint-staged" class="headerlink" title="husky + lint-staged"></a>husky + lint-staged</h3><p>è¿™ä¸ªåœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æœ‰ä»‹ç»ã€‚</p><p>å½“ç„¶ï¼Œç°åœ¨ <code>husky</code> åœ¨ <code>package.json</code> æä¾›äº†é¢å¤–çš„é…ç½®å‚æ•° <code>husky</code>ï¼Œè€Œä¸æ˜¯åœ¨ <code>script</code> ä¸­å†™ <code>precommit</code></p><h3 id="Commitizen-Commitlint"><a href="#Commitizen-Commitlint" class="headerlink" title="Commitizen + Commitlint"></a>Commitizen + Commitlint</h3><p>ç”¨è¿™ä¸¤ä¸ªæ’ä»¶æ¥è®©ä½ çš„ git commit message æ›´åŠ çš„è§„èŒƒå’Œç»Ÿä¸€ã€‚<br><code>Commitizen</code> æ˜¯ä¸€å¥—æ¨¡ç‰ˆåŒ–çš„commit message, <code>Commitlint</code> ç”¨æ¥æ£€æŸ¥commit message æ˜¯å¦ç¬¦åˆåˆ¶å®šæ¨¡æ¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -D commitizen cz-customizable</span><br><span class="line">npm install -D commitlint-config-cz @commitlint/cli @commitlint/config-conventional</span><br></pre></td></tr></table></figure><p>ç»“åˆ <code>husky</code> æ’ä»¶å°±èƒ½æ‹¥æœ‰åŒæ ·çš„ <code>git commit</code> å‘½ä»¤ï¼Œä¸ä¸€æ ·çš„ä½“éªŒï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>git cz</code>å‘½ä»¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"husky"</span>: &#123;</span><br><span class="line">    <span class="attr">"hooks"</span>: &#123;</span><br><span class="line">      <span class="attr">"pre-commit"</span>: <span class="string">"lint-staged"</span>,</span><br><span class="line">      <span class="attr">"prepare-commit-msg"</span>: <span class="string">"exec &lt; /dev/tty &amp;&amp; git cz --hook"</span>,</span><br><span class="line">      <span class="attr">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"lint-staged"</span>: &#123;</span><br><span class="line">    <span class="attr">"src/**/*.&#123;js,vue&#125;"</span>: [</span><br><span class="line">      <span class="string">"eslint --fix"</span>,</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"config"</span>: &#123;</span><br><span class="line">    <span class="attr">"commitizen"</span>: &#123;</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"cz-customizable"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢å¤–éœ€è¦å¢åŠ ä¸‹é¢è¿™äº›æ–‡ä»¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .cz-config.js</span></span><br><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"></span><br><span class="line">  types: [</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'WIP'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ’ª  WIP:      Work in progress'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'feat'</span>,</span><br><span class="line">      name : <span class="string">'âœ¨  feat:     A new feature'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'fix'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ  fix:      A bug fix'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'refactor'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ›   refactor: A code change that neither fixes a bug nor adds a feature'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'docs'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ“š  docs:     Documentation only changes'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'test'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ  test:     Add missing tests or correcting existing tests'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'chore'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ—¯  chore:    Changes that don\'t modify src or test files. Such as updating build tasks, package manager'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'style'</span>,</span><br><span class="line">      name : <span class="string">'ğŸ’…  style:    Code Style, Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      value: <span class="string">'revert'</span>,</span><br><span class="line">      name : <span class="string">'âª  revert:   Revert to a commit'</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  scopes: [],</span><br><span class="line"></span><br><span class="line">  allowCustomScopes: <span class="literal">true</span>,</span><br><span class="line">  allowBreakingChanges: [<span class="string">"feat"</span>, <span class="string">"fix"</span>]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .commitlintrc.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [<span class="string">'@commitlint/config-conventional'</span>, <span class="string">'cz'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'type-enum'</span>: [<span class="number">2</span>, <span class="string">'always'</span>, [<span class="string">'WIP'</span>, <span class="string">'feat'</span>, <span class="string">'fix'</span>, <span class="string">'refactor'</span>, <span class="string">'docs'</span>, <span class="string">'test'</span>, <span class="string">'chore'</span>, <span class="string">'style'</span>, <span class="string">'revert'</span>]],</span><br><span class="line">    <span class="string">'type-case'</span>: [<span class="number">0</span>, <span class="string">'never'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="standard-version"><a href="#standard-version" class="headerlink" title="standard-version"></a>standard-version</h3><p>å¦‚æœä½¿ç”¨ä¸Šé¢çš„æ’ä»¶æ¥è§„èŒƒæˆ‘ä»¬çš„git commit messageï¼Œ<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ© standard-version è¿™æ ·çš„å·¥å…·, è‡ªåŠ¨ç”Ÿæˆ CHANGELOG, ç”šè‡³æ˜¯ è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å·(Semantic Version).</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D standard-version</span><br></pre></td></tr></table></figure><p>åœ¨ <code>package.json</code> ä¸­é…ç½®ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scirpt"</span>: &#123;</span><br><span class="line">    ...,</span><br><span class="line">    "release": "HUSKY_SKIP_HOOKS=1 standard-version"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: <code>HUSKY_SKIP_HOOKS=1</code> ç”¨äºå–æ¶ˆhuskyä¸­ç¬¬äºŒä¸ªhookï¼ˆ<code>prepare-commit-msg</code>ï¼‰,è¿™ä¸ªéœ€è¦<code>husky</code>å‡çº§åˆ°<code>3.0.0</code>ç‰ˆæœ¬ä»¥ä¸Š</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://juejin.im/post/5b27a326e51d45588a7dac57" target="_blank" rel="noopener">ä½¿ç”¨ESLint+Prettieræ¥ç»Ÿä¸€å‰ç«¯ä»£ç é£æ ¼</a></li><li><a href="https://juejin.im/post/5afc5242f265da0b7f44bee4#heading-7" target="_blank" rel="noopener">ä¼˜é›…çš„æäº¤ä½ çš„ Git Commit Message</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è®¾ç½®ä¸€äº›åŸºç¡€é…ç½®ï¼Œè®©ä¸åŒå¼€å‘äººå‘˜åœ¨ä¸åŒç¯å¢ƒä¸‹èƒ½å†™å‡ºç»Ÿä¸€è§„èŒƒçš„ä»£ç ã€‚&lt;br&gt;ä¸‹é¢å°±è®°å½•ä¸‹æœ¬äººåœ¨ä½¿ç”¨çš„ä¸€äº›é€šç”¨è®¾ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&quot;eslint-prettier&quot;&gt;&lt;a href=&quot;#eslint-prettier&quot; class=&quot;headerlink&quot; title=&quot;eslint + prettier&quot;&gt;&lt;/a&gt;eslint + prettier&lt;/h3&gt;&lt;p&gt;&lt;code&gt;eslint&lt;/code&gt; ç”¨æ¥è¿›è¡Œä»£ç çš„æ ¡éªŒï¼Œ&lt;code&gt;prettier&lt;/code&gt; ç”¨äºç»Ÿä¸€ä»£ç é£æ ¼&lt;/p&gt;
&lt;p&gt;&lt;code&gt;eslint&lt;/code&gt; çš„å®‰è£…å’Œä½¿ç”¨åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»è¯´æ˜ã€‚ä¸‹é¢ä»‹ç»ä¸‹ &lt;code&gt;prettier&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm i -D prettier eslint-plugin-prettier eslint-config-prettier&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>npm scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•</title>
    <link href="https://sampwood.github.io/2019/04/01/npm-scripts%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%96%B9%E6%B3%95/"/>
    <id>https://sampwood.github.io/2019/04/01/npm-scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•/</id>
    <published>2019-04-01T00:59:06.000Z</published>
    <updated>2019-04-01T01:07:24.544Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ <code>package.json</code> ä¸­ï¼Œå¦‚æœå¸Œæœ›åœ¨ <code>script</code> å±æ€§çš„è¿è¡Œè„šæœ¬ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ¥åŒºåˆ†å¼€å‘ç¯å¢ƒ æˆ– ç”Ÿäº§ç¯å¢ƒã€‚<br>unixä¸windowsç¯å¢ƒçš„è®¾ç½®æ–¹å¼æ˜¯ä¸åŒçš„ã€‚<br>è¿™ä¸ªä¸åŒå¯ä»¥é€šè¿‡<code>cross-env</code>æ¥å®ç°è·¨å¹³å°è®¾ç½®ã€‚</p><a id="more"></a><p>windows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set NODE_ENV=production</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;set NODE_ENV=production &amp;&amp; npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;set NODE_ENV=development &amp;&amp; npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>linux &amp; mac:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export NODE_ENV=production</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;NODE_ENV=production npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;NODE_ENV=development npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>cross-envè·¨å¹³å°è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm i cross-env -D</span><br><span class="line"></span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;cross-env NODE_ENV=production npm run build&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;cross-env NODE_ENV=development npm run dev&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.cnblogs.com/mengff/p/7350030.html" target="_blank" rel="noopener">npm scriptsè®¾ç½®ç¯å¢ƒå˜é‡æ–¹æ³•</a></li><li><a href="https://www.jianshu.com/p/60c4ce9111c0" target="_blank" rel="noopener">package.jsoné‡Œscriptè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œunixä¸windowsçš„åŒºåˆ«</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ &lt;code&gt;package.json&lt;/code&gt; ä¸­ï¼Œå¦‚æœå¸Œæœ›åœ¨ &lt;code&gt;script&lt;/code&gt; å±æ€§çš„è¿è¡Œè„šæœ¬ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ¥åŒºåˆ†å¼€å‘ç¯å¢ƒ æˆ– ç”Ÿäº§ç¯å¢ƒã€‚&lt;br&gt;unixä¸windowsç¯å¢ƒçš„è®¾ç½®æ–¹å¼æ˜¯ä¸åŒçš„ã€‚&lt;br&gt;è¿™ä¸ªä¸åŒå¯ä»¥é€šè¿‡&lt;code&gt;cross-env&lt;/code&gt;æ¥å®ç°è·¨å¹³å°è®¾ç½®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="linux" scheme="https://sampwood.github.io/tags/linux/"/>
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="npm" scheme="https://sampwood.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>indexDBçš„ä½¿ç”¨</title>
    <link href="https://sampwood.github.io/2019/02/28/%E6%B5%8F%E8%A7%88%E5%99%A8indexDB%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>https://sampwood.github.io/2019/02/28/æµè§ˆå™¨indexDBçš„ä½¿ç”¨/</id>
    <published>2019-02-28T06:27:33.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ç°ä»£æµè§ˆå™¨æä¾›äº†ä¸€äº›æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œä¾‹å¦‚<code>cookie</code>ã€<code>sessionStorage</code>ã€<code>localStorage</code>å’Œ<code>indexedDB</code>ã€‚</p><p>è¿™äº›éƒ½èƒ½åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·çš„<code>application</code>æ ‡ç­¾é¡µä¸­èƒ½çœ‹åˆ°ã€‚</p><p>åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œ<code>indexedDB</code>çš„åŸºæœ¬ç”¨æ³•ã€‚</p><blockquote><p>é€šä¿—åœ°è¯´ï¼Œ<code>IndexedDB</code> å°±æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚<br><code>IndexedDB</code> å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚<br>è¿™äº›éƒ½æ˜¯ <code>LocalStorage</code> æ‰€ä¸å…·å¤‡çš„ã€‚<br>å°±æ•°æ®åº“ç±»å‹è€Œè¨€ï¼Œ<code>IndexedDB</code> ä¸å±äºå…³ç³»å‹æ•°æ®åº“ï¼ˆä¸æ”¯æŒ <code>SQL</code> æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œæ›´æ¥è¿‘ <code>NoSQL</code> æ•°æ®åº“ã€‚</p></blockquote><a id="more"></a><blockquote><p>IndexedDB å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ã€‚<br>ï¼ˆ1ï¼‰<strong>é”®å€¼å¯¹å‚¨å­˜</strong> IndexedDB å†…éƒ¨é‡‡ç”¨å¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰å­˜æ”¾æ•°æ®ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚å¯¹è±¡ä»“åº“ä¸­ï¼Œæ•°æ®ä»¥â€é”®å€¼å¯¹â€çš„å½¢å¼ä¿å­˜ï¼Œæ¯ä¸€ä¸ªæ•°æ®è®°å½•éƒ½æœ‰å¯¹åº”çš„ä¸»é”®ï¼Œä¸»é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸èƒ½æœ‰é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚<br>ï¼ˆ2ï¼‰<strong>å¼‚æ­¥</strong> IndexedDB æ“ä½œæ—¶ä¸ä¼šé”æ­»æµè§ˆå™¨ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè¿™ä¸ LocalStorage å½¢æˆå¯¹æ¯”ï¼Œåè€…çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚å¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å¤§é‡æ•°æ®çš„è¯»å†™ï¼Œæ‹–æ…¢ç½‘é¡µçš„è¡¨ç°ã€‚<br>ï¼ˆ3ï¼‰<strong>æ”¯æŒäº‹åŠ¡</strong> IndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œè¿™æ„å‘³ç€ä¸€ç³»åˆ—æ“ä½œæ­¥éª¤ä¹‹ä¸­ï¼Œåªè¦æœ‰ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±éƒ½å–æ¶ˆï¼Œæ•°æ®åº“å›æ»šåˆ°äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œä¸å­˜åœ¨åªæ”¹å†™ä¸€éƒ¨åˆ†æ•°æ®çš„æƒ…å†µã€‚<br>ï¼ˆ4ï¼‰<strong>åŒæºé™åˆ¶</strong> IndexedDB å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚ç½‘é¡µåªèƒ½è®¿é—®è‡ªèº«åŸŸåä¸‹çš„æ•°æ®åº“ï¼Œè€Œä¸èƒ½è®¿é—®è·¨åŸŸçš„æ•°æ®åº“ã€‚<br>ï¼ˆ5ï¼‰<strong>å‚¨å­˜ç©ºé—´å¤§</strong> IndexedDB çš„å‚¨å­˜ç©ºé—´æ¯” LocalStorage å¤§å¾—å¤šï¼Œä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ã€‚<br>ï¼ˆ6ï¼‰<strong>æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜</strong> IndexedDB ä¸ä»…å¯ä»¥å‚¨å­˜å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥å‚¨å­˜äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚</p></blockquote><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ul><li>æ•°æ®åº“ï¼šIDBDatabase å¯¹è±¡</li><li>å¯¹è±¡ä»“åº“ï¼šIDBObjectStore å¯¹è±¡</li><li>ç´¢å¼•ï¼š IDBIndex å¯¹è±¡</li><li>äº‹åŠ¡ï¼š IDBTransaction å¯¹è±¡</li><li>æ“ä½œè¯·æ±‚ï¼šIDBRequest å¯¹è±¡</li><li>æŒ‡é’ˆï¼š IDBCursor å¯¹è±¡</li><li>ä¸»é”®é›†åˆï¼šIDBKeyRange å¯¹è±¡</li></ul><h3 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h3><p>ä¸€ä¸ªåŸºæœ¬çš„<code>indexDB</code>æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>æ‰“å¼€æ•°æ®åº“</li><li>åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“</li><li>å¼€å¯äº‹åŠ¡ï¼Œå¹¶å‘èµ·æ•°æ®åº“æ“ä½œè¯·æ±‚</li><li>ç›‘å¬ç‰¹å®šäº‹ä»¶ï¼Œç­‰å¾…æ“ä½œå®Œæˆ</li><li>å¯¹è¿”å›ç»“æœè¿›è¡Œå¤„ç†</li></ol><h4 id="æ‰“å¼€æ•°æ®åº“"><a href="#æ‰“å¼€æ•°æ®åº“" class="headerlink" title="æ‰“å¼€æ•°æ®åº“"></a>æ‰“å¼€æ•°æ®åº“</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> db</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">require</span> = <span class="built_in">window</span>.indexedDB.open(databaseName, version)</span><br><span class="line"></span><br><span class="line">request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“æ‰“å¼€æŠ¥é”™'</span>)</span><br><span class="line">&#125;</span><br><span class="line">request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“æ‰“å¼€æˆåŠŸ'</span>)</span><br><span class="line">  db = event.target.result</span><br><span class="line">&#125;</span><br><span class="line">request.onupgradeneeded = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åº“å‡çº§æˆåŠŸ'</span>)</span><br><span class="line">  db = event.target.result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>window.indexedDB.open</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ<br>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„åå­—ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºæ•°æ®åº“ã€‚<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•´æ•°ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚<br>å¦‚æœçœç•¥ï¼Œæ‰“å¼€å·²æœ‰æ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸ºå½“å‰ç‰ˆæœ¬ï¼›æ–°å»ºæ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸º1ã€‚<br>å¦‚æœæŒ‡å®šçš„ç‰ˆæœ¬å·ï¼Œå¤§äºæ•°æ®åº“çš„å®é™…ç‰ˆæœ¬å·ï¼Œå°±ä¼šå‘ç”Ÿæ•°æ®åº“å‡çº§äº‹ä»¶<code>onupgradeneeded</code>ã€‚</p><p><strong>Note: æ•°æ®åº“å‡çº§æˆåŠŸä¹‹åä¼šè°ƒç”¨<code>onsuccess</code>çš„å›è°ƒ</strong></p><h4 id="æ–°å»ºå¯¹è±¡ä»“åº“"><a href="#æ–°å»ºå¯¹è±¡ä»“åº“" class="headerlink" title="æ–°å»ºå¯¹è±¡ä»“åº“"></a>æ–°å»ºå¯¹è±¡ä»“åº“</h4><p>æ–°å»º/åˆ é™¤/æ›´æ–°å¯¹è±¡ä»“åº“åªèƒ½åœ¨æ•°æ®åº“å‡çº§çš„å›è°ƒå‡½æ•°ä¸­ï¼Œ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This event is only implemented in recent browsers   </span></span><br><span class="line">request.onupgradeneeded = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123; </span><br><span class="line">  <span class="comment">// Save the IDBDatabase interface </span></span><br><span class="line">  db = event.target.result;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create an objectStore for this database</span></span><br><span class="line">  <span class="keyword">const</span> objectStore = db.createObjectStore(<span class="string">"name"</span>, &#123; <span class="attr">keyPath</span>: <span class="string">"myKey"</span> &#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>ä¸»é”®ï¼ˆkeyï¼‰æ˜¯é»˜è®¤å»ºç«‹ç´¢å¼•çš„å±æ€§ã€‚<br>æ¯”å¦‚ï¼Œæ•°æ®è®°å½•æ˜¯<code>{ id: 1, name: &#39;å¼ ä¸‰&#39; }</code>ï¼Œé‚£ä¹ˆ<code>id</code>å±æ€§å¯ä»¥ä½œä¸ºä¸»é”®ã€‚<br>ä¸»é”®ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸‹ä¸€å±‚å¯¹è±¡çš„å±æ€§ï¼Œæ¯”å¦‚<code>{ foo: { bar: &#39;baz&#39; } }</code>çš„<code>foo.bar</code>ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸»é”®ã€‚</p><p>å¦‚æœè¦æŒ‡å®šä¸»é”®ä¸ºä¸€ä¸ªé€’å¢çš„æ•´æ•°ï¼Œå¯ä»¥ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createObjectStore(&quot;name&quot;, &#123; keyPath: &quot;myKey&quot;, autoIncrement: true &#125;)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¦åˆ›å»ºç´¢å¼•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objectStore.createIndex(&apos;name&apos;, &apos;name&apos;, &#123; unique: false &#125;);</span><br><span class="line">objectStore.createIndex(&apos;email&apos;, &apos;email&apos;, &#123; unique: true &#125;);</span><br></pre></td></tr></table></figure></p><h4 id="å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ"><a href="#å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ" class="headerlink" title="å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ"></a>å¼€å¯äº‹åŠ¡ï¼Œæ•°æ®åº“æ“ä½œ</h4><p>å¼€å¯äº‹åŠ¡çš„æ–¹æ³•æ˜¯<code>IDBDatabase.transaction([&#39;person&#39;], &#39;readwrite&#39;)</code>ã€‚<br>å…¶ä¸­<code>person</code>æ˜¯å¯¹è±¡ä»“åº“åï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡æ˜è¯»å†™æƒé™ï¼š<code>&#39;readwrite&#39;/&#39;readonly&#39;</code>ã€‚</p><p>å¼€å¯äº‹åŠ¡ä¹‹åé€šè¿‡<code>IDBTransaction.objectStore(name)</code>ï¼Œæ‹¿åˆ° <code>IDBObjectStore</code> å¯¹è±¡ã€‚<br>åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨å¢åˆ æ”¹æŸ¥çš„æ–¹æ³•ã€‚</p><p><strong>Note: å½“ä¸€æ¬¡äº‹åŠ¡éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå¤šæ¬¡æ“ä½œçš„æ—¶å€™ï¼Œå°±è¦ç›‘å¬äº‹åŠ¡çš„å›è°ƒ<code>oncomplete</code>å’Œ<code>onerror</code></strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Do something when all the data is added to the database.</span></span><br><span class="line">transaction.oncomplete = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">"All done!"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">transaction.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Don't forget to handle errors!</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.objectStore(<span class="string">"customers"</span>);</span><br><span class="line">customerData.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">customer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = objectStore.add(customer);</span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// event.target.result === customer.ssn;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h5 id="å¢"><a href="#å¢" class="headerlink" title="å¢"></a>å¢</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .add(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'å¼ ä¸‰'</span>, <span class="attr">age</span>: <span class="number">24</span>, <span class="attr">email</span>: <span class="string">'zhangsan@example.com'</span> &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®å†™å…¥æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®å†™å…¥å¤±è´¥'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add();</span><br></pre></td></tr></table></figure><h5 id="åˆ "><a href="#åˆ " class="headerlink" title="åˆ "></a>åˆ </h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .delete(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®åˆ é™¤æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">remove();</span><br></pre></td></tr></table></figure><p><strong>Note: deleteæ–¹æ³•çš„å‚æ•°æ˜¯ä¸»é”®å€¼</strong></p><h5 id="æ”¹"><a href="#æ”¹" class="headerlink" title="æ”¹"></a>æ”¹</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> request = db.transaction([<span class="string">'person'</span>], <span class="string">'readwrite'</span>)</span><br><span class="line">    .objectStore(<span class="string">'person'</span>)</span><br><span class="line">    .put(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'æå››'</span>, <span class="attr">age</span>: <span class="number">35</span>, <span class="attr">email</span>: <span class="string">'lisi@example.com'</span> &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°æˆåŠŸ'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°å¤±è´¥'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">update();</span><br></pre></td></tr></table></figure><p><strong>Note: putæ–¹æ³•æ˜¯æŒ‰ç…§ä¸»é”®å€¼æ¥è¿›è¡Œæ›´æ–°ã€‚</strong></p><h5 id="æŸ¥"><a href="#æŸ¥" class="headerlink" title="æŸ¥"></a>æŸ¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">const</span> transaction = db.transaction([<span class="string">'person'</span>]);</span><br><span class="line">   <span class="keyword">const</span> objectStore = transaction.objectStore(<span class="string">'person'</span>);</span><br><span class="line">   <span class="keyword">const</span> request = objectStore.get(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">   request.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'æŸ¥è¯¢å¤±è´¥'</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   request.onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params"> event</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (request.result) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Name: '</span> + request.result.name);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Age: '</span> + request.result.age);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Email: '</span> + request.result.email);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æœªè·å¾—æ•°æ®è®°å½•'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">read();</span><br></pre></td></tr></table></figure><p><strong>Note: getæ–¹æ³•çš„å‚æ•°æ˜¯ä¸»é”®å€¼</strong></p><h4 id="ç´¢å¼•çš„ä½¿ç”¨"><a href="#ç´¢å¼•çš„ä½¿ç”¨" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨"></a>ç´¢å¼•çš„ä½¿ç”¨</h4><p>ç´¢å¼•çš„æ„ä¹‰åœ¨äºï¼Œå¯ä»¥è®©ä½ æœç´¢ä»»æ„å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä»»æ„å­—æ®µæ‹¿åˆ°æ•°æ®è®°å½•ã€‚å¦‚æœä¸å»ºç«‹ç´¢å¼•ï¼Œé»˜è®¤åªèƒ½æœç´¢ä¸»é”®ï¼ˆå³ä»ä¸»é”®å–å€¼ï¼‰ã€‚</p><p>åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å¯¹<code>name</code>å’Œ<code>email</code>å»ºç«‹äº†ç´¢å¼•ã€‚<br>ç°åœ¨ï¼Œå°±å¯ä»¥ä»<code>name</code>æ‰¾åˆ°å¯¹åº”çš„æ•°æ®è®°å½•äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.transaction([<span class="string">'person'</span>], <span class="string">'readonly'</span>);</span><br><span class="line"><span class="keyword">const</span> store = transaction.objectStore(<span class="string">'person'</span>);</span><br><span class="line"><span class="keyword">const</span> index = store.index(<span class="string">'name'</span>);</span><br><span class="line"><span class="keyword">const</span> request = index.get(<span class="string">'æå››'</span>);</span><br><span class="line"></span><br><span class="line">request.onsuccess = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = e.target.result;</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note: å› ä¸ºâ€™nameâ€™ç´¢å¼•è®¾ç½®æˆä¸æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå‡ºç°é‡åã€‚è¿™ç§æƒ…å†µåªä¼šè¿”å›ä¸€æ¡æ•°æ®ï¼ˆkeyæœ€å°çš„æ•°æ®ï¼‰ã€‚å¦‚æœæƒ³è¦è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æ‰€è¯´çš„æ¸¸æ ‡</strong></p><h4 id="æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨"><a href="#æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨" class="headerlink" title="æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨"></a>æ¸¸æ ‡ï¼ˆcursorï¼‰çš„ä½¿ç”¨</h4><p>å½“éœ€è¦éå†æ•°æ®åº“æ‰€æœ‰æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ¸¸æ ‡ï¼ˆcursorï¼‰ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectStore = db.transaction(<span class="string">"customers"</span>).objectStore(<span class="string">"customers"</span>);</span><br><span class="line"></span><br><span class="line">objectStore.openCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    alert(<span class="string">"Name for SSN "</span> + cursor.key + <span class="string">" is "</span> + cursor.value.name);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    alert(<span class="string">"No more entries!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><strong>Note: å¦‚æœåªæ˜¯æƒ³è·å–åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨<code>objectStore.getAll()</code>æˆ–<code>objectStore.getAllKeys()</code></strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">objectStore.getAll().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">"Got all customers: "</span> + event.target.result);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œç´¢å¼•ä¹Ÿå¯ä»¥ä½¿ç”¨æ¸¸æ ‡:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ™®é€šçš„æ¸¸æ ‡ï¼Œä¼šè·å–æ•´ä¸ªæ•°æ®å¯¹è±¡</span></span><br><span class="line">index.openCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="comment">// cursor.key is a name, like "Bill", and cursor.value is the whole object.</span></span><br><span class="line">    alert(<span class="string">"Name: "</span> + cursor.key + <span class="string">", SSN: "</span> + cursor.value.ssn + <span class="string">", email: "</span> + cursor.value.email);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨keyæ¸¸æ ‡ï¼Œä¼šè·å–æ•°æ®å¯¹è±¡çš„key</span></span><br><span class="line">index.openKeyCursor().onsuccess = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="comment">// cursor.key is a name, like "Bill", and cursor.value is the SSN.</span></span><br><span class="line">    <span class="comment">// No way to directly get the rest of the stored object.</span></span><br><span class="line">    alert(<span class="string">"Name: "</span> + cursor.key + <span class="string">", SSN: "</span> + cursor.primaryKey);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.ruanyifeng.com/blog/2018/07/indexeddb.html" target="_blank" rel="noopener">æµè§ˆå™¨æ•°æ®åº“ IndexedDB å…¥é—¨æ•™ç¨‹</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB" target="_blank" rel="noopener">Using IndexedDB</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;ç°ä»£æµè§ˆå™¨æä¾›äº†ä¸€äº›æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œä¾‹å¦‚&lt;code&gt;cookie&lt;/code&gt;ã€&lt;code&gt;sessionStorage&lt;/code&gt;ã€&lt;code&gt;localStorage&lt;/code&gt;å’Œ&lt;code&gt;indexedDB&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›éƒ½èƒ½åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·çš„&lt;code&gt;application&lt;/code&gt;æ ‡ç­¾é¡µä¸­èƒ½çœ‹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œ&lt;code&gt;indexedDB&lt;/code&gt;çš„åŸºæœ¬ç”¨æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šä¿—åœ°è¯´ï¼Œ&lt;code&gt;IndexedDB&lt;/code&gt; å°±æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚&lt;br&gt;&lt;code&gt;IndexedDB&lt;/code&gt; å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚&lt;br&gt;è¿™äº›éƒ½æ˜¯ &lt;code&gt;LocalStorage&lt;/code&gt; æ‰€ä¸å…·å¤‡çš„ã€‚&lt;br&gt;å°±æ•°æ®åº“ç±»å‹è€Œè¨€ï¼Œ&lt;code&gt;IndexedDB&lt;/code&gt; ä¸å±äºå…³ç³»å‹æ•°æ®åº“ï¼ˆä¸æ”¯æŒ &lt;code&gt;SQL&lt;/code&gt; æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œæ›´æ¥è¿‘ &lt;code&gt;NoSQL&lt;/code&gt; æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="https://sampwood.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>ä»£ç æ£€æŸ¥å·¥ä½œæµä¹‹husky+lint-staged</title>
    <link href="https://sampwood.github.io/2019/02/28/husky-lint-staged/"/>
    <id>https://sampwood.github.io/2019/02/28/husky-lint-staged/</id>
    <published>2019-02-28T06:13:09.000Z</published>
    <updated>2019-03-06T05:51:53.737Z</updated>
    
    <content type="html"><![CDATA[<p>è™½ç„¶å¤§å®¶éƒ½ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨eslintç­‰å·¥å…·æ¥è¿›è¡Œä»£ç æ ¼å¼æ£€æŸ¥ã€‚<br>ä½†å¦‚æœæ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘<code>npm run lint</code>æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¿˜è®°ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>åœ¨è¿™é‡Œæˆ‘ç”¨è¿™ä¸ªåŠæ³•ï¼šåœ¨<code>git commit</code>çš„æ—¶å€™æ¥è‡ªåŠ¨è·‘eslintæ¥æ£€æŸ¥ä»£ç ã€‚</p><p>éœ€è¦çš„å·¥å…·æ˜¯ï¼š <code>husky</code> + <code>lint-staged</code></p><p><code>husky</code>çš„ä½œç”¨æ˜¯æä¾›<code>git commit hook</code>ï¼Œ<code>lint-staged</code>çš„ä½œç”¨æ˜¯è®©eslintçš„èŒƒå›´é™å®šåœ¨æœ¬æ¬¡çš„æ”¹åŠ¨æ–‡ä»¶ä¸­ã€‚</p><a id="more"></a><h3 id="é…ç½®husky-lint-staged"><a href="#é…ç½®husky-lint-staged" class="headerlink" title="é…ç½®husky+lint-staged"></a>é…ç½®<code>husky</code>+<code>lint-staged</code></h3><p>å®‰è£…æ’ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D husky lint-staged</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹<code>package.json</code>æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;precommit&quot;: &quot;lint-staged&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;lint-staged&quot;: &#123;</span><br><span class="line">    &quot;src/**/*.js&quot;: &quot;eslint&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000009546913" target="_blank" rel="noopener">ç”¨ husky å’Œ lint-staged æ„å»ºè¶…æºœçš„ä»£ç æ£€æŸ¥å·¥ä½œæµ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è™½ç„¶å¤§å®¶éƒ½ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨eslintç­‰å·¥å…·æ¥è¿›è¡Œä»£ç æ ¼å¼æ£€æŸ¥ã€‚&lt;br&gt;ä½†å¦‚æœæ¯æ¬¡éƒ½æ‰‹åŠ¨å»è·‘&lt;code&gt;npm run lint&lt;/code&gt;æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¿˜è®°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ç”¨è¿™ä¸ªåŠæ³•ï¼šåœ¨&lt;code&gt;git commit&lt;/code&gt;çš„æ—¶å€™æ¥è‡ªåŠ¨è·‘eslintæ¥æ£€æŸ¥ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦çš„å·¥å…·æ˜¯ï¼š &lt;code&gt;husky&lt;/code&gt; + &lt;code&gt;lint-staged&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;husky&lt;/code&gt;çš„ä½œç”¨æ˜¯æä¾›&lt;code&gt;git commit hook&lt;/code&gt;ï¼Œ&lt;code&gt;lint-staged&lt;/code&gt;çš„ä½œç”¨æ˜¯è®©eslintçš„èŒƒå›´é™å®šåœ¨æœ¬æ¬¡çš„æ”¹åŠ¨æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linter" scheme="https://sampwood.github.io/categories/coding/linter/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="eslint" scheme="https://sampwood.github.io/tags/eslint/"/>
    
  </entry>
  
  <entry>
    <title>sshçš„ä½¿ç”¨å’Œé…ç½®</title>
    <link href="https://sampwood.github.io/2019/02/28/ssh%E7%9A%84%E4%BD%BF%E7%94%A8%E5%92%8C%E9%85%8D%E7%BD%AE/"/>
    <id>https://sampwood.github.io/2019/02/28/sshçš„ä½¿ç”¨å’Œé…ç½®/</id>
    <published>2019-02-28T05:55:00.000Z</published>
    <updated>2019-03-28T01:17:58.778Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys"><a href="#æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys" class="headerlink" title="æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys"></a>æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -al ~/.ssh</span><br></pre></td></tr></table></figure><h3 id="æ–°å»ºssh-key"><a href="#æ–°å»ºssh-key" class="headerlink" title="æ–°å»ºssh key"></a>æ–°å»ºssh key</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">"your_email@example.com"</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key"><a href="#ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key" class="headerlink" title="ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key"></a>ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> $(ssh-agent -s)</span><br><span class="line">ssh-add ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="ä¿®æ”¹ssh-keyçš„å¯†ç "><a href="#ä¿®æ”¹ssh-keyçš„å¯†ç " class="headerlink" title="ä¿®æ”¹ssh keyçš„å¯†ç "></a>ä¿®æ”¹ssh keyçš„å¯†ç </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -f ~/.ssh/id_rsa -p</span><br></pre></td></tr></table></figure><h3 id="é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh"><a href="#é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh" class="headerlink" title="é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh"></a>é…ç½®ä¸åŒçš„hostä½¿ç”¨ä¸åŒçš„ssh</h3><p>åœ¨<code>~/.ssh</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»º<code>config</code>æ–‡ä»¶å¹¶å†™å…¥ä¸‹é¢çš„ä»£ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Host xxx.com</span><br><span class="line">  HostName 192.168.1.1</span><br><span class="line">  IdentityFile ~/.ssh/id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br><span class="line">Host github.com</span><br><span class="line">  HostName github.com</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~/.ssh/sampwood_id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br><span class="line">Host gitlab.com</span><br><span class="line">  HostName gitlab.com</span><br><span class="line">  User git</span><br><span class="line">  IdentityFile ~/.ssh/sampwood_id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://help.github.com/en/articles/connecting-to-github-with-ssh" target="_blank" rel="noopener">Connecting to GitHub with SSH</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys&quot;&gt;&lt;a href=&quot;#æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh-keys&quot; class=&quot;headerlink&quot; title=&quot;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys&quot;&gt;&lt;/a&gt;æ£€æŸ¥å·²ç»å­˜åœ¨çš„ssh keys&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ls -al ~/.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;æ–°å»ºssh-key&quot;&gt;&lt;a href=&quot;#æ–°å»ºssh-key&quot; class=&quot;headerlink&quot; title=&quot;æ–°å»ºssh key&quot;&gt;&lt;/a&gt;æ–°å»ºssh key&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssh-keygen -t rsa -b 4096 -C &lt;span class=&quot;string&quot;&gt;&quot;your_email@example.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh-key&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key&quot;&gt;&lt;/a&gt;ä½¿ç”¨ssh-agentæ¥ç®¡ç†ssh key&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt; $(ssh-agent -s)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh-add ~/.ssh/id_rsa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>èŠ‚æµå’Œé˜²æŠ–</title>
    <link href="https://sampwood.github.io/2019/01/11/%E8%8A%82%E6%B5%81%E5%92%8C%E9%98%B2%E6%8A%96/"/>
    <id>https://sampwood.github.io/2019/01/11/èŠ‚æµå’Œé˜²æŠ–/</id>
    <published>2019-01-11T06:21:07.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p><strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰</strong></p><blockquote><p>å½“è°ƒç”¨åŠ¨ä½œè¿‡næ¯«ç§’åï¼Œæ‰ä¼šæ‰§è¡Œè¯¥åŠ¨ä½œï¼Œè‹¥åœ¨è¿™næ¯«ç§’å†…åˆè°ƒç”¨æ­¤åŠ¨ä½œåˆ™å°†é‡æ–°è®¡ç®—æ‰§è¡Œæ—¶é—´</p></blockquote><p><strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong></p><blockquote><p>é¢„å…ˆè®¾å®šä¸€ä¸ªæ‰§è¡Œå‘¨æœŸï¼Œå½“è°ƒç”¨åŠ¨ä½œçš„æ—¶åˆ»å¤§äºç­‰äºæ‰§è¡Œå‘¨æœŸåˆ™æ‰§è¡Œè¯¥åŠ¨ä½œï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªæ–°å‘¨æœŸ</p></blockquote><p><strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong>ä¸ <strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰</strong>éƒ½æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘æ¬¡ï¼Œ<br>ä»¥ä¼˜åŒ–å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜å¯¼è‡´çš„å“åº”é€Ÿåº¦è·Ÿä¸ä¸Šè§¦å‘é¢‘ç‡ï¼Œå‡ºç°å»¶è¿Ÿï¼Œå‡æ­»æˆ–å¡é¡¿çš„ç°è±¡ã€‚</p><a id="more"></a><p>å¸¸ç”¨çš„åœºæ™¯æœ‰ï¼š</p><ul><li>windowå¯¹è±¡çš„resizeã€scrolläº‹ä»¶</li><li>æ‹–æ‹½æ—¶çš„mousemoveäº‹ä»¶</li><li>æ–‡å­—è¾“å…¥ã€è‡ªåŠ¨å®Œæˆçš„keyupäº‹ä»¶ </li></ul><p><strong>è¯å¥è¯æ¥è¯´è¿™ä¸¤è€…çš„åŒºåˆ«å°±æ˜¯ï¼Œæ˜¯å¦åœ¨åŠ¨ä½œæŒç»­çš„è¿‡ç¨‹ä¸­ï¼Œé‡æ–°è®¡ç®—è¿‡æœŸæ—¶é—´ã€‚</strong></p><p>é˜²æŠ– åªä¼šåœ¨åŠ¨ä½œâ€œçœŸæ­£ç»“æŸâ€åæ‰è§¦å‘å‡½æ•°ï¼ŒèŠ‚æµ ä¼šåœ¨è¶…è¿‡é¢„å®šæ—¶å€™åå°±ä¼šè§¦å‘å‡½æ•°</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>å‡½æ•°é˜²æŠ–ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, wait</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> context = <span class="keyword">this</span></span><br><span class="line">      <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">      <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">          clearTimeout(timer);</span><br><span class="line">          timer = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          fn.apply(context, args)</span><br><span class="line">      &#125;, wait)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'boom'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(debounce(fn,<span class="number">500</span>),<span class="number">1000</span>) <span class="comment">// ç¬¬ä¸€æ¬¡åœ¨1500msåè§¦å‘ï¼Œä¹‹åæ¯1000msè§¦å‘ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line">setInterval(debounce(fn,<span class="number">2000</span>),<span class="number">1000</span>) <span class="comment">// ä¸ä¼šè§¦å‘ä¸€æ¬¡ï¼ˆæˆ‘æŠŠå‡½æ•°é˜²æŠ–çœ‹å‡ºæŠ€èƒ½è¯»æ¡ï¼Œå¦‚æœè¯»æ¡æ²¡å®Œæˆå°±ç”¨æŠ€èƒ½ï¼Œä¾¿ä¼šå¤±è´¥è€Œä¸”é‡æ–°è¯»æ¡ï¼‰</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°èŠ‚æµï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, gapTime</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _lastTime = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _nowTime = + <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    <span class="keyword">if</span> (_nowTime - _lastTime &gt; gapTime || !_lastTime) &#123;</span><br><span class="line">      fn();</span><br><span class="line">      _lastTime = _nowTime</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'boom'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(throttle(fn,<span class="number">1000</span>),<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://segmentfault.com/a/1190000008768202" target="_blank" rel="noopener">å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–</a></li><li><a href="https://juejin.im/post/5a35ed25f265da431d3cc1b1" target="_blank" rel="noopener">è½»æ¾ç†è§£JSå‡½æ•°èŠ‚æµå’Œå‡½æ•°é˜²æŠ–</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µ&quot;&gt;&lt;/a&gt;æ¦‚å¿µ&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“è°ƒç”¨åŠ¨ä½œè¿‡næ¯«ç§’åï¼Œæ‰ä¼šæ‰§è¡Œè¯¥åŠ¨ä½œï¼Œè‹¥åœ¨è¿™næ¯«ç§’å†…åˆè°ƒç”¨æ­¤åŠ¨ä½œåˆ™å°†é‡æ–°è®¡ç®—æ‰§è¡Œæ—¶é—´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢„å…ˆè®¾å®šä¸€ä¸ªæ‰§è¡Œå‘¨æœŸï¼Œå½“è°ƒç”¨åŠ¨ä½œçš„æ—¶åˆ»å¤§äºç­‰äºæ‰§è¡Œå‘¨æœŸåˆ™æ‰§è¡Œè¯¥åŠ¨ä½œï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªæ–°å‘¨æœŸ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰&lt;/strong&gt;ä¸ &lt;strong&gt;å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰&lt;/strong&gt;éƒ½æ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘æ¬¡ï¼Œ&lt;br&gt;ä»¥ä¼˜åŒ–å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜å¯¼è‡´çš„å“åº”é€Ÿåº¦è·Ÿä¸ä¸Šè§¦å‘é¢‘ç‡ï¼Œå‡ºç°å»¶è¿Ÿï¼Œå‡æ­»æˆ–å¡é¡¿çš„ç°è±¡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="utils" scheme="https://sampwood.github.io/tags/utils/"/>
    
  </entry>
  
  <entry>
    <title>è·¨åŸŸé—®é¢˜</title>
    <link href="https://sampwood.github.io/2019/01/08/%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
    <id>https://sampwood.github.io/2019/01/08/è·¨åŸŸé—®é¢˜/</id>
    <published>2019-01-08T02:22:54.000Z</published>
    <updated>2019-03-06T05:51:53.743Z</updated>
    
    <content type="html"><![CDATA[<p>è·¨åŸŸåœ¨å‰ç«¯æ˜¯ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ã€‚<br>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œä»€ä¹ˆæƒ…å†µä¸‹å‡ºç°è·¨åŸŸã€‚</p><h3 id="æ¦‚å¿µä»¥åŠåœºæ™¯"><a href="#æ¦‚å¿µä»¥åŠåœºæ™¯" class="headerlink" title="æ¦‚å¿µä»¥åŠåœºæ™¯"></a>æ¦‚å¿µä»¥åŠåœºæ™¯</h3><p>è·¨åŸŸçš„å§‹ä½œä¿‘è€…æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener">åŒæºç­–ç•¥</a>:</p><blockquote><p>åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚</p></blockquote><p>æ¢å¥è¯è¯´å°±æ˜¯ï¼Œæµè§ˆå™¨é™åˆ¶äº†ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªé¡µé¢ä¸‹é¢å»è°ƒç”¨å¦å¤–ä¸€ä¸ªæºçš„èµ„æºã€‚<br>æœ€å¸¸è§çš„åœºæ™¯æ˜¯æˆ‘ä»¬åœ¨å½“å‰é¡µé¢ä¸‹è°ƒç”¨äº†å¦ä¸€ä¸ªæºçš„æ¥å£ã€‚ç»“æœæµè§ˆå™¨ç›´æ¥æŠ¥é”™äº†ï¼Œè¯´ä¸è¡Œï¼Œä¸èƒ½è¿™æ ·å¹²ã€‚</p><p>ä¸‹é¢æ˜¯åŒæºçš„å®šä¹‰ï¼š</p><blockquote><p>å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æºã€‚</p></blockquote><a id="more"></a><h4 id="é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥"><a href="#é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥" class="headerlink" title="é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥"></a>é€ æˆè·¨åŸŸçš„ä¸¤ç§ç­–ç•¥</h4><p>æµè§ˆå™¨çš„åŒæºç­–ç•¥ä¼šå¯¼è‡´è·¨åŸŸï¼Œè¿™é‡ŒåŒæºç­–ç•¥åˆåˆ†ä¸ºä»¥ä¸‹ä¸¤ç§</p><ol><li>DOMåŒæºç­–ç•¥ï¼šç¦æ­¢å¯¹ä¸åŒæºé¡µé¢DOMè¿›è¡Œæ“ä½œã€‚è¿™é‡Œä¸»è¦åœºæ™¯æ˜¯iframeè·¨åŸŸçš„æƒ…å†µï¼Œä¸åŒåŸŸåçš„iframeæ˜¯é™åˆ¶äº’ç›¸è®¿é—®çš„ã€‚</li><li>XmlHttpRequeståŒæºç­–ç•¥ï¼šç¦æ­¢ä½¿ç”¨XHRå¯¹è±¡å‘ä¸åŒæºçš„æœåŠ¡å™¨åœ°å€å‘èµ·HTTPè¯·æ±‚ã€‚</li></ol><h3 id="è·¨åŸŸè§£å†³æ–¹æ¡ˆ"><a href="#è·¨åŸŸè§£å†³æ–¹æ¡ˆ" class="headerlink" title="è·¨åŸŸè§£å†³æ–¹æ¡ˆ"></a>è·¨åŸŸè§£å†³æ–¹æ¡ˆ</h3><p>è·¨åŸŸçš„é—®é¢˜æ˜¯æœ‰è§£å†³æ–¹æ¡ˆçš„ã€‚</p><h4 id="è·¨åŸŸèµ„æºå…±äº«"><a href="#è·¨åŸŸèµ„æºå…±äº«" class="headerlink" title="è·¨åŸŸèµ„æºå…±äº«"></a>è·¨åŸŸèµ„æºå…±äº«</h4><p>CORSæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ã€‚ å¯¹äºè¿™ä¸ªæ–¹å¼ï¼Œé˜®ä¸€å³°è€å¸ˆæ€»ç»“çš„æ–‡ç« ç‰¹åˆ«å¥½ï¼Œå¸Œæœ›æ·±å…¥äº†è§£çš„å¯ä»¥çœ‹ä¸€ä¸‹<a href="http://www.ruanyifeng.com/blog/2016/04/cors.htmlã€‚" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2016/04/cors.htmlã€‚</a></p><h4 id="jsnop"><a href="#jsnop" class="headerlink" title="jsnop"></a>jsnop</h4><p>åˆ©ç”¨ â€œåœ¨HTMLæ ‡ç­¾é‡Œï¼Œä¸€äº›æ ‡ç­¾æ¯”å¦‚scriptã€imgè¿™æ ·çš„è·å–èµ„æºçš„æ ‡ç­¾æ˜¯æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„â€ æ¥å®ç°è·¨åŸŸ</p><h4 id="æœåŠ¡å™¨ä»£ç†"><a href="#æœåŠ¡å™¨ä»£ç†" class="headerlink" title="æœåŠ¡å™¨ä»£ç†"></a>æœåŠ¡å™¨ä»£ç†</h4><h4 id="document-domainæ¥è·¨å­åŸŸ"><a href="#document-domainæ¥è·¨å­åŸŸ" class="headerlink" title="document.domainæ¥è·¨å­åŸŸ"></a>document.domainæ¥è·¨å­åŸŸ</h4><p>å¯¹äºä¸»åŸŸåç›¸åŒï¼Œè€Œå­åŸŸåä¸åŒçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨document.domainæ¥è·¨åŸŸ è¿™ç§æ–¹å¼éå¸¸é€‚ç”¨äºiframeè·¨åŸŸçš„æƒ…å†µã€‚</p><h4 id="window-nameè¿›è¡Œè·¨åŸŸ"><a href="#window-nameè¿›è¡Œè·¨åŸŸ" class="headerlink" title="window.nameè¿›è¡Œè·¨åŸŸ"></a>window.nameè¿›è¡Œè·¨åŸŸ</h4><p>window.nameè·¨åŸŸåŒæ ·æ˜¯å—åˆ°åŒæºç­–ç•¥é™åˆ¶ï¼Œçˆ¶æ¡†æ¶å’Œå­æ¡†æ¶çš„srcå¿…é¡»æŒ‡å‘ç»Ÿä¸€åŸŸåã€‚<br>window.nameçš„ä¼˜åŠ¿åœ¨äºï¼Œnameçš„å€¼åœ¨ä¸åŒçš„é¡µé¢(æˆ–è€…ä¸åŒçš„åŸŸå)ï¼ŒåŠ è½½åä»ç„¶å­˜åœ¨ï¼Œé™¤éä½ æ˜¾ç¤ºçš„æ›´æ”¹ã€‚å¹¶ä¸”æ”¯æŒçš„é•¿åº¦è¾¾åˆ°2M.</p><h4 id="location-hashè·¨åŸŸ"><a href="#location-hashè·¨åŸŸ" class="headerlink" title="location.hashè·¨åŸŸ"></a>location.hashè·¨åŸŸ</h4><p>location.hashæ–¹å¼è·¨åŸŸï¼Œæ˜¯å­æ¡†æ¶å…·æœ‰ä¿®æ”¹çˆ¶æ¡†æ¶srcçš„hashå€¼ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§è¿›è¡Œä¼ é€’æ•°æ®ï¼Œä¸”æ›´æ”¹hashå€¼ï¼Œé¡µé¢ä¸ä¼šåˆ·æ–°ã€‚<br>ä½†æ˜¯ä¼ é€’çš„æ•°æ®çš„å­—èŠ‚æ•°æ˜¯æœ‰é™çš„ã€‚</p><blockquote><p>è¡¥å……ï¼š å…¶å®è¿˜æœ‰ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚window.nameå’Œlocation.hashã€‚<br>å°±å¾ˆé€‚ç”¨äºiframeçš„è·¨åŸŸï¼Œä¸è¿‡iframeç”¨çš„æ¯”è¾ƒå°‘äº†ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•ä¹Ÿå°±æœ‰ç‚¹è¿‡æ—¶äº†ã€‚</p></blockquote><h4 id="ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡"><a href="#ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡" class="headerlink" title="ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡"></a>ä½¿ç”¨postMessageå®ç°é¡µé¢ä¹‹é—´é€šä¿¡</h4><p>window.postMessageæ˜¯ä¸€ä¸ªHTML5çš„apiï¼Œå…è®¸ä¸¤ä¸ªçª—å£ä¹‹é—´è¿›è¡Œè·¨åŸŸå‘é€æ¶ˆæ¯ã€‚<br>è¿™ä¸ªåº”è¯¥å°±æ˜¯ä»¥åè§£å†³domè·¨åŸŸé€šç”¨æ–¹æ³•äº†ï¼Œå…·ä½“å¯ä»¥å‚ç…§MDNã€‚</p><h3 id="ä¸€äº›å®ç”¨æ–¹æ³•"><a href="#ä¸€äº›å®ç”¨æ–¹æ³•" class="headerlink" title="ä¸€äº›å®ç”¨æ–¹æ³•"></a>ä¸€äº›å®ç”¨æ–¹æ³•</h3><ul><li>è·¨åŸŸä¸‹è·å–iframeçš„çˆ¶é¡µé¢URLï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getParentHost = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> host = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (parent !== <span class="built_in">window</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      host = parent.location.origin;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">const</span> url = <span class="built_in">document</span>.referrer;</span><br><span class="line">      host = url.split(<span class="string">'/'</span>).splice(<span class="number">0</span>, <span class="number">3</span>).join(<span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> host;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/28562290" target="_blank" rel="noopener">è·¨åŸŸçš„é‚£äº›äº‹å„¿</a></li><li><a href="https://www.jianshu.com/p/06529543f03a" target="_blank" rel="noopener">å‰ç«¯è·¨åŸŸæ•´ç†</a></li><li><a href="https://segmentfault.com/a/1190000015597029" target="_blank" rel="noopener">ä¸è¦å†é—®æˆ‘è·¨åŸŸçš„é—®é¢˜äº†</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è·¨åŸŸåœ¨å‰ç«¯æ˜¯ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ã€‚&lt;br&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œä»€ä¹ˆæƒ…å†µä¸‹å‡ºç°è·¨åŸŸã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ¦‚å¿µä»¥åŠåœºæ™¯&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µä»¥åŠåœºæ™¯&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µä»¥åŠåœºæ™¯&quot;&gt;&lt;/a&gt;æ¦‚å¿µä»¥åŠåœºæ™¯&lt;/h3&gt;&lt;p&gt;è·¨åŸŸçš„å§‹ä½œä¿‘è€…æ˜¯&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŒæºç­–ç•¥&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦å®‰å…¨æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¢å¥è¯è¯´å°±æ˜¯ï¼Œæµè§ˆå™¨é™åˆ¶äº†ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªé¡µé¢ä¸‹é¢å»è°ƒç”¨å¦å¤–ä¸€ä¸ªæºçš„èµ„æºã€‚&lt;br&gt;æœ€å¸¸è§çš„åœºæ™¯æ˜¯æˆ‘ä»¬åœ¨å½“å‰é¡µé¢ä¸‹è°ƒç”¨äº†å¦ä¸€ä¸ªæºçš„æ¥å£ã€‚ç»“æœæµè§ˆå™¨ç›´æ¥æŠ¥é”™äº†ï¼Œè¯´ä¸è¡Œï¼Œä¸èƒ½è¿™æ ·å¹²ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åŒæºçš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="http" scheme="https://sampwood.github.io/categories/coding/http/"/>
    
    
      <category term="è·¨åŸŸ" scheme="https://sampwood.github.io/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>gitå¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜(LF/CRLF)</title>
    <link href="https://sampwood.github.io/2019/01/07/git%E5%A4%9A%E5%B9%B3%E5%8F%B0%E6%8D%A2%E8%A1%8C%E7%AC%A6%E9%97%AE%E9%A2%98-LF-CRLF/"/>
    <id>https://sampwood.github.io/2019/01/07/gitå¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜-LF-CRLF/</id>
    <published>2019-01-07T08:51:29.000Z</published>
    <updated>2019-03-06T05:51:53.735Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å·®å¼‚"><a href="#å·®å¼‚" class="headerlink" title="å·®å¼‚"></a>å·®å¼‚</h3><p>ç›®å‰å¤§éƒ¨åˆ†çš„å‰ç«¯å¼€å‘ç”¨macos/windowsæ¥å¼€å‘ï¼Œlinuxç³»ç»Ÿä½¿ç”¨çš„è¾ƒå°‘ã€‚<br>ä¸€ä¸ªå¤šäººå¼€å‘çš„é¡¹ç›®å¿…ç„¶ä¼šè¦†ç›–windowså’Œunixç³»ç»Ÿã€‚<br>è€Œè¿™ä¸ªä¸¤ä¸ªç³»ç»Ÿé—´å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚</p><p>CRLF, LF éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚ä¸»æµçš„æ“ä½œç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨CRLFæˆ–è€…LFä½œä¸ºå…¶æ–‡æœ¬çš„æ¢è¡Œç¬¦ã€‚<br>CR(Carriage Return) ä»£è¡¨å›è½¦ï¼Œå¯¹åº”å­—ç¬¦ <code>\r</code>ï¼›LF(Line Feed) ä»£è¡¨æ¢è¡Œï¼Œå¯¹åº”å­—ç¬¦ <code>\n</code>ã€‚</p><p>unix/linux(macos)ä½¿ç”¨çš„æ˜¯LFï¼Œwindowsä½¿ç”¨çš„æ˜¯CRLFã€‚</p><p>è·¨å¹³å°åä½œå¼€å‘æ˜¯å¸¸æœ‰çš„ï¼Œä¸ç»Ÿä¸€çš„æ¢è¡Œç¬¦ç¡®å®å¯¹è·¨å¹³å°çš„æ–‡ä»¶äº¤æ¢å¸¦æ¥äº†éº»çƒ¦ã€‚<br>æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¸åŒå¹³å°ä¸Šï¼Œæ¢è¡Œç¬¦å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒGit ä¼šè®¤ä¸ºæ•´ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œè¿™å°±é€ æˆæˆ‘ä»¬ <code>diff</code> ä¸èƒ½æ­£ç¡®åæ˜ æœ¬æ¬¡çš„ä¿®æ”¹ã€‚</p><p>ä¾‹å¦‚åœ¨æŸ¥çœ‹<code>diff</code>çš„æ—¶å€™ï¼Œå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">warning: LF will be replaced by CRLF in .gitignore.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in README.md.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p><a id="more"></a><h3 id="gitå¤„ç†"><a href="#gitå¤„ç†" class="headerlink" title="gitå¤„ç†"></a>gitå¤„ç†</h3><p>è¿˜å¥½ Git åœ¨è®¾è®¡æ—¶å°±è€ƒè™‘äº†è¿™ä¸€ç‚¹ï¼Œæä¾›äº†æ¢è¡Œç¬¦ç›¸å…³çš„å¤„ç†æ–¹å¼ã€‚</p><p>è¿™é‡Œå…ˆæŒ‡å®šä¸¤ä¸ªéå®˜æ–¹çš„æ¦‚å¿µï¼Œæ–¹ä¾¿åé¢è§£é‡Šä¸æè¿°ï¼š(é‡è¦ï¼Œå¦åˆ™åé¢çœ‹ä¸æ‡‚)</p><ol><li><strong>æ ‡å‡†åŒ–</strong> æŒ‡åœ¨æäº¤ä»£ç åˆ°gitæ•°æ®åº“(æœ¬åœ°åº“) ä¸­å°†æ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦CRLFè½¬ä¸ºLFçš„è¿‡ç¨‹</li><li><strong>è½¬æ¢</strong> æŒ‡åœ¨æ£€å‡ºGitæ•°æ®åº“ä»£ç è¿‡ç¨‹ä¸­å°†æ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦LFè½¬æ¢ä¸ºCRLFçš„è¿‡ç¨‹</li></ol><h4 id="core-autocrlf"><a href="#core-autocrlf" class="headerlink" title="core.autocrlf"></a>core.autocrlf</h4><p>gitæä¾›äº†ä¸€ä¸ª <code>autocrlf</code> çš„é…ç½®é¡¹ï¼Œç”¨äºåœ¨æäº¤å’Œæ£€å‡ºæ—¶è‡ªåŠ¨è½¬æ¢æ¢è¡Œç¬¦ï¼Œè¯¥é…ç½®æœ‰ä¸‰ä¸ªå¯é€‰é¡¹ï¼š</p><ul><li>true: æäº¤æ—¶è½¬æ¢ä¸º LFï¼Œæ£€å‡ºæ—¶è½¬æ¢ä¸º CRLF</li><li>false: æäº¤æ£€å‡ºå‡ä¸è½¬æ¢</li><li>input: æäº¤æ—¶è½¬æ¢ä¸ºLFï¼Œæ£€å‡ºæ—¶ä¸è½¬æ¢</li></ul><blockquote><p>CRLF ä¸ LF æ··åˆçš„æ–‡æœ¬æ–‡ä»¶ä¸å—æ­¤é…ç½®æ§åˆ¶ã€‚</p></blockquote><blockquote><p>Git å®‰è£…åé»˜è®¤ä¸º false</p></blockquote><p>æ‰€ä»¥ï¼Œä¸€ç§è§„èŒƒæ¢è¡Œç¬¦çš„æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š</p><p>ä½¿ç”¨ Windows ç³»ç»Ÿçš„å¼€å‘è€…è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.aurocrlf true</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ Linux/MacOS çš„å¼€å‘è€…è®¾ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.autocrlf input</span><br></pre></td></tr></table></figure></p><h4 id="core-safecrlf"><a href="#core-safecrlf" class="headerlink" title="core.safecrlf"></a>core.safecrlf</h4><p>gitåŒæ—¶æä¾›äº†å¦ä¸€ä¸ªé…ç½®é¡¹ <code>safecrlf</code>ï¼Œç”¨äºæ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒ…å«æ··åˆæ¢è¡Œç¬¦ï¼Œè¯¥é…ç½®ä¹Ÿæœ‰ä¸‰ä¸ªå¯é€‰é¡¹ï¼š</p><ul><li>true ç¦æ­¢æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶(git add çš„æ—¶å€™ä¼šè¢«æ‹¦æˆªï¼Œæç¤ºå¼‚å¸¸)</li><li>warn æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶çš„æ—¶å€™å‘å‡ºè­¦å‘Šï¼Œä½†æ˜¯ä¸ä¼šé˜»æ­¢ git add æ“ä½œ</li><li>false ä¸ç¦æ­¢æäº¤æ··åˆæ¢è¡Œç¬¦çš„æ–‡æœ¬æ–‡ä»¶ï¼ˆé»˜è®¤é…ç½®ï¼‰</li></ul><p>è¯¥é…ç½®ç”¨æ¥é˜²æ­¢é”™è¯¯çš„æ ‡å‡†åŒ–ä¸è½¬æ¢ã€‚</p><h4 id="gitattributes-æ–‡ä»¶"><a href="#gitattributes-æ–‡ä»¶" class="headerlink" title=".gitattributes æ–‡ä»¶"></a><code>.gitattributes</code> æ–‡ä»¶</h4><p><code>core.autocrlf</code> çš„é…ç½®ä¾èµ–äºæ¯ä¸€ä½å‚ä¸é¡¹ç›®çš„å¼€å‘æœºå™¨ä¸Šçš„é…ç½®ï¼Œè¿™å¾ˆéš¾ç¡®ä¿æ¯ä¸ªäººéƒ½èƒ½æ­£ç¡®é…ç½®ã€‚<br>äºæ˜¯åœ¨è§„èŒƒé¡¹ç›®ä¸­çš„æ¢è¡Œç¬¦æ–¹é¢ï¼Œè¿˜æœ‰ä¸€å¥—æ·»åŠ é…ç½®æ–‡ä»¶çš„æ–¹æ¡ˆã€‚<br>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹å¯ä»¥æ·»åŠ ä¸€ä¸ª<code>.gitattributes</code> æ–‡ä»¶ã€‚<br>å®ƒçš„ä¼˜å…ˆçº§é«˜äº<code>core.autocrlf</code>çš„è®¾ç½®ï¼Œå¯ä»¥è¦†ç›–<code>core.autocrlf</code>çš„ã€‚<br>å®ƒç±»ä¼¼äº <code>.gitignore</code> æ–‡ä»¶ï¼Œéšæäº¤ä¿®æ”¹ç”Ÿæ•ˆï¼Œä¸€ä¸ªé¡¹ç›®ä¸­å¯ä»¥ç»´æŒä¸€ä»½ç›¸åŒçš„é…ç½®ã€‚<br>æ‰€ä»¥ï¼Œå®ƒèƒ½å¤Ÿé¿å…æ¯ä¸ªå¼€å‘äººå‘˜é…ç½®ä¸åŒçš„é—®é¢˜ã€‚</p><p><code>.gitattributes</code>æ–‡ä»¶çš„åŠŸèƒ½ä¸åªæœ‰é…ç½®æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥å®ƒçš„é…ç½®ç›¸å¯¹å¤æ‚ä¸€ä¸‹ã€‚<br>è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£å¯ä»¥å‚è€ƒ <a href="http://schacon.github.io/git/gitattributes.html" target="_blank" rel="noopener">åœ°å€</a>ã€‚<br>è¿™é‡Œåªé’ˆå¯¹æ¢è¡Œç¬¦çš„é…ç½®åšä¸€ä¸‹ç®€å•çš„ä»‹ç»ï¼š</p><p>æ¯è¡ŒåŸºæœ¬å½¢å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter attr1 attr2 ....</span><br></pre></td></tr></table></figure><p>filter ä»£è¡¨åŒ¹é…æ–‡ä»¶çš„é€šé…ç¬¦ï¼Œåœ¨å®ƒåé¢è·Ÿç€ç›¸åº”çš„å±æ€§ï¼Œç”¨ç©ºæ ¼é—´éš”ã€‚</p><p>filter çš„é€‰é¡¹æ¯”è¾ƒç®€å•ï¼Œå¸¸è§çš„:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* åŒ¹é…æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">*.txt  åŒ¹é…æ–‡ä»¶åä»¥txtç»“å°¾çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>attrçš„é€‰æ‹©æ¯”è¾ƒå¤šï¼Œå…¶ä¸­ä¸æ¢è¡Œç¬¦ç›¸å…³çš„å±æ€§åªæœ‰å‡ æ¡ï¼š</p><ul><li>text<ul><li>text è‡ªåŠ¨å®Œæˆæ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>-text ä¸æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>text=auto æ ¹æ® Git å†³å®šæ˜¯å¦éœ€è¦æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬åŒ–</li><li>ä¸è®¾ç½® ä½¿ç”¨core.autocrlfé…ç½®å†³å®šæ˜¯å¦æ‰§è¡Œæ ‡å‡†åŒ–ä¸è½¬æ¢</li></ul></li><li>eol<ul><li>eol=lf å¼ºåˆ¶å®Œæˆæ ‡å‡†åŒ–ï¼Œä¸æ‰§è¡Œè½¬æ¢ï¼ˆç›¸å½“äºæŒ‡å®šè½¬æ¢ä¸ºLFæ ¼å¼ï¼‰</li><li>eol=crlf å¼ºåˆ¶å®Œæˆæ ‡å‡†åŒ–ï¼ŒæŒ‡å®šè½¬æ¢ä¸ºCRLFæ ¼å¼</li></ul></li><li>binary<ul><li>binary äºŒè¿›åˆ¶æ–‡ä»¶ä¸å‚ä¸æ ‡å‡†åŒ–ä¸è½¬æ¢</li><li>ä¸è®¾ç½® ç”± Git å†³å®šæ˜¯å¦ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</li></ul></li></ul><blockquote><p>text è®¾ç½®çš„æ—¶å€™ï¼Œè½¬æ¢è‡ªåŠ¨è½¬æ¢åˆ°å¯¹åº”å¹³å°çš„æ¢è¡Œç¬¦</p></blockquote><blockquote><p>è¡Œå·é«˜çš„è®¾ç½®ä¼šè¦†ç›–è¡Œå·ä½çš„è®¾ç½®</p></blockquote><p>è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Set the default behavior, in case people don&apos;t have core.autocrlf set.</span><br><span class="line">* text eol=lf</span><br><span class="line"></span><br><span class="line"># Denote all files that are truly binary and should not be modified.</span><br><span class="line">*.png binary</span><br><span class="line">*.jpg binary</span><br></pre></td></tr></table></figure></p><p><strong>æ¨èä½¿ç”¨.gitattributesæ¥è§„èŒƒé¡¹ç›®ä¸­æ¢è¡Œç¬¦ã€‚ç®€å•ï¼Œæ–¹ä¾¿ï¼Œçµæ´»ã€‚</strong></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.jianshu.com/p/ec9564fe1c2b" target="_blank" rel="noopener">ç†è§£ CRLFï¼ŒLF</a></li><li><a href="http://blog.konghy.cn/2017/03/19/git-lf-or-crlf/" target="_blank" rel="noopener">Git å¤šå¹³å°æ¢è¡Œç¬¦é—®é¢˜(LF or CRLF)</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å·®å¼‚&quot;&gt;&lt;a href=&quot;#å·®å¼‚&quot; class=&quot;headerlink&quot; title=&quot;å·®å¼‚&quot;&gt;&lt;/a&gt;å·®å¼‚&lt;/h3&gt;&lt;p&gt;ç›®å‰å¤§éƒ¨åˆ†çš„å‰ç«¯å¼€å‘ç”¨macos/windowsæ¥å¼€å‘ï¼Œlinuxç³»ç»Ÿä½¿ç”¨çš„è¾ƒå°‘ã€‚&lt;br&gt;ä¸€ä¸ªå¤šäººå¼€å‘çš„é¡¹ç›®å¿…ç„¶ä¼šè¦†ç›–windowså’Œunixç³»ç»Ÿã€‚&lt;br&gt;è€Œè¿™ä¸ªä¸¤ä¸ªç³»ç»Ÿé—´å­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;CRLF, LF éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡æœ¬æ¢è¡Œçš„æ–¹å¼ã€‚ä¸»æµçš„æ“ä½œç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨CRLFæˆ–è€…LFä½œä¸ºå…¶æ–‡æœ¬çš„æ¢è¡Œç¬¦ã€‚&lt;br&gt;CR(Carriage Return) ä»£è¡¨å›è½¦ï¼Œå¯¹åº”å­—ç¬¦ &lt;code&gt;\r&lt;/code&gt;ï¼›LF(Line Feed) ä»£è¡¨æ¢è¡Œï¼Œå¯¹åº”å­—ç¬¦ &lt;code&gt;\n&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;unix/linux(macos)ä½¿ç”¨çš„æ˜¯LFï¼Œwindowsä½¿ç”¨çš„æ˜¯CRLFã€‚&lt;/p&gt;
&lt;p&gt;è·¨å¹³å°åä½œå¼€å‘æ˜¯å¸¸æœ‰çš„ï¼Œä¸ç»Ÿä¸€çš„æ¢è¡Œç¬¦ç¡®å®å¯¹è·¨å¹³å°çš„æ–‡ä»¶äº¤æ¢å¸¦æ¥äº†éº»çƒ¦ã€‚&lt;br&gt;æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¸åŒå¹³å°ä¸Šï¼Œæ¢è¡Œç¬¦å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒGit ä¼šè®¤ä¸ºæ•´ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œè¿™å°±é€ æˆæˆ‘ä»¬ &lt;code&gt;diff&lt;/code&gt; ä¸èƒ½æ­£ç¡®åæ˜ æœ¬æ¬¡çš„ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚åœ¨æŸ¥çœ‹&lt;code&gt;diff&lt;/code&gt;çš„æ—¶å€™ï¼Œå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;warning: LF will be replaced by CRLF in .gitignore.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The file will have its original line endings in your working directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;warning: LF will be replaced by CRLF in README.md.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The file will have its original line endings in your working directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="version-control" scheme="https://sampwood.github.io/categories/coding/version-control/"/>
    
    
      <category term="git" scheme="https://sampwood.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>å…¨å±€é…ç½®ESLint</title>
    <link href="https://sampwood.github.io/2019/01/04/%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AEESLint/"/>
    <id>https://sampwood.github.io/2019/01/04/å…¨å±€é…ç½®ESLint/</id>
    <published>2019-01-04T06:23:58.000Z</published>
    <updated>2019-03-06T05:51:53.742Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ESLintæ˜¯ä¸€ä¸ªJavascripté™æ€æ£€æŸ¥å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®ä½ å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œä½¿ä½ çš„javascriptä»£ç è¾¾åˆ°å›½é™…åŒ–çš„æ°´å‡†ã€‚ESLintæ˜¯æ‰€æœ‰Javascrpté™æ€æ£€æŸ¥å·¥å…·é‡Œæœ€æ™šè¯ç”Ÿçš„ä¸€ä¸ªï¼Œä¹‹å‰è¿˜æ›¾ç»æœ‰è¿‡JSLintä»¥åŠJSHintç­‰å·¥å…·ï¼Œä½†JSLintå’ŒJSHintéƒ½æ˜¯ç”¨çš„ä¸€å¥—æ ‡å‡†ï¼Œåœ¨ç›®å‰è¿™ä¸ªå‰ç«¯æŠ€æœ¯é£é€Ÿå‘å±•çš„æ—¶ä»£å·²ç»æ˜¾å¾—æœ‰ç‚¹è½ä¼ã€‚ESLintçš„å¥½å¤„æ˜¯æ—¢æä¾›äº†å›½é™…å¤§å‚çš„æ ‡å‡†ï¼ŒåŒæ—¶åˆç»™äº†ä½ è‡ªå®šä¹‰æ ‡å‡†çš„å¯èƒ½æ€§ã€‚ESLintçš„æ¨èè®¾ç½®æ–¹å¼æ˜¯æŒ‰é¡¹ç›®è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šä¸ªä¸åŒçš„javascripté¡¹ç›®çš„è¯ï¼Œä¸€ä¸ªä¸€ä¸ªå»è®¾ç½®æœªå…å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä»‹ç»çš„æ˜¯å…¨å±€è®¾ç½®æ–¹æ³•ï¼Œä¸€æ¬¡è®¾ç½®ï¼Œæ‰€æœ‰é¡¹ç›®å…¨éƒ¨é‡‡ç”¨åŒä¸€æ ‡å‡†ã€‚</p></blockquote><p>ç›®å‰åœ¨è‡ªå·±çš„æœºå­ä¸Šé¢ç”¨åˆ°çš„eslinté…ç½®æ˜¯ï¼š<code>airbnb</code>+<code>eslint-plugin-vue</code>ã€‚</p><a id="more"></a><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>éœ€è¦å®‰è£…çš„åŒ…æœ‰ï¼š<code>eslint</code>, <code>eslint-config-airbnb-base</code>, <code>eslint-plugin-import</code>, <code>eslint-plugin-vue</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g eslint eslint-config-airbnb-base eslint-plugin-import eslint-plugin-vue</span><br></pre></td></tr></table></figure></p><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>å®‰è£…å¥½ä¾èµ–åŒ…ä¹‹åï¼Œéœ€è¦ç¼–å†™å…¨å±€<code>.eslintrc</code>æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;extends&quot;: [</span><br><span class="line">    &quot;airbnb-base&quot;,</span><br><span class="line">    &quot;plugin:vue/recommended&quot;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦‚æ­¤è¿™èˆ¬ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹jsæ–‡ä»¶ä¸­ä½¿ç”¨åŒä¸€å¥—æ ‡å‡†å»æ£€æŸ¥äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651230875&amp;idx=1&amp;sn=092211db96adfc85a26b457f7e9421a0&amp;chksm=bd494b1f8a3ec20902ad0df7d6a3735b536fe585086abc9035fe24d69549bb4c81cf88658515&amp;mpshare=1&amp;scene=1&amp;srcid=0104C1J16lllbEgkIyFIFJmp#rd" target="_blank" rel="noopener">ã€ç¬¬1495æœŸã€‘ ESLint å·¥ä½œåŸç†æ¢è®¨</a></li><li><a href="https://segmentfault.com/a/1190000005984309" target="_blank" rel="noopener">atomä½¿ç”¨å…¨å±€é…ç½®ESLint</a></li><li><a href="https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb" target="_blank" rel="noopener">airbnb/javascript</a></li><li><a href="https://vuejs.github.io/eslint-plugin-vue/user-guide/" target="_blank" rel="noopener">eslint-plugin-vue</a></li><li><a href="https://github.com/dustinspecker/awesome-eslint" target="_blank" rel="noopener">dustinspecker/awesome-eslint</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ESLintæ˜¯ä¸€ä¸ªJavascripté™æ€æ£€æŸ¥å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®ä½ å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œä½¿ä½ çš„javascriptä»£ç è¾¾åˆ°å›½é™…åŒ–çš„æ°´å‡†ã€‚ESLintæ˜¯æ‰€æœ‰Javascrpté™æ€æ£€æŸ¥å·¥å…·é‡Œæœ€æ™šè¯ç”Ÿçš„ä¸€ä¸ªï¼Œä¹‹å‰è¿˜æ›¾ç»æœ‰è¿‡JSLintä»¥åŠJSHintç­‰å·¥å…·ï¼Œä½†JSLintå’ŒJSHintéƒ½æ˜¯ç”¨çš„ä¸€å¥—æ ‡å‡†ï¼Œåœ¨ç›®å‰è¿™ä¸ªå‰ç«¯æŠ€æœ¯é£é€Ÿå‘å±•çš„æ—¶ä»£å·²ç»æ˜¾å¾—æœ‰ç‚¹è½ä¼ã€‚ESLintçš„å¥½å¤„æ˜¯æ—¢æä¾›äº†å›½é™…å¤§å‚çš„æ ‡å‡†ï¼ŒåŒæ—¶åˆç»™äº†ä½ è‡ªå®šä¹‰æ ‡å‡†çš„å¯èƒ½æ€§ã€‚ESLintçš„æ¨èè®¾ç½®æ–¹å¼æ˜¯æŒ‰é¡¹ç›®è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šä¸ªä¸åŒçš„javascripté¡¹ç›®çš„è¯ï¼Œä¸€ä¸ªä¸€ä¸ªå»è®¾ç½®æœªå…å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä»‹ç»çš„æ˜¯å…¨å±€è®¾ç½®æ–¹æ³•ï¼Œä¸€æ¬¡è®¾ç½®ï¼Œæ‰€æœ‰é¡¹ç›®å…¨éƒ¨é‡‡ç”¨åŒä¸€æ ‡å‡†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›®å‰åœ¨è‡ªå·±çš„æœºå­ä¸Šé¢ç”¨åˆ°çš„eslinté…ç½®æ˜¯ï¼š&lt;code&gt;airbnb&lt;/code&gt;+&lt;code&gt;eslint-plugin-vue&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linter" scheme="https://sampwood.github.io/categories/coding/linter/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
      <category term="eslint" scheme="https://sampwood.github.io/tags/eslint/"/>
    
  </entry>
  
  <entry>
    <title>wslåˆä½“éªŒ</title>
    <link href="https://sampwood.github.io/2018/12/29/wsl%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <id>https://sampwood.github.io/2018/12/29/wslåˆä½“éªŒ/</id>
    <published>2018-12-29T08:04:52.000Z</published>
    <updated>2019-03-06T05:51:53.742Z</updated>
    
    <content type="html"><![CDATA[<p>wsl, å°±æ˜¯Windows Subsystem for Linux, ç®€å•çš„è¯´ WSL å°±æ˜¯è®©å¼€å‘è€…åœ¨ Windows ä¸Šæ— éœ€è™šæ‹Ÿæœºå°±å¯ä»¥æ­å»ºä¸€å¥— Linux å¼€å‘ç¯å¢ƒã€‚</p><p>ä½¿ç”¨ WSL çš„å¥½å¤„æ˜¯ï¼š</p><ol><li>æœ€ä¸»è¦çš„ä¸€ç‚¹ï¼Œä½ å¯ä»¥å¿«é€Ÿçš„å¼€å¯ Linux ç¯å¢ƒï¼Œä¹‹å‰æˆ‘çš„åšæ³•æ˜¯å¼€å¯è™šæ‹Ÿå™¨ï¼Œå ç”¨èµ„æºå¤šè€Œä¸”æ‰“å¼€æ…¢ã€‚</li><li>é€šè¿‡ windowå•†åº— é€‰æ‹©å¤šç§ Linux å‘è¡Œç‰ˆï¼Œç›®å‰æ”¯æŒ Ubuntu(16.04 LTS)ã€openSUSE Leap 42ã€ SUSE Linux Enterprise Serverã€‚</li><li>ä½¿ç”¨ Linux å‘½ä»¤è¡Œå·¥å…·å¤„ç†ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ sed, awk ç­‰ã€‚</li><li>ä½¿ç”¨ Linux å†…ç½®åŒ…ç®¡ç†å™¨å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œä¾‹å¦‚ git redis ç­‰ï¼ŒåŸºæœ¬ä¸Šä¸€æ¡å‘½ä»¤å°±èƒ½å®‰è£…å¥½ã€‚</li></ol><a id="more"></a><h3 id="å®‰è£…WSL"><a href="#å®‰è£…WSL" class="headerlink" title="å®‰è£…WSL"></a>å®‰è£…WSL</h3><ol><li><p>æ§åˆ¶é¢æ¿ -&gt; ç¨‹åº -&gt; å¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½ -&gt; å‹¾é€‰ é€‚ç”¨Linuxçš„Windowså­ç³»ç»Ÿ ï¼ˆæˆ‘æ˜¯ç§‹å­£åˆ›é€ è€…æ›´æ–°ç‰ˆæœ¬ï¼Œæˆ‘è®°å¾—ä¹‹å‰ä½ç‰ˆæœ¬å¯èƒ½æ˜¯ beta ç‰ˆæœ¬ï¼‰</p><p><img src="..\images\wsl.jpg" alt="\images\wsl"></p></li><li><p>æ‰“å¼€ windowå•†åº—ï¼Œé€‰æ‹©åˆé€‚çš„ Linux å‘è¡Œç‰ˆå®‰è£… (è¿™é‡Œæœç´¢Linux æ ¹æ®ä¸‹é¢ç¬¬ä¸€ä¸ªsuggestion è¿›å…¥)ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº† Ubuntu</p></li><li><p>é‡å¯ç”µè„‘ã€‚æ‰“å¼€ Ubuntu ï¼Œç¬¬ä¸€æ¬¡éœ€è¦ç­‰å¾…ä¸€ä¼šï¼Œè®¾ç½®è´¦å·å¯†ç </p></li></ol><p>å¦‚æ­¤ï¼Œwslå°±å®‰è£…å¥½äº†ï¼Œå¯ä»¥ä½¿ç”¨ubuntuçš„å‘½ä»¤è¡Œå•¦~~</p><h3 id="é…ç½®å‘½ä»¤è¡Œ"><a href="#é…ç½®å‘½ä»¤è¡Œ" class="headerlink" title="é…ç½®å‘½ä»¤è¡Œ"></a>é…ç½®å‘½ä»¤è¡Œ</h3><p>æ—¢ç„¶å¯ä»¥ä½¿ç”¨ubuntuçš„bashï¼Œæˆ‘ä»¬å°±å¯ä»¥é…ç½®bashï¼Œæ¥è®©æˆ‘ä»¬çš„æ“ä½œæ›´èˆ’é€‚ã€‚</p><p>ä¾‹å¦‚å®‰è£…zsh+Oh My ZSHï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zsh -y</span><br><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure><p>è®©å‘½ä»¤è¡Œé«˜äº®çš„æ’ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure></p><p>æ¿€æ´»è¿™ä¸ªæ’<code>~/.zshrc</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plugins=( [plugins...] zsh-syntax-highlighting)</span><br><span class="line">source ~/.zshrc</span><br></pre></td></tr></table></figure></p><p>ä¸ºäº†è®©æŸäº›themeèƒ½åœ¨windowsä¸‹æ­£å¸¸æ˜¾ç¤ºï¼Œè¿˜è¦å®‰è£…<code>Powerline</code>å­—ä½“ï¼Œä¾‹å¦‚æˆ‘å°±å®‰è£…äº†<code>DejaVu Sans Mono for Powerline</code> å­—ä½“ã€‚<br>å®‰è£…å­—ä½“ä¹‹åï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œçª—å£è®¾ç½®å­—ä½“äº†ï¼Œè®¾ç½®ä¹‹åæ˜¾ç¤ºå°±æ­£å¸¸äº†ã€‚</p><p>å®‰è£…<code>Powerline</code>å­—ä½“ï¼Œå‚è€ƒï¼š<a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">https://github.com/powerline/fonts</a></p><h4 id="zshé…ç½®æ–‡ä»¶-zshrc"><a href="#zshé…ç½®æ–‡ä»¶-zshrc" class="headerlink" title="zshé…ç½®æ–‡ä»¶.zshrc"></a>zshé…ç½®æ–‡ä»¶<code>.zshrc</code></h4><p>ç›®å‰ä½¿ç”¨çš„ä¸»é¢˜æ˜¯<code>amuse</code>ï¼Œä¹Ÿè‡ªå®šä¹‰äº†ä¸€äº›å‘½ä»¤:</p><ul><li>gcb: git_get_branch æŸ¥çœ‹å½“å‰åˆ†æ”¯å</li><li>gpg: git_push_gerrit æŠŠå½“å‰åˆ†æ”¯çš„å†…å®¹æ¨é€åˆ°gerritçš„ç›¸åŒåˆ†æ”¯ä¸Š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"># If you come from bash you might have to change your $PATH.</span><br><span class="line"># export PATH=$HOME/bin:/usr/local/bin:$PATH</span><br><span class="line"></span><br><span class="line"># Path to your oh-my-zsh installation.</span><br><span class="line">  export ZSH=&quot;/home/sam/.oh-my-zsh&quot;</span><br><span class="line"></span><br><span class="line"># Set name of the theme to load --- if set to &quot;random&quot;, it will</span><br><span class="line"># load a random theme each time oh-my-zsh is loaded, in which case,</span><br><span class="line"># to know which specific one was loaded, run: echo $RANDOM_THEME</span><br><span class="line"># See https://github.com/robbyrussell/oh-my-zsh/wiki/Themes</span><br><span class="line">ZSH_THEME=&quot;amuse&quot;</span><br><span class="line"></span><br><span class="line"># Set list of themes to pick from when loading at random</span><br><span class="line"># Setting this variable when ZSH_THEME=random will cause zsh to load</span><br><span class="line"># a theme from this variable instead of looking in ~/.oh-my-zsh/themes/</span><br><span class="line"># If set to an empty array, this variable will have no effect.</span><br><span class="line"># ZSH_THEME_RANDOM_CANDIDATES=( &quot;robbyrussell&quot; &quot;agnoster&quot; )</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to use case-sensitive completion.</span><br><span class="line"># CASE_SENSITIVE=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to use hyphen-insensitive completion.</span><br><span class="line"># Case-sensitive completion must be off. _ and - will be interchangeable.</span><br><span class="line"># HYPHEN_INSENSITIVE=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to disable bi-weekly auto-update checks.</span><br><span class="line"># DISABLE_AUTO_UPDATE=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to change how often to auto-update (in days).</span><br><span class="line"># export UPDATE_ZSH_DAYS=13</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to disable colors in ls.</span><br><span class="line"># DISABLE_LS_COLORS=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to disable auto-setting terminal title.</span><br><span class="line"># DISABLE_AUTO_TITLE=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to enable command auto-correction.</span><br><span class="line"># ENABLE_CORRECTION=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line to display red dots whilst waiting for completion.</span><br><span class="line"># COMPLETION_WAITING_DOTS=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line if you want to disable marking untracked files</span><br><span class="line"># under VCS as dirty. This makes repository status check for large repositories</span><br><span class="line"># much, much faster.</span><br><span class="line"># DISABLE_UNTRACKED_FILES_DIRTY=&quot;true&quot;</span><br><span class="line"></span><br><span class="line"># Uncomment the following line if you want to change the command execution time</span><br><span class="line"># stamp shown in the history command output.</span><br><span class="line"># You can set one of the optional three formats:</span><br><span class="line"># &quot;mm/dd/yyyy&quot;|&quot;dd.mm.yyyy&quot;|&quot;yyyy-mm-dd&quot;</span><br><span class="line"># or set a custom format using the strftime function format specifications,</span><br><span class="line"># see &apos;man strftime&apos; for details.</span><br><span class="line"># HIST_STAMPS=&quot;mm/dd/yyyy&quot;</span><br><span class="line"></span><br><span class="line"># Would you like to use another custom folder than $ZSH/custom?</span><br><span class="line"># ZSH_CUSTOM=/path/to/new-custom-folder</span><br><span class="line"></span><br><span class="line"># Which plugins would you like to load?</span><br><span class="line"># Standard plugins can be found in ~/.oh-my-zsh/plugins/*</span><br><span class="line"># Custom plugins may be added to ~/.oh-my-zsh/custom/plugins/</span><br><span class="line"># Example format: plugins=(rails git textmate ruby lighthouse)</span><br><span class="line"># Add wisely, as too many plugins slow down shell startup.</span><br><span class="line">plugins=(</span><br><span class="line">  git,</span><br><span class="line">  zsh-syntax-highlighting</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">source $ZSH/oh-my-zsh.sh</span><br><span class="line"></span><br><span class="line"># User configuration</span><br><span class="line"></span><br><span class="line"># export MANPATH=&quot;/usr/local/man:$MANPATH&quot;</span><br><span class="line"></span><br><span class="line"># You may need to manually set your language environment</span><br><span class="line"># export LANG=en_US.UTF-8</span><br><span class="line"></span><br><span class="line"># Preferred editor for local and remote sessions</span><br><span class="line"> if [[ -n $SSH_CONNECTION ]]; then</span><br><span class="line">   export EDITOR=&apos;vim&apos;</span><br><span class="line"> else</span><br><span class="line">   export EDITOR=&apos;mvim&apos;</span><br><span class="line"> fi</span><br><span class="line"></span><br><span class="line"># Compilation flags</span><br><span class="line"># export ARCHFLAGS=&quot;-arch x86_64&quot;</span><br><span class="line"></span><br><span class="line"># ssh</span><br><span class="line"># export SSH_KEY_PATH=&quot;~/.ssh/rsa_id&quot;</span><br><span class="line"></span><br><span class="line"># Set personal aliases, overriding those provided by oh-my-zsh libs,</span><br><span class="line"># plugins, and themes. Aliases can be placed here, though oh-my-zsh</span><br><span class="line"># users are encouraged to define aliases within the ZSH_CUSTOM folder.</span><br><span class="line"># For a full list of active aliases, run `alias`.</span><br><span class="line">#</span><br><span class="line"># Example aliases</span><br><span class="line"># alias zshconfig=&quot;mate ~/.zshrc&quot;</span><br><span class="line"># alias ohmyzsh=&quot;mate ~/.oh-my-zsh&quot;</span><br><span class="line">alias cdcode=&quot;cd /mnt/d/code&quot;</span><br><span class="line"></span><br><span class="line">function git_get_branch &#123;</span><br><span class="line">  br=`git branch | grep &quot;*&quot;`</span><br><span class="line">  echo $&#123;br/* /&#125;</span><br><span class="line">&#125;</span><br><span class="line">alias gcb=&quot;git_get_branch&quot;</span><br><span class="line">function git_push_gerrit &#123;</span><br><span class="line">  GIT_CURRENT_BRANCH=`git_get_branch`</span><br><span class="line">  echo Current branch is $GIT_CURRENT_BRANCH</span><br><span class="line">  `git push origin HEAD:refs/for/$GIT_CURRENT_BRANCH`</span><br><span class="line">&#125;</span><br><span class="line">alias gpg=&quot;git_push_gerrit&quot;</span><br></pre></td></tr></table></figure><h3 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h3><ol><li>sublimeæ•´åˆeslintæ—¶ï¼Œå¦‚æœæ˜¯ç”¨wslæ¥å®‰è£…npmä¾èµ–ï¼Œnode_modulesæ–‡ä»¶å¤¹ä¸‹çš„.binæ–‡ä»¶å¤¹ä¸ä¼šå‡ºç°*.cmdæ–‡ä»¶ï¼Œè¿™å°±ä¼šå½±å“eslintçš„è¿è¡Œ</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.cnblogs.com/javanoob/p/wsl.html" target="_blank" rel="noopener">ä¸‰æµç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»</a></li><li><a href="https://www.jianshu.com/p/b147735ff3f2" target="_blank" rel="noopener">è°ƒæ•™ä½ çš„WSLç»ˆç«¯</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;wsl, å°±æ˜¯Windows Subsystem for Linux, ç®€å•çš„è¯´ WSL å°±æ˜¯è®©å¼€å‘è€…åœ¨ Windows ä¸Šæ— éœ€è™šæ‹Ÿæœºå°±å¯ä»¥æ­å»ºä¸€å¥— Linux å¼€å‘ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ WSL çš„å¥½å¤„æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœ€ä¸»è¦çš„ä¸€ç‚¹ï¼Œä½ å¯ä»¥å¿«é€Ÿçš„å¼€å¯ Linux ç¯å¢ƒï¼Œä¹‹å‰æˆ‘çš„åšæ³•æ˜¯å¼€å¯è™šæ‹Ÿå™¨ï¼Œå ç”¨èµ„æºå¤šè€Œä¸”æ‰“å¼€æ…¢ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ windowå•†åº— é€‰æ‹©å¤šç§ Linux å‘è¡Œç‰ˆï¼Œç›®å‰æ”¯æŒ Ubuntu(16.04 LTS)ã€openSUSE Leap 42ã€ SUSE Linux Enterprise Serverã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Linux å‘½ä»¤è¡Œå·¥å…·å¤„ç†ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ sed, awk ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Linux å†…ç½®åŒ…ç®¡ç†å™¨å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œä¾‹å¦‚ git redis ç­‰ï¼ŒåŸºæœ¬ä¸Šä¸€æ¡å‘½ä»¤å°±èƒ½å®‰è£…å¥½ã€‚&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linux" scheme="https://sampwood.github.io/categories/coding/linux/"/>
    
    
      <category term="linux" scheme="https://sampwood.github.io/tags/linux/"/>
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>gitlab-ciåŸºç¡€é…ç½®</title>
    <link href="https://sampwood.github.io/2018/10/31/gitlab-ci%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/"/>
    <id>https://sampwood.github.io/2018/10/31/gitlab-ciåŸºç¡€é…ç½®/</id>
    <published>2018-10-31T12:54:34.000Z</published>
    <updated>2019-03-06T06:48:15.664Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å†™è¿‡ä¸€ä¸ªâ€œåœ¨vpsä¸Šæ­å»ºä¸€ä¸ªgitä»“åº“å¹¶å®ç°ä»£ç æäº¤ä¹‹åè‡ªåŠ¨éƒ¨ç½²åˆ°nginxä¸Šâ€ï¼Œ<br>ä½†æ˜¯è¿™ä¸ªéœ€è¦è‡ªå·±å»ç»´æŠ¤<code>git hook</code>é’©å­è§¦å‘çš„è„šæœ¬ï¼Œè€Œä¸”æ¯æ¬¡pushä¹‹åéƒ½åªèƒ½åœ¨æœ¬åœ°çš„terminalä¸­çœ‹åˆ°è„šæœ¬çš„æ‰§è¡Œæƒ…å†µã€‚<br>å…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>gitlab-ci</code>æ¥å®Œæˆæˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚<br><a id="more"></a></p><h3 id="ä½¿ç”¨gitlab"><a href="#ä½¿ç”¨gitlab" class="headerlink" title="ä½¿ç”¨gitlab"></a>ä½¿ç”¨gitlab</h3><p>ä½¿ç”¨<code>gitlab-ci</code>æ¥å®Œæˆè‡ªåŠ¨éƒ¨ç½²çš„ç¬¬ä¸€æ­¥å½“ç„¶æ˜¯ä½¿ç”¨gitlabã€‚<br>å½“ç„¶å¯ä»¥è‡ªå·±æ­å»ºgitlabä»“åº“ï¼Œä¸è¿‡æˆ‘ç”¨äº†å®˜æ–¹ <a href="https://gitlab.com" target="_blank" rel="noopener">gitlab</a></p><h4 id="åˆ›å»ºè‡ªå·±çš„é¡¹ç›®"><a href="#åˆ›å»ºè‡ªå·±çš„é¡¹ç›®" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„é¡¹ç›®"></a>åˆ›å»ºè‡ªå·±çš„é¡¹ç›®</h4><p>é¡µé¢ä¸Šç‚¹å‡»<code>New project</code>ï¼Œç„¶åè¾“å…¥é¡¹ç›®åç§°å°±okäº†ã€‚</p><h4 id="é…ç½®-gitlab-ci-ymlæ–‡ä»¶"><a href="#é…ç½®-gitlab-ci-ymlæ–‡ä»¶" class="headerlink" title="é…ç½®.gitlab-ci.ymlæ–‡ä»¶"></a>é…ç½®<code>.gitlab-ci.yml</code>æ–‡ä»¶</h4><p>è¦ä½¿ç”¨<code>gitlab-ci</code>ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­é…ç½®<code>.gitlab-ci.yml</code>æ–‡ä»¶ã€‚</p><p>å…³äºè¿™ä¸ªæ–‡ä»¶çš„ç¼–å†™è§„åˆ™å¯ä»¥å‚è€ƒï¼š<a href="https://docs.gitlab.com/ee/ci/yaml/README.html" target="_blank" rel="noopener">Configuration of your jobs with .gitlab-ci.yml</a></p><p>ç®€è¿°ä¸‹æˆ‘çš„ç†è§£ï¼š</p><ul><li>å…¨å±€å…³é”®å­—ï¼š<ul><li>imageï¼šæŒ‡å®šç‰¹å®šçš„è¿è¡Œç‰ˆæœ¬ï¼›ä¾‹å¦‚<code>image: node:latest</code></li><li>stagesï¼šå®šä¹‰å°†è¢«ä½¿ç”¨çš„è¿è¡Œé˜¶æ®µï¼›ä¸€èˆ¬åˆ†ä¸ºä¸‰æ®µï¼š<code>build</code>, <code>test</code>, <code>deploy</code>ï¼›å¦‚æœæœªå®šä¹‰é‚£è¿™ä¸‰ä¸ªéƒ½ç›¸å½“äºå­˜åœ¨ï¼›é˜¶æ®µçš„é¡ºåºæ˜¯ä»<code>build</code>åˆ°<code>test</code>åˆ°<code>deploy</code>ï¼›ç›¸åŒé˜¶æ®µçš„<code>job</code>ä¼šå¹¶è¡Œæ‰§è¡Œï¼›å‰ä¸€é˜¶æ®µé”™è¯¯å°†ç›´æ¥æŠŠ<code>commit</code>æ ‡è®°ä¸º<code>failed</code>å¹¶ä¸”ä¸­æ–­åç»­<code>job</code>çš„æ‰§è¡Œï¼›</li><li>cacheï¼š æŒ‡æ˜åœ¨æ‰€æœ‰<code>job</code>ä¹‹é—´çš„é»˜è®¤çš„å…±äº«æ–‡ä»¶ã€æ–‡ä»¶å¤¹;å¦‚æœ<code>job</code>é…ç½®äº†<code>cache</code>ï¼Œåˆ™ä¼šä½¿ç”¨é…ç½®çš„<code>cache</code>ï¼Œå¿½ç•¥å…¨å±€çš„<code>cache</code></li></ul></li><li><code>job</code>å†…éƒ¨å…³é”®å­—<ul><li>stageï¼šå®šä¹‰å½“å‰<code>job</code>æ‰€åœ¨çš„é˜¶æ®µï¼›å€¼ä»å…¨å±€<code>stages</code>é‡Œé¢å–ä¸€ä¸ª</li><li>scriptï¼šå®šä¹‰è¦æ‰§è¡Œçš„è„šæœ¬ï¼›å¯ä»¥å¤šä¸ªï¼Œæ¯ä¸ªå¦èµ·ä¸€è¡Œç”¨<code>-</code>å¼€å¤´ï¼›ï¼ˆæ¯ä¸ª<code>job</code>éƒ½å¿…é¡»å­˜åœ¨<code>script</code>ï¼‰</li><li>tagsï¼šç”¨æ¥çŸ¥åç‰¹å®šçš„<code>Runner</code>æ¥è·‘å½“å‰<code>job</code>ï¼ˆå¾ˆå…³é”®ï¼Œå¼„å¾ˆä¹…æ‰çŸ¥é“è¿™ä¸ªæ˜¯æœ€é‡è¦çš„ï¼Œä¸ç„¶pipelinesä¼šä¸€ç›´å¤„äºpendingçŠ¶æ€ï¼Œå› ä¸ºæ²¡æœ‰ç‰¹å®šçš„runneræ¥æ‰§è¡Œè¿™ä¸ªjobï¼‰</li><li>onlyï¼šåˆ†æ”¯åï¼ˆæŒ‡æ˜é‚£ä¸ªåˆ†æ”¯ä¼šè·‘å½“å‰<code>job</code>ï¼‰</li><li>exceptï¼šåˆ†æ”¯åï¼ˆæŒ‡æ˜é‚£ä¸ªåˆ†æ”¯<strong>ä¸</strong>è·‘å½“å‰<code>job</code>ï¼‰</li><li>cacheï¼šæŒ‡æ˜åœ¨ä¸åŒ<code>job</code>ä¹‹é—´çš„å…±äº«æ–‡ä»¶ã€æ–‡ä»¶å¤¹;<ul><li>pathsï¼šç›®å½•ï¼›å¯ä»¥å¤šä¸ªï¼Œæ¯ä¸ªå¦èµ·ä¸€è¡Œç”¨<code>-</code>å¼€å¤´ï¼›</li><li>keyï¼šå¦‚æœä½ åœ¨ä¸åŒçš„<code>job</code>å…±äº«äº†ä¸åŒçš„ç›®å½•ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦keyæ¥é˜²æ­¢cacheè¢«è¦†ç›–</li><li>untrackedï¼šè®¾ç½®æ˜¯å¦ç¼“å­˜æœªæ·»åŠ åˆ°gitç®¡ç†çš„æ–‡ä»¶</li><li>policyï¼šé»˜è®¤çš„<code>policy</code>æ˜¯<code>pull-push</code>çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨<code>job</code>æ‰§è¡Œå‰ä¸‹æ‹‰ç¼“å­˜ï¼Œç»“æŸåä¿å­˜ç¼“å­˜ï¼›å¯ä»¥è®¾ç½®æˆ<code>pull</code>ï¼Œæ—¢åªè¯»å–ç¼“å­˜</li></ul></li><li>artifactsï¼šæŒ‡æ˜åœ¨<code>job</code>æˆåŠŸå®Œæˆä¹‹åå¯ä»¥åœ¨gitlabä¸Šé¢ä¸‹è½½åˆ°çš„æ–‡ä»¶ï¼ˆæ„æ€å°±æ˜¯ï¼šæŒ‡å®šçš„æ–‡ä»¶ä¼šè¢«ä¸Šä¼ åˆ°gitlabï¼Œç„¶åå¯ä»¥åœ¨<br>å½“å‰<code>Pipeline</code>ä¸­ä¸‹è½½è¿™äº›æ–‡ä»¶ï¼‰<ul><li>pathsï¼šæŒ‡å®šä¸Šä¼ çš„ç›®å½•ï¼›å¯ä»¥å¤šä¸ªï¼Œæ¯ä¸ªå¦èµ·ä¸€è¡Œç”¨</li></ul></li><li>dependenciesï¼šåº”è¯¥å’Œ<code>artifacts</code>ä¸€èµ·ä½¿ç”¨ï¼Œæ¥åœ¨ä¸åŒçš„<code>job</code>é—´å…±äº«<code>artifacts</code>æ–‡ä»¶ã€‚ï¼ˆåŸç†æ˜¯ï¼ŒæŸä¸ª<code>job</code>é…ç½®äº†<code>artifacts</code>ä¹‹åï¼Œ<code>job</code>å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šæŠŠå¯¹åº”çš„æ–‡ä»¶ä¸Šä¼ åˆ°gitlabï¼›åŒæ—¶ï¼Œé…ç½®äº†<code>dependencies</code>çš„<code>job</code>ä¼šåœ¨è„šæœ¬æ‰§è¡Œå‰å»gitlabä¸‹è½½å¯¹åº”çš„<code>job</code>çš„<code>artifacts</code>æ–‡ä»¶ï¼‰ï¼›å½“ç„¶ï¼Œä¾èµ–åªèƒ½æŒ‰ç…§<code>stages</code>è¿è¡Œé˜¶æ®µæ¥ä¾èµ–å‰ä¸€ä¸ªé˜¶æ®µçš„<code>job</code></li></ul></li></ul><p>è¿™é‡Œè´´ä¸€ä¸ªç®€å•çš„demoï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">image: node:latest</span><br><span class="line"></span><br><span class="line">cache:</span><br><span class="line">  paths:</span><br><span class="line">    - node_modules</span><br><span class="line"></span><br><span class="line">prepare:</span><br><span class="line">  stage: build</span><br><span class="line">  tags:</span><br><span class="line">    - build</span><br><span class="line">  script:</span><br><span class="line">    - npm install</span><br><span class="line">  only:</span><br><span class="line">    - master</span><br><span class="line"></span><br><span class="line">testCache:</span><br><span class="line">  stage: test</span><br><span class="line">  tags:</span><br><span class="line">    - build</span><br><span class="line">  script:</span><br><span class="line">    - cd node_modules</span><br><span class="line">    - pwd</span><br><span class="line">  only:</span><br><span class="line">    - master</span><br><span class="line"></span><br><span class="line">production:</span><br><span class="line">  stage: deploy</span><br><span class="line">  tags:</span><br><span class="line">    - build</span><br><span class="line">  script:</span><br><span class="line">    - npm run build</span><br><span class="line">    - mkdir .public</span><br><span class="line">    - cp -r dist/* .public</span><br><span class="line">    - mv .public public</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">      - public</span><br><span class="line">  only:</span><br><span class="line">    - master</span><br></pre></td></tr></table></figure></p><p>åˆ°è¿™ï¼Œgitlabä¸Šçš„é…ç½®å°±åŸºæœ¬OKäº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å»æœåŠ¡å™¨ä¸Šå®‰è£…<code>gitlab-runner</code>æ¥è¿è¡Œæˆ‘ä»¬å®šä¹‰çš„<code>job</code>äº†ã€‚</p><h3 id="ä½¿ç”¨gitlab-runner"><a href="#ä½¿ç”¨gitlab-runner" class="headerlink" title="ä½¿ç”¨gitlab-runner"></a>ä½¿ç”¨gitlab-runner</h3><p>å…¶å®å…·ä½“çš„å®‰è£…å’Œä½¿ç”¨è¯´æ˜ï¼Œåœ¨gitlabä¸Šæœ‰å¾ˆè¯¦ç»†çš„æ–‡æ¡£ã€‚</p><p>åœ¨é¡¹ç›®é¦–é¡µï¼Œç‚¹å‡»å·¦ä¾§<code>setting</code>é‡Œé¢çš„äºŒçº§èœå•<code>CI / CD</code>ã€‚æ‰¾åˆ°<code>Runners</code>ï¼Œç‚¹å‡»å³è¾¹çš„<code>Expand</code>æŒ‰é’®ã€‚<br>æ‰¾åˆ°ä¸‹é¢<code>Set up a specific Runner manually</code>çš„æ–‡æ¡£ã€‚</p><p><img src="/images/gitlab-ci.png" alt="gitlab-ci"></p><p><strong>Note</strong>ï¼šä¹Ÿå¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„å†…å®¹ã€‚</p><h4 id="å®‰è£…gitlab-runner"><a href="#å®‰è£…gitlab-runner" class="headerlink" title="å®‰è£…gitlab-runner"></a>å®‰è£…gitlab-runner</h4><p>è¿™é‡Œæ˜¯åœ¨linuxä¸Šå®‰è£…gitlab-runnerã€‚</p><ol><li><p>ä¸‹è½½åˆé€‚çš„ç‰ˆæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Linux x86-64</span><br><span class="line"> sudo wget -O /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64</span><br><span class="line"></span><br><span class="line"> # Linux x86</span><br><span class="line"> sudo wget -O /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-386</span><br><span class="line"></span><br><span class="line"> # Linux arm</span><br><span class="line"> sudo wget -O /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-arm</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹æ‰§è¡Œæƒé™ï¼š <code>sudo chmod +x /usr/local/bin/gitlab-runner</code></p></li><li>åˆ›å»ºGitlab CIç”¨æˆ·ï¼š<code>sudo useradd --comment &#39;GitLab Runner&#39; --create-home gitlab-runner --shell /bin/bash</code></li><li><p>å®‰è£…å’Œè¿è¡ŒæœåŠ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-runner install --user=gitlab-runner --working-directory=/home/gitlab-runner</span><br><span class="line">sudo gitlab-runner start</span><br></pre></td></tr></table></figure></li><li><p>æ³¨å†ŒRunnerï¼š <code>sudo gitlab-runner register</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com )</span><br><span class="line">https://gitlab.com</span><br><span class="line"></span><br><span class="line">Please enter the gitlab-ci token for this runner</span><br><span class="line">xxx (PS: å°±æ˜¯åœ¨ã€Set up a specific Runner manuallyã€‘çš„æ–‡æ¡£ä¸­çš„registration token)</span><br><span class="line"></span><br><span class="line">Please enter the gitlab-ci description for this runner</span><br><span class="line">[hostame] my-runner</span><br><span class="line"></span><br><span class="line">Please enter the gitlab-ci tags for this runner (comma separated):</span><br><span class="line">my-tag,another-tag (PS: è¿™ä¸ªæ˜¯æœ€å…³é”®çš„ï¼Œè¿™ä¸ªtagå’Œjobä¸­çš„tagsè¦å¯¹åº”æ‰èƒ½èµ·ä½œç”¨ï¼ï¼ï¼å½“ç„¶ä½ å¯ä»¥åœ¨gitlabä¸­æŒ‡å®šå®ƒä¸å»åŒ¹é…)</span><br><span class="line"></span><br><span class="line">...successful</span><br></pre></td></tr></table></figure></li></ol><p><strong>Note</strong>: è¿˜æ˜¯ä¸€å¥è¯ï¼Œæ³¨å†ŒRunneræ—¶è¾“å…¥çš„tagè¦å’Œ<code>.gitlab-ci.yml</code>æ–‡ä»¶ä¸­<code>job</code>çš„<code>tags</code>å¯¹åº”èµ·æ¥ã€‚</p><p>åˆ°è¿™é‡Œï¼Œgitlab-ciå°±å¯ä»¥ä½¿ç”¨äº†ã€‚æäº¤ä¸€æ¬¡è¯•è¯•~~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰å†™è¿‡ä¸€ä¸ªâ€œåœ¨vpsä¸Šæ­å»ºä¸€ä¸ªgitä»“åº“å¹¶å®ç°ä»£ç æäº¤ä¹‹åè‡ªåŠ¨éƒ¨ç½²åˆ°nginxä¸Šâ€ï¼Œ&lt;br&gt;ä½†æ˜¯è¿™ä¸ªéœ€è¦è‡ªå·±å»ç»´æŠ¤&lt;code&gt;git hook&lt;/code&gt;é’©å­è§¦å‘çš„è„šæœ¬ï¼Œè€Œä¸”æ¯æ¬¡pushä¹‹åéƒ½åªèƒ½åœ¨æœ¬åœ°çš„terminalä¸­çœ‹åˆ°è„šæœ¬çš„æ‰§è¡Œæƒ…å†µã€‚&lt;br&gt;å…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;gitlab-ci&lt;/code&gt;æ¥å®Œæˆæˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linux" scheme="https://sampwood.github.io/categories/coding/linux/"/>
    
    
      <category term="linux" scheme="https://sampwood.github.io/tags/linux/"/>
    
      <category term="git" scheme="https://sampwood.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>sublimeä½¿ç”¨</title>
    <link href="https://sampwood.github.io/2018/10/26/sublime%E4%BD%BF%E7%94%A8/"/>
    <id>https://sampwood.github.io/2018/10/26/sublimeä½¿ç”¨/</id>
    <published>2018-10-26T09:23:43.000Z</published>
    <updated>2019-07-30T02:16:59.697Z</updated>
    
    <content type="html"><![CDATA[<p>å› ä¸ºå–œæ¬¢sublimeçš„é…è‰²ï¼Œæ‰€ä»¥ä¸€ç›´éƒ½ä½¿ç”¨sublimeæ¥å¼€å‘å‰ç«¯ä»£ç ã€‚<br>ä¸‹é¢è®°å½•ä¸€äº›å¸¸ç”¨çš„é…ç½®ã€‚</p><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>å®˜ç½‘ä¸‹è½½ï¼š <a href="http://www.sublimetext.com/" target="_blank" rel="noopener">http://www.sublimetext.com/</a></p><p>ç„¶åå°±æ˜¯å®‰è£…<code>package control</code>: <a href="https://packagecontrol.io/installation" target="_blank" rel="noopener">https://packagecontrol.io/installation</a></p><a id="more"></a><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3><ul><li>A File Icon</li><li>AutoFileName</li><li>BracketHighlighter</li><li>DocBlockr</li><li>Emmet</li><li>Git</li><li>GitGutter</li><li>JS Snippets</li><li>JsFormat</li><li>LESS</li><li>MarkdownPreview</li><li>ProjectManager</li><li>SideBarEnhancements</li><li>SublimeCodeIntel</li><li>SublimeLinter</li><li>SublimeLinter-eslint</li><li>SublimeServer</li><li>Termial</li><li>Vue Svntax Highlight</li><li>cssrem: è‡ªåŠ¨è®¡ç®—pxè½¬åŒ–ä¸ºremï¼ˆé¡¹ç›®åœ°å€ï¼š<code>https://github.com/flashlizi/cssrem</code>ï¼Œæ‰‹åŠ¨ä¸‹è½½ï¼‰</li></ul><h3 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  // åˆ‡æ¢Project</span><br><span class="line">  &#123;</span><br><span class="line">      &quot;keys&quot;: [&quot;ctrl+alt+p&quot;],</span><br><span class="line">      &quot;command&quot;: &quot;prompt_select_workspace&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  // å¿«é€Ÿåˆ°è¡Œé¦–è¡Œå°¾</span><br><span class="line">  &#123; &quot;keys&quot;: [&quot;ctrl+left&quot;], &quot;command&quot;: &quot;move_to&quot;, &quot;args&quot;: &#123;&quot;to&quot;: &quot;bol&quot;, &quot;extend&quot;: false&#125; &#125;,</span><br><span class="line">  &#123; &quot;keys&quot;: [&quot;ctrl+right&quot;], &quot;command&quot;: &quot;move_to&quot;, &quot;args&quot;: &#123;&quot;to&quot;: &quot;eol&quot;, &quot;extend&quot;: false&#125; &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;font_size&quot;: 11,</span><br><span class="line">  &quot;ignored_packages&quot;:</span><br><span class="line">  [</span><br><span class="line">      &quot;Vintage&quot;</span><br><span class="line">  ],</span><br><span class="line">  // ç«–çº¿</span><br><span class="line">  &quot;rulers&quot;:</span><br><span class="line">  [</span><br><span class="line">      100,</span><br><span class="line">      120</span><br><span class="line">  ],</span><br><span class="line">  &quot;tab_size&quot;: 2,</span><br><span class="line">  &quot;translate_tabs_to_spaces&quot;: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SublimeLinteré…ç½®"><a href="#SublimeLinteré…ç½®" class="headerlink" title="SublimeLinteré…ç½®"></a>SublimeLinteré…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">// SublimeLinter Settings - User</span><br><span class="line">&#123;</span><br><span class="line">  &quot;debug&quot;: true,</span><br><span class="line">  &quot;delay&quot;: 0.25,</span><br><span class="line">  &quot;gutter_theme&quot;: &quot;Danish Royalty&quot;,</span><br><span class="line">  &quot;lint_mode&quot;: &quot;background&quot;,</span><br><span class="line">  &quot;linters&quot;: &#123;</span><br><span class="line">    &quot;eslint&quot;: &#123;</span><br><span class="line">      &quot;selector&quot;: &quot;text.html.vue, source.js - meta.attribute-with-value&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;no_column_highlights_line&quot;: false,</span><br><span class="line">  &quot;paths&quot;: &#123;</span><br><span class="line">    &quot;linux&quot;: [],</span><br><span class="line">    &quot;osx&quot;: [],</span><br><span class="line">    &quot;windows&quot;: [&quot;C:/Users/sampwood/AppData/Roaming/npm/eslint&quot;]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;show_marks_in_minimap&quot;: true,</span><br><span class="line">  &quot;styles&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;mark_style&quot;: &quot;outline&quot;,</span><br><span class="line">      &quot;priority&quot;: 1,</span><br><span class="line">      &quot;scope&quot;: &quot;region.yellowish markup.changed.sublime_linter markup.warning.sublime_linter&quot;,</span><br><span class="line">      &quot;icon&quot;: &quot;dot&quot;,</span><br><span class="line">      &quot;types&quot;: [</span><br><span class="line">          &quot;warning&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;mark_style&quot;: &quot;outline&quot;,</span><br><span class="line">      &quot;priority&quot;: 1,</span><br><span class="line">      &quot;scope&quot;: &quot;region.redish markup.deleted.sublime_linter markup.error.sublime_linter&quot;,</span><br><span class="line">      &quot;icon&quot;: &quot;dot&quot;,</span><br><span class="line">      &quot;types&quot;: [</span><br><span class="line">          &quot;error&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;syntax_map&quot;: &#123;</span><br><span class="line">    &quot;html (django)&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;html (rails)&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;html 5&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;javascript (babel)&quot;: &quot;javascript&quot;,</span><br><span class="line">    &quot;magicpython&quot;: &quot;python&quot;,</span><br><span class="line">    &quot;php&quot;: &quot;html&quot;,</span><br><span class="line">    &quot;python django&quot;: &quot;python&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="gité…ç½®"><a href="#gité…ç½®" class="headerlink" title="gité…ç½®"></a>gité…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;statusbar_branch&quot;: false,</span><br><span class="line">  &quot;statusbar_status&quot;: false,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="projectManageré…ç½®"><a href="#projectManageré…ç½®" class="headerlink" title="projectManageré…ç½®"></a>projectManageré…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;projects_path&quot;: [&quot;D:/sublime-folder&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="terminalé…ç½®"><a href="#terminalé…ç½®" class="headerlink" title="terminalé…ç½®"></a>terminalé…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  // windowä¸‹ç»ˆç«¯è·¯å¾„</span><br><span class="line">  &quot;terminal&quot;: &quot;D:\\Program Files\\cmder_mini\\Cmder.exe&quot;,</span><br><span class="line">  //  windowä¸‹ç»ˆç«¯å‚æ•°</span><br><span class="line">  &quot;parameters&quot;: [&quot;/START&quot;, &quot;%CWD%&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å› ä¸ºå–œæ¬¢sublimeçš„é…è‰²ï¼Œæ‰€ä»¥ä¸€ç›´éƒ½ä½¿ç”¨sublimeæ¥å¼€å‘å‰ç«¯ä»£ç ã€‚&lt;br&gt;ä¸‹é¢è®°å½•ä¸€äº›å¸¸ç”¨çš„é…ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¸‹è½½&quot;&gt;&lt;a href=&quot;#ä¸‹è½½&quot; class=&quot;headerlink&quot; title=&quot;ä¸‹è½½&quot;&gt;&lt;/a&gt;ä¸‹è½½&lt;/h3&gt;&lt;p&gt;å®˜ç½‘ä¸‹è½½ï¼š &lt;a href=&quot;http://www.sublimetext.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.sublimetext.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯å®‰è£…&lt;code&gt;package control&lt;/code&gt;: &lt;a href=&quot;https://packagecontrol.io/installation&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://packagecontrol.io/installation&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>cmderä½¿ç”¨</title>
    <link href="https://sampwood.github.io/2018/10/24/cmder%E4%BD%BF%E7%94%A8/"/>
    <id>https://sampwood.github.io/2018/10/24/cmderä½¿ç”¨/</id>
    <published>2018-10-24T12:45:03.000Z</published>
    <updated>2019-03-06T05:51:53.733Z</updated>
    
    <content type="html"><![CDATA[<p>cmderæ˜¯ä¸€ä¸ªè¶…æ£’çš„windowså‘½ä»¤çª—å£ã€‚</p><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>ä¸‹è½½åœ°å€ï¼š <a href="http://cmder.net/" target="_blank" rel="noopener">http://cmder.net/</a></p><p>ä¸€èˆ¬éƒ½åªç”¨ä¸‹è½½miniç‰ˆæœ¬å°±å¯ä»¥äº†ï¼Œå› ä¸ºgitéƒ½ä¼šè‡ªå·±ä¸‹è½½ = =</p><a id="more"></a><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>å› ä¸ºä¸‹è½½çš„miniç‰ˆæœ¬ï¼Œæ‰€ä»¥è¦ä½¿ç”¨bashçš„è¯å°±å¾—è‡ªå·±é…ç½®git bashçš„è·¯å¾„</p><p>æ‰“å¼€è®¾ç½®(win+alt+p)ï¼Œåœ¨<code>StartUp</code>ä¸‹é¢çš„<code>Tasks</code>ä¸­ï¼Œç‚¹å‡»å³è¾¹<code>Predefined tasks</code>åˆ—è¡¨æ–°å»ºä¸€ä¸ªtask<br>æˆ–è€…ç›´æ¥ä¿®æ”¹å…¶ä¸­çš„<code>{bash::bash}</code>ï¼Œåœ¨å³ä¾§æœ€ä¸‹é¢çš„æ–‡æœ¬æ¡†ä¸­å¡«å…¥git bashçš„è·¯å¾„ã€‚</p><p>ä¾‹å¦‚ï¼š <code>cmd /c &quot;&quot;C:\Program Files\Git\bin\bash&quot; --login -i&quot;</code></p><p>åŒæ—¶ï¼Œä¿®æ”¹<code>{bash::bash as Admin}</code>: <code>*cmd /c &quot;&quot;C:\Program Files\Git\bin\bash&quot; --login -i&quot;</code></p><p>æœ‰æ­¤å¯è§ï¼Œ<code>*</code>è¡¨ç¤ºæ˜¯å¦ç”±ç®¡ç†å‘˜è¿è¡Œ</p><p><strong>åœ¨<code>StartUp</code>ä¸­å¯ä»¥è®¾ç½®é»˜è®¤å¯åŠ¨çš„taskï¼šåœ¨<code>Specified named task</code>é€‰æ‹©æƒ³è¦çš„task</strong></p><p>å½“ç„¶ï¼Œé…ç½®å¥½ä¹‹åè®°å¾—ç‚¹å‡»ä¿å­˜</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;cmderæ˜¯ä¸€ä¸ªè¶…æ£’çš„windowså‘½ä»¤çª—å£ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¸‹è½½&quot;&gt;&lt;a href=&quot;#ä¸‹è½½&quot; class=&quot;headerlink&quot; title=&quot;ä¸‹è½½&quot;&gt;&lt;/a&gt;ä¸‹è½½&lt;/h3&gt;&lt;p&gt;ä¸‹è½½åœ°å€ï¼š &lt;a href=&quot;http://cmder.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cmder.net/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬éƒ½åªç”¨ä¸‹è½½miniç‰ˆæœ¬å°±å¯ä»¥äº†ï¼Œå› ä¸ºgitéƒ½ä¼šè‡ªå·±ä¸‹è½½ = =&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
    
      <category term="environment" scheme="https://sampwood.github.io/tags/environment/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨vpsä¸Šæ­å»ºä¸€ä¸ªgitä»“åº“å¹¶å®ç°ä»£ç æäº¤ä¹‹åè‡ªåŠ¨éƒ¨ç½²åˆ°nginxä¸Š</title>
    <link href="https://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook/"/>
    <id>https://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook/</id>
    <published>2018-10-17T08:27:19.000Z</published>
    <updated>2019-03-06T05:51:53.740Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨ä¸€èˆ¬è‡ªå·±ç©çš„é¡¹ç›®éƒ½ä¼šæ‰˜ç®¡åœ¨githubä¸Šï¼Œç„¶åä½¿ç”¨githubæä¾›çš„gitä»“åº“åœ°å€æ¥ç»´æŠ¤è‡ªå·±çš„ä»£ç ã€‚<br>ä¾‹å¦‚<code>git@ github.com:Sampwood/sampwood.github.io.git</code>ã€‚</p><p>æŸä¸€å¤©ï¼Œå¿½ç„¶æƒ³è¦å¼€å‘ä¸€ä¸ªç§äººçš„é¡¹ç›®ç©ï¼Œæ„Ÿè§‰æ”¾åœ¨githubä¸Šå°±ä¸å¤ªå¥½ï¼Œ æ¯•ç«Ÿä¸€äº›ç§äººçš„ä¸œè¥¿ä¸å¥½æ”¾ä¸Šå»ã€‚<br>äºæ˜¯å†³å®šåœ¨è‡ªå·±çš„vpsä¸Šæ­å»ºä¸€ä¸ªgitä»“åº“æ¥ç»´æŠ¤è‡ªå·±çš„ä»£ç ã€‚</p><a id="more"></a><h3 id="vpsä¸Šæ­å»ºgitä»“åº“"><a href="#vpsä¸Šæ­å»ºgitä»“åº“" class="headerlink" title="vpsä¸Šæ­å»ºgitä»“åº“"></a>vpsä¸Šæ­å»ºgitä»“åº“</h3><p>å¯¹æ¯”githubä»£ç ä»“åº“sshåœ°å€<code>git@ github.com:Sampwood/sampwood.github.io.git</code><br>å’Œsshç™»é™†vpsçš„å‘½ä»¤<code>ssh root@**.**.**.**</code>ã€‚<br>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£ä»£ç ä»“åº“ä½¿ç”¨çš„sshåœ°å€ï¼Œå°±æ˜¯gitç”¨æˆ·ä¸‹Sampwoodæ–‡ä»¶å¤¹ä¸‹çš„sampwood.github.io.gitæ–‡ä»¶å¤¹ä¸‹çš„gitä»“åº“ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨vpsä¸Šçš„æ“ä½œå°±æ˜¯å®‰è£…gitï¼Œåˆ›å»ºgitç”¨æˆ·ï¼Œä»¥åŠæ–°å»ºgité¡¹ç›®ã€‚</p><h4 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h4><p>å¯¹äºUbuntuï¼Œåªè¦ä¸¤æ­¥ï¼š</p><p><code>$ add-apt-repository ppa:git-core/ppa</code>, <code>$ apt update; apt install git</code></p><p>å…·ä½“å…¶ä»–çš„å¯å‚è€ƒå®˜ç½‘ï¼š<a href="https://git-scm.com/download/linux" target="_blank" rel="noopener">Download for Linux and Unix</a></p><h4 id="åˆ›å»ºgitç”¨æˆ·"><a href="#åˆ›å»ºgitç”¨æˆ·" class="headerlink" title="åˆ›å»ºgitç”¨æˆ·"></a>åˆ›å»ºgitç”¨æˆ·</h4><p>æ–°å»ºgitç”¨æˆ·å¹¶æ·»åŠ åˆ°sudoç»„ï¼š <code>$ adduser git --ingroup sudo</code></p><h5 id="ä½¿ç”¨sshå¯†é’¥"><a href="#ä½¿ç”¨sshå¯†é’¥" class="headerlink" title="ä½¿ç”¨sshå¯†é’¥"></a>ä½¿ç”¨sshå¯†é’¥</h5><p>ä½¿ç”¨git bashæ¥ç”Ÿæˆssh keyï¼š<br><code>$ ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</code></p><p><em>PS: ä¸ºé¿å…æ¯æ¬¡è¾“å…¥ssh keyçš„å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨<code>ssh-agent</code>æ¥ç®¡ç†ssh keyã€‚</em></p><p>ç„¶åä¸Šä¼ keyåˆ°vpsï¼š<br><code>ssh-copy-id git@**.**.**.**</code></p><h4 id="æ–°å»ºgité¡¹ç›®"><a href="#æ–°å»ºgité¡¹ç›®" class="headerlink" title="æ–°å»ºgité¡¹ç›®"></a>æ–°å»ºgité¡¹ç›®</h4><p>ä½œä¸ºgitä»“åº“ï¼Œä¸€èˆ¬åªå»ºä¸€ä¸ªbareä»“åº“ï¼Œå› ä¸ºä¸ä¼šç›´æ¥åœ¨è¿™é‡Œè¿›è¡Œä»£ç ä¿®æ”¹ã€‚<br>bareä»“åº“ä¸ä¼šåŒ…å«å®é™…é¡¹ç›®æºæ–‡ä»¶çš„æ‹·è´ï¼Œåªæœ‰.gitç›®å½•ä¸‹çš„æ–‡ä»¶<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~ </span><br><span class="line">$ mkdir blog.git &amp;&amp; <span class="built_in">cd</span> blog.git</span><br><span class="line">$ git init --bare</span><br></pre></td></tr></table></figure></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨vpsä¸Šæ­å»ºgitä»“åº“çš„æ“ä½œå·²ç»ç»“æŸã€‚<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>git clone git@**.**.**.**:blog.git</code>æ¥å…‹éš†ä»£ç äº†ã€‚</p><h3 id="git-hookå“åº”pushè‡ªåŠ¨éƒ¨ç½²ä»£ç "><a href="#git-hookå“åº”pushè‡ªåŠ¨éƒ¨ç½²ä»£ç " class="headerlink" title="git hookå“åº”pushè‡ªåŠ¨éƒ¨ç½²ä»£ç "></a>git hookå“åº”pushè‡ªåŠ¨éƒ¨ç½²ä»£ç </h3><p>blog.gitæ˜¯é€Ÿåº¦æ¯”è¾ƒå¿«çš„bareä»“åº“ï¼Œå¹¶ä¸æ˜¯å¯ç›´æ¥ä½¿ç”¨çš„ç›®å½•ï¼Œ<br>æ‰€ä»¥éœ€è¦åˆ¶ä½œä¸€ä¸ªPOST Hookså°†è¿™ä¸ªä»“åº“cloneåˆ°ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œå†æ‹·è´åˆ°å®é™…wwwç›®å½•ã€‚</p><p>å¯¹åº”<code>git push</code>çš„hooké’©å­æ˜¯<code>post-receive</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/blog.git/hooks</span><br><span class="line">$ touch post-receive</span><br><span class="line">$ vi post-receive</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash -l</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># define path</span></span><br><span class="line">GIT_REPO=/home/git/blog.git</span><br><span class="line">TMP_GIT_CLONE=/tmp/blog</span><br><span class="line">PUBLIC_WWW=/var/www/blog</span><br><span class="line"></span><br><span class="line"><span class="comment"># clean tmp directory</span></span><br><span class="line">rm -rf <span class="variable">$&#123;TMP_GIT_CLONE&#125;</span></span><br><span class="line">git <span class="built_in">clone</span> <span class="variable">$GIT_REPO</span> <span class="variable">$TMP_GIT_CLONE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># do some work</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$TMP_GIT_CLONE</span></span><br><span class="line">npm i</span><br><span class="line">npm run build</span><br><span class="line"></span><br><span class="line"><span class="comment"># clean public directory</span></span><br><span class="line">rm -rf <span class="variable">$&#123;PUBLIC_WWW&#125;</span>/*</span><br><span class="line">cp -rf <span class="variable">$&#123;TMP_GIT_CLONE&#125;</span>/dist/* <span class="variable">$&#123;PUBLIC_WWW&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># show done info</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"githook: <span class="variable">$(date)</span>: Done"</span></span><br></pre></td></tr></table></figure></p><p>æ›´æ”¹è„šæœ¬æƒé™å’Œ/var/www/blogæƒé™<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chmod +x post-receive</span><br><span class="line">$ sudo chmod 775 -R /var/www/blog</span><br></pre></td></tr></table></figure></p><p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªè„šæœ¬æ˜¯é’ˆå¯¹å‰ç«¯é¡¹ç›®çš„ï¼Œè€Œä¸”å…¶å®æ›´å¥½çš„åšæ³•æ˜¯é€šçŸ¥æŒç»­é›†æˆï¼ˆcontinous integrationï¼‰çš„æœåŠ¡å™¨ã€‚</p><p>å¦å¤–è¿™é‡Œè´´ä¸€ä¸ªæ›´å¥½çš„<code>post-receive</code>è„šæœ¬çš„å†™æ³•ï¼š<br><a href="https://gist.github.com/thomasfr/9691385" target="_blank" rel="noopener">How-to setup a simple git push deployment</a></p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœç¢°åˆ°<code>Permission denied</code>ï¼Œè¯·ä¿®æ”¹æ–‡ä»¶æ‹¥æœ‰è€…ï¼š <code>sudo chown git file</code></p><h3 id="vpsä¸Šæ­å»ºnginx"><a href="#vpsä¸Šæ­å»ºnginx" class="headerlink" title="vpsä¸Šæ­å»ºnginx"></a>vpsä¸Šæ­å»ºnginx</h3><h4 id="å®‰è£…nginx"><a href="#å®‰è£…nginx" class="headerlink" title="å®‰è£…nginx"></a>å®‰è£…nginx</h4><p>Ubuntué»˜è®¤çš„æºä¸­å°±æœ‰Nginxï¼Œæ‰€ä»¥å®‰è£…æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚<br>é¦–å…ˆï¼Œæ›´æ–°aptæºï¼Œä»¥ä¾¿è½¯ä»¶æ˜¯æœ€æ–°çš„ï¼Œç„¶åå°±å¯ä»¥å®‰è£…nginx:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nginx</span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®é˜²ç«å¢™"><a href="#é…ç½®é˜²ç«å¢™" class="headerlink" title="é…ç½®é˜²ç«å¢™"></a>é…ç½®é˜²ç«å¢™</h4><p>å¼€å§‹æµ‹è¯•Nginxå‰ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®é˜²ç«å¢™ï¼Œä»¥ä¾¿å…è®¸å¤–ç•Œè®¿é—®nginxæœåŠ¡ã€‚Nginxåœ¨å®‰è£…çš„æ—¶å€™ä½¿ç”¨ufwæ³¨å†Œè‡ªå·±ä½œä¸ºä¸€ä¸ªæœåŠ¡ï¼Œè¿™æ ·å¯¹nginxçš„è®¿é—®å°±ä¼šå˜å¾—å¾ˆå®¹æ˜“ã€‚</p><p>æ˜¾ç¤ºæ‰€æœ‰ufwåº”ç”¨çš„é…ç½®ï¼š<code>sudo ufw app list</code></p><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªé…ç½®çš„è¾“å‡ºåˆ—è¡¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Available applications:</span><br><span class="line">  Nginx Full</span><br><span class="line">  Nginx HTTP</span><br><span class="line">  Nginx HTTPS</span><br><span class="line">  OpenSSH</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸‰ä¸ªNginxçš„é…ç½®ï¼š</p><ul><li><strong>Nginx Full</strong>: è¿™ä¸ªé…ç½®æ‰“å¼€ 80ç«¯å£å’Œ443ç«¯å£</li><li><strong>Nginx HTTP</strong>: è¿™ä¸ªé…ç½®åªæ‰“å¼€80 (æ™®é€š, æœªåŠ å¯†é€šä¿¡)</li><li><strong>Nginx HTTPS</strong>: è¿™ä¸ªé…ç½®åªæ‰“å¼€ 443 (TLS/SSL åŠ å¯†é€šä¿¡ )</li></ul><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬åº”è¯¥é…ç½®æœ€ä¸¥çš„é™åˆ¶ï¼Œå› ä¸ºæœ¬æ–‡æˆ‘ä»¬è¿˜æ²¡æœ‰é…ç½®SSLï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ‰“å¼€80ç«¯å£ã€‚</p><p>æˆ‘ä»¬æ‰§è¡Œï¼š<code>sudo ufw allow &#39;Nginx HTTP&#39;</code></p><p>éªŒè¯ä¿®æ”¹çŠ¶æ€:</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°HTTPæ˜¯è¢«æ‰“å¼€çš„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Status: active</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">OpenSSH                    ALLOW       Anywhere                  </span><br><span class="line">Nginx HTTP                 ALLOW       Anywhere                  </span><br><span class="line">OpenSSH (v6)               ALLOW       Anywhere (v6)             </span><br><span class="line">Nginx HTTP (v6)            ALLOW       Anywhere (v6)</span><br></pre></td></tr></table></figure></p><h4 id="æ£€æŸ¥web-server"><a href="#æ£€æŸ¥web-server" class="headerlink" title="æ£€æŸ¥web server"></a>æ£€æŸ¥web server</h4><p>å®‰è£…å®Œæˆåï¼ŒUbuntu 16.04 ä¼šè‡ªåŠ¨å¯åŠ¨ Nginx. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨systemd æ£€æŸ¥è¿è¡ŒçŠ¶æ€:<br><code>systemctl status nginx</code></p><p>è¾“å‡º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â— nginx.service - A high performance web server and a reverse proxy server</span><br><span class="line">   Loaded: loaded (/lib/systemd/system/nginx.service; disabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Mon 2018-10-15 04:23:21 UTC; 2 days ago</span><br><span class="line">     Docs: man:nginx(8)</span><br><span class="line">  Process: 9064 ExecStart=/usr/sbin/nginx -g daemon on; master_process on; (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 9061 ExecStartPre=/usr/sbin/nginx -t -q -g daemon on; master_process on; (code=exited, status=0/ Main PID: 9068 (nginx)</span><br><span class="line">    Tasks: 2</span><br><span class="line">   Memory: 3.5M</span><br><span class="line">      CPU: 150ms</span><br><span class="line">   CGroup: /system.slice/nginx.service</span><br><span class="line">           â”œâ”€ 9068 nginx: master process /usr/sbin/nginx -g daemon on; master_process on</span><br><span class="line">           â””â”€27117 nginx: worker process</span><br></pre></td></tr></table></figure></p><p>æœåŠ¡å·²ç»æ­£å¸¸å¯åŠ¨ï¼Œå½“ç„¶æœ€å¥½çš„ç¡®è®¤æ–¹æ³•æ˜¯é€šè¿‡è®¿é—®webé¡µé¢çš„æ–¹å¼ã€‚</p><h4 id="ç®¡ç†-Nginx-è¿›ç¨‹"><a href="#ç®¡ç†-Nginx-è¿›ç¨‹" class="headerlink" title="ç®¡ç† Nginx è¿›ç¨‹"></a>ç®¡ç† Nginx è¿›ç¨‹</h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰nginxåœ¨è¿è¡Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥å†è¯•ä¸€äº›ç®¡ç†å‘½ä»¤ï¼š</p><ul><li>åœæ­¢nginx: <code>sudo systemctl stop nginx</code></li><li>å¯åŠ¨nginx: <code>sudo systemctl restart nginx</code></li><li>ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œå¹³æ»‘åŠ è½½é…ç½®å‘½ä»¤(ä¸ä¼šæ–­å¼€ç”¨æˆ·è®¿é—®ï¼‰ï¼š<code>sudo systemctl reload nginx</code></li><li>é»˜è®¤ï¼Œnginxæ˜¯éšç€ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿è¡Œã€‚å¦‚æœä½ ä¸æƒ³å¼€æœºå¯åŠ¨ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç¦æ­¢nginxå¼€æœºå¯åŠ¨ï¼š <code>sudo systemctl disable nginx</code></li><li>é‡æ–°é…ç½®nginxå¼€æœºè‡ªåŠ¨å¯åŠ¨: <code>sudo systemctl enable nginx</code></li></ul><h4 id="Nginxçš„æ–‡ä»¶å’Œç›®å½•"><a href="#Nginxçš„æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="Nginxçš„æ–‡ä»¶å’Œç›®å½•"></a>Nginxçš„æ–‡ä»¶å’Œç›®å½•</h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»ç®¡ç†nginxäº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥ç†Ÿæ‚‰ä¸€ä¸‹nginxçš„ç›®å½•ç»“æ„å’Œä¸€äº›é‡è¦çš„æ–‡ä»¶ï¼š</p><p><strong>ç½‘ç«™æ–‡ä»¶ä½ç½®</strong></p><ul><li>/var/www/html: ç½‘ç«™æ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹, é»˜è®¤åªæœ‰æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°nginxé¡µé¢ï¼Œå¯ä»¥é€šè¿‡æ”¹å˜nginxé…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥ä¿®æ”¹è¿™ä¸ªä½ç½®ã€‚</li></ul><p><strong>æœåŠ¡å™¨é…ç½®</strong></p><ul><li>/etc/nginx: nginxé…ç½®æ–‡ä»¶ç›®å½•ã€‚æ‰€æœ‰çš„nginxé…ç½®æ–‡ä»¶éƒ½åœ¨è¿™é‡Œã€‚</li><li>/etc/nginx/nginx.conf: Nginxçš„ä¸»é…ç½®æ–‡ä»¶. å¯ä»¥ä¿®æ”¹ä»–æ¥æ”¹å˜nginxçš„å…¨å±€é…ç½®ã€‚</li><li>/etc/nginx/sites-available/: è¿™ä¸ªç›®å½•å­˜å‚¨æ¯ä¸€ä¸ªç½‘ç«™çš„â€server blocksâ€ã€‚nginxé€šå¸¸ä¸ä¼šä½¿ç”¨è¿™äº›é…ç½®ï¼Œé™¤éå®ƒä»¬é™ªè¿æ¥åˆ°  sites-enabled ç›®å½• (see below)ã€‚ä¸€èˆ¬æ‰€æœ‰çš„server block é…ç½®éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸­è®¾ç½®ï¼Œç„¶åè½¯è¿æ¥åˆ°åˆ«çš„ç›®å½• ã€‚</li><li>/etc/nginx/sites-enabled/: è¿™ä¸ªç›®å½•å­˜å‚¨ç”Ÿæ•ˆçš„ â€œserver blocksâ€ é…ç½®. é€šå¸¸,è¿™ä¸ªé…ç½®éƒ½æ˜¯é“¾æ¥åˆ° sites-availableç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶</li><li>/etc/nginx/snippets: è¿™ä¸ªç›®å½•ä¸»è¦å¯ä»¥åŒ…å«åœ¨å…¶å®ƒnginxé…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ç‰‡æ®µã€‚é‡å¤çš„é…ç½®éƒ½å¯ä»¥é‡æ„ä¸ºé…ç½®ç‰‡æ®µã€‚</li></ul><p><strong>æ—¥å¿—æ–‡ä»¶</strong></p><ul><li>/var/log/nginx/access.log: æ¯ä¸€ä¸ªè®¿é—®è¯·æ±‚éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œé™¤éä½ åšäº†å…¶å®ƒè®¾ç½®ã€‚</li><li>/var/log/nginx/error.log: ä»»ä½•Nginxçš„é”™è¯¯ä¿¡æ¯éƒ½ä¼šè®°å½•åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</li></ul><h4 id="ä¿®æ”¹nginxé…ç½®"><a href="#ä¿®æ”¹nginxé…ç½®" class="headerlink" title="ä¿®æ”¹nginxé…ç½®"></a>ä¿®æ”¹nginxé…ç½®</h4><p>ç›´æ¥ä¿®æ”¹<code>/etc/nginx/sites-available</code>ä¸‹çš„<code>default</code>æ–‡ä»¶ï¼Œ<br>æˆ–è€…æ–°å»ºä¸€ä¸ª<code>blog</code>æ–‡ä»¶å¹¶æ³¨é‡Šæ‰<code>default</code>ä¸­çš„å†…å®¹ã€‚</p><p>å†™å…¥nginxé…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        listen [::]:80;</span><br><span class="line"></span><br><span class="line">        server_name blog.sampwood.top; // æ ¹æ®åŸŸåè½¬å‘åˆ°ä¸åŒç«¯å£</span><br><span class="line"></span><br><span class="line">        root /var/www/blog;</span><br><span class="line">        index index.html;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                root /var/www/blog;</span><br><span class="line">                try_files $uri $uri/ @router;</span><br><span class="line">                index index.html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">                root html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location @router &#123;</span><br><span class="line">                rewrite ^.*$ /index.html last;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 80 default_server;</span><br><span class="line">        listen [::]:80 default_server;</span><br><span class="line"></span><br><span class="line">        server_name _; // é»˜è®¤nginxçš„è®¿é—®é¡µé¢</span><br><span class="line"></span><br><span class="line">        root /var/www/html;</span><br><span class="line"></span><br><span class="line">        index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                try_files $uri $uri/ =404;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦‚æœæ˜¯æ–°å»ºäº†ä¸€ä¸ª<code>blog</code>æ–‡ä»¶ï¼Œé‚£åœ¨<code>/etc/nginx/sites-enabled</code>çš„æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªè½¯è¿æ¥ï¼š<br><code>ln  -s  /etc/nginx/sites-enabled/blog  /etc/nginx/sites-available/blog</code></p><p>ç„¶åå°±å¯ä»¥ç”¨<code>nginx -s reload</code>é‡æ–°å¯åŠ¨<code>nginx</code>äº†ã€‚</p><blockquote><p>åˆ°è¿™é‡Œï¼Œå·®ä¸å¤šæˆ‘ä»¬çš„å·¥ä½œå°±åšå®Œäº†ã€‚<br>ç°åœ¨ï¼Œæ¯æ¬¡æˆ‘ä»¬pushä»£ç ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨éƒ¨ç½²ä»£ç ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½è®¿é—®nginxæœåŠ¡å™¨çœ‹åˆ°æ–°çš„æ”¹åŠ¨ã€‚</p></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://noahgao.net/2015/git-deploy-vps/" target="_blank" rel="noopener">ä½¿ç”¨Gitåœ¨VPSä¸Šéƒ¨ç½²ä»£ç </a></li><li><a href="https://git-scm.com/download/linux" target="_blank" rel="noopener">Download for Linux and Unix</a></li><li><a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="noopener">Connecting to GitHub with SSH</a></li><li><a href="https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90" target="_blank" rel="noopener">è‡ªå®šä¹‰ Git - Git é’©å­</a></li><li><a href="https://gist.github.com/thomasfr/9691385" target="_blank" rel="noopener">How-to setup a simple git push deployment</a></li><li><a href="http://www.nginx.cn/4723.html" target="_blank" rel="noopener">å¦‚ä½•åœ¨ubuntu 16.04 ä¸Šå®‰è£…Nginx</a></li><li><a href="https://www.jianshu.com/p/93ac21161ac6" target="_blank" rel="noopener">nginx åŸºæœ¬å…¥é—¨(è‡³ä»Šä¸ºæ­¢è§è¿‡æœ€å¥½çš„ nginx å…¥é—¨æ–‡ç« ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚)</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç°åœ¨ä¸€èˆ¬è‡ªå·±ç©çš„é¡¹ç›®éƒ½ä¼šæ‰˜ç®¡åœ¨githubä¸Šï¼Œç„¶åä½¿ç”¨githubæä¾›çš„gitä»“åº“åœ°å€æ¥ç»´æŠ¤è‡ªå·±çš„ä»£ç ã€‚&lt;br&gt;ä¾‹å¦‚&lt;code&gt;git@ github.com:Sampwood/sampwood.github.io.git&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æŸä¸€å¤©ï¼Œå¿½ç„¶æƒ³è¦å¼€å‘ä¸€ä¸ªç§äººçš„é¡¹ç›®ç©ï¼Œæ„Ÿè§‰æ”¾åœ¨githubä¸Šå°±ä¸å¤ªå¥½ï¼Œ æ¯•ç«Ÿä¸€äº›ç§äººçš„ä¸œè¥¿ä¸å¥½æ”¾ä¸Šå»ã€‚&lt;br&gt;äºæ˜¯å†³å®šåœ¨è‡ªå·±çš„vpsä¸Šæ­å»ºä¸€ä¸ªgitä»“åº“æ¥ç»´æŠ¤è‡ªå·±çš„ä»£ç ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="linux" scheme="https://sampwood.github.io/categories/coding/linux/"/>
    
    
      <category term="linux" scheme="https://sampwood.github.io/tags/linux/"/>
    
      <category term="git" scheme="https://sampwood.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>webç¼“å­˜</title>
    <link href="https://sampwood.github.io/2018/06/18/web%E7%BC%93%E5%AD%98/"/>
    <id>https://sampwood.github.io/2018/06/18/webç¼“å­˜/</id>
    <published>2018-06-18T07:48:36.000Z</published>
    <updated>2019-03-06T05:51:53.741Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½ä¸€ç›´éƒ½æ˜¯è¢«å¤§å®¶æ‰€é‡è§†çš„ä¸€ç‚¹ï¼Œç„¶è€Œåˆ¤æ–­ä¸€ä¸ªç½‘ç«™çš„æ€§èƒ½æœ€ç›´è§‚çš„å°±æ˜¯çœ‹ç½‘é¡µæ‰“å¼€çš„é€Ÿåº¦ã€‚å…¶ä¸­æé«˜ç½‘é¡µååº”é€Ÿåº¦çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯ä½¿ç”¨ç¼“å­˜ã€‚ä¸€ä¸ªä¼˜ç§€çš„ç¼“å­˜ç­–ç•¥å¯ä»¥ç¼©çŸ­ç½‘é¡µè¯·æ±‚èµ„æºçš„è·ç¦»ï¼Œå‡å°‘å»¶è¿Ÿï¼Œå¹¶ä¸”ç”±äºç¼“å­˜æ–‡ä»¶å¯ä»¥é‡å¤åˆ©ç”¨ï¼Œè¿˜å¯ä»¥å‡å°‘å¸¦å®½ï¼Œé™ä½ç½‘ç»œè´Ÿè·ã€‚</p><p>åœ¨è¿™é‡Œæ•´ç†ä¸€äº›webç¼“å­˜çš„æ–¹æ³•ã€‚</p><h3 id="ç¼“å­˜åˆ†ç±»"><a href="#ç¼“å­˜åˆ†ç±»" class="headerlink" title="ç¼“å­˜åˆ†ç±»"></a>ç¼“å­˜åˆ†ç±»</h3><p><img src="/images/classify.png" alt="ç¼“å­˜åˆ†ç±»"></p><a id="more"></a><h3 id="æµè§ˆå™¨ç¼“å­˜"><a href="#æµè§ˆå™¨ç¼“å­˜" class="headerlink" title="æµè§ˆå™¨ç¼“å­˜"></a>æµè§ˆå™¨ç¼“å­˜</h3><p>å¯¹äºæµè§ˆå™¨ç«¯çš„ç¼“å­˜æ¥è®²ï¼Œè¿™äº›è§„åˆ™æ˜¯åœ¨HTTPåè®®å¤´å’ŒHTMLé¡µé¢çš„Metaæ ‡ç­¾ä¸­å®šä¹‰çš„ã€‚ä»–ä»¬åˆ†åˆ«ä»<strong>æ–°é²œåº¦</strong>å’Œ<strong>æ ¡éªŒå€¼</strong><br>ä¸¤ä¸ªç»´åº¦æ¥è§„å®šæµè§ˆå™¨æ˜¯å¦å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜ä¸­çš„å‰¯æœ¬ï¼Œè¿˜æ˜¯éœ€è¦å»æºæœåŠ¡å™¨è·å–æ›´æ–°çš„ç‰ˆæœ¬ã€‚</p><p>å¯¹åº”çš„æ¥è¯´å°±æ˜¯headerä¸­çš„4ä¸ªå‚æ•°ï¼š<code>Cache-Control</code>, <code>Expires</code>, <code>Last-Modified</code>, <code>ETag</code>ã€‚</p><h4 id="æœ¬åœ°ç¼“å­˜é˜¶æ®µ"><a href="#æœ¬åœ°ç¼“å­˜é˜¶æ®µ" class="headerlink" title="æœ¬åœ°ç¼“å­˜é˜¶æ®µ"></a>æœ¬åœ°ç¼“å­˜é˜¶æ®µ</h4><h5 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control:"></a><code>Cache-Control</code>:</h5><ul><li>max-age: ï¼ˆå•ä½ä¸ºsï¼‰æŒ‡å®šè®¾ç½®ç¼“å­˜æœ€å¤§çš„æœ‰æ•ˆæ—¶é—´ï¼Œå®šä¹‰çš„æ˜¯æ—¶é—´é•¿çŸ­ã€‚å½“æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚åï¼Œåœ¨max-ageè¿™æ®µæ—¶é—´é‡Œæµè§ˆå™¨å°±ä¸ä¼šå†å‘æœåŠ¡å™¨å‘é€è¯·æ±‚äº†ã€‚</li><li>s-maxage: å•ä½ä¸ºsï¼‰åŒmax-ageï¼Œåªç”¨äºå…±äº«ç¼“å­˜ï¼ˆæ¯”å¦‚CDNç¼“å­˜ï¼‰ã€‚</li><li>public: æŒ‡å®šå“åº”ä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¸”åœ¨å¤šç”¨æˆ·é—´å…±äº«ã€‚è¡¨ç¤ºç¼“å­˜çš„ç‰ˆæœ¬å¯ä»¥è¢«ä»£ç†æœåŠ¡å™¨æˆ–è€…å…¶ä»–ä¸­é—´æœåŠ¡å™¨è¯†åˆ«ã€‚</li><li>private: å“åº”åªä½œä¸ºç§æœ‰çš„ç¼“å­˜ï¼ˆè§ä¸‹å›¾ï¼‰ï¼Œä¸èƒ½åœ¨ç”¨æˆ·é—´å…±äº«ã€‚å¦‚æœè¦æ±‚HTTPè®¤è¯ï¼Œå“åº”ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºprivateã€‚æ„å‘³ç€è¿™ä¸ªæ–‡ä»¶å¯¹ä¸åŒçš„ç”¨æˆ·æ˜¯ä¸åŒçš„ã€‚åªæœ‰ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨èƒ½å¤Ÿè¿›è¡Œç¼“å­˜ï¼Œå…¬å…±çš„ä»£ç†æœåŠ¡å™¨ä¸å…è®¸ç¼“å­˜ã€‚</li><li>no-cache: æŒ‡å®šä¸ç¼“å­˜å“åº”ï¼Œè¡¨æ˜èµ„æºä¸è¿›è¡Œç¼“å­˜</li><li>no-store: ç»å¯¹ç¦æ­¢ç¼“å­˜</li><li>must-revalidate: ?</li></ul><h5 id="Expiresï¼šæŒ‡å®šç¼“å­˜åˆ°æœŸGMTçš„ç»å¯¹æ—¶é—´-ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´ï¼Œæ˜¯æœåŠ¡å™¨ç«¯çš„å…·ä½“çš„æ—¶é—´ç‚¹ã€‚"><a href="#Expiresï¼šæŒ‡å®šç¼“å­˜åˆ°æœŸGMTçš„ç»å¯¹æ—¶é—´-ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´ï¼Œæ˜¯æœåŠ¡å™¨ç«¯çš„å…·ä½“çš„æ—¶é—´ç‚¹ã€‚" class="headerlink" title="Expiresï¼šæŒ‡å®šç¼“å­˜åˆ°æœŸGMTçš„ç»å¯¹æ—¶é—´; ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´ï¼Œæ˜¯æœåŠ¡å™¨ç«¯çš„å…·ä½“çš„æ—¶é—´ç‚¹ã€‚"></a><code>Expires</code>ï¼šæŒ‡å®šç¼“å­˜åˆ°æœŸGMTçš„ç»å¯¹æ—¶é—´; ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´ï¼Œæ˜¯æœåŠ¡å™¨ç«¯çš„å…·ä½“çš„æ—¶é—´ç‚¹ã€‚</h5><p>å¦‚æœè®¾äº†<code>max-age</code>ï¼Œ<code>max-age</code>å°±ä¼šè¦†ç›–<code>expires</code>ã€‚å¦‚æœ<code>expires</code>åˆ°æœŸéœ€è¦é‡æ–°è¯·æ±‚ã€‚</p><h4 id="åå•†ç¼“å­˜é˜¶æ®µ"><a href="#åå•†ç¼“å­˜é˜¶æ®µ" class="headerlink" title="åå•†ç¼“å­˜é˜¶æ®µ"></a>åå•†ç¼“å­˜é˜¶æ®µ</h4><h5 id="Last-Modifiedå’Œif-modified-since"><a href="#Last-Modifiedå’Œif-modified-since" class="headerlink" title="Last-Modifiedå’Œif-modified-since"></a><code>Last-Modified</code>å’Œ<code>if-modified-since</code></h5><p>è¿™æ˜¯ä¸€å¯¹æŠ¥æ–‡å¤´ï¼Œå±äºhttp 1.0ã€‚</p><p>last-modifiedæ˜¯WEBæœåŠ¡å™¨è®¤ä¸ºå¯¹è±¡çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œæ¯”å¦‚æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼ŒåŠ¨æ€é¡µé¢çš„æœ€åäº§ç”Ÿæ—¶é—´ã€‚</p><h5 id="Etagå’ŒIf-None-Match"><a href="#Etagå’ŒIf-None-Match" class="headerlink" title="Etagå’ŒIf-None-Match"></a><code>Etag</code>å’Œ<code>If-None-Match</code></h5><p>è¿™æ˜¯ä¸€å¯¹æŠ¥æ–‡ï¼Œå±äºhttp 1.1ã€‚</p><p>æ ¹æ®å®ä½“å†…å®¹ç”Ÿæˆä¸€æ®µhashå­—ç¬¦ä¸²ï¼Œæ ‡è¯†èµ„æºçš„çŠ¶æ€ï¼Œç”±æœåŠ¡ç«¯äº§ç”Ÿã€‚æµè§ˆå™¨ä¼šå°†è¿™ä¸²å­—ç¬¦ä¸²ä¼ å›æœåŠ¡å™¨ï¼ŒéªŒè¯èµ„æºæ˜¯å¦å·²ç»ä¿®æ”¹ã€‚</p><p>Etag ä¸»è¦ä¸ºäº†è§£å†³ Last-Modified æ— æ³•è§£å†³çš„ä¸€äº›é—®é¢˜ï¼š</p><p>1ã€ä¸€äº›æ–‡ä»¶ä¹Ÿè®¸ä¼šå‘¨æœŸæ€§çš„æ›´æ”¹ï¼Œä½†æ˜¯ä»–çš„å†…å®¹å¹¶ä¸æ”¹å˜(ä»…ä»…æ”¹å˜çš„ä¿®æ”¹æ—¶é—´)ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å®¢æˆ·ç«¯è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œè€Œé‡æ–°GETï¼›</p><p>2ã€æŸäº›æ–‡ä»¶ä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œæ¯”å¦‚åœ¨ç§’ä»¥ä¸‹çš„æ—¶é—´å†…è¿›è¡Œä¿®æ”¹ï¼Œ(æ¯”æ–¹è¯´1så†…ä¿®æ”¹äº†Næ¬¡)ï¼ŒIf-Modified-Sinceèƒ½æ£€æŸ¥åˆ°çš„ç²’åº¦æ˜¯sçº§çš„ï¼Œè¿™ç§ä¿®æ”¹æ— æ³•åˆ¤æ–­(æˆ–è€…è¯´UNIXè®°å½•MTIMEåªèƒ½ç²¾ç¡®åˆ°ç§’)ï¼›</p><p>3ã€æŸäº›æœåŠ¡å™¨ä¸èƒ½ç²¾ç¡®çš„å¾—åˆ°æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œè¿™æ ·å°±æ— æ³•é€šè¿‡æœ€åä¿®æ”¹æ—¶é—´åˆ¤æ–­èµ„æºæ˜¯å¦æ›´æ–° </p><h3 id="æœåŠ¡ç«¯ç¼“å­˜"><a href="#æœåŠ¡ç«¯ç¼“å­˜" class="headerlink" title="æœåŠ¡ç«¯ç¼“å­˜"></a>æœåŠ¡ç«¯ç¼“å­˜</h3><h4 id="CDNç¼“å­˜"><a href="#CDNç¼“å­˜" class="headerlink" title="CDNç¼“å­˜"></a>CDNç¼“å­˜</h4><p>CDNç¼“å­˜ï¼Œä¹Ÿå«ç½‘å…³ç¼“å­˜ã€åå‘ä»£ç†ç¼“å­˜ã€‚æµè§ˆå™¨å…ˆå‘CDNç½‘å…³å‘èµ·WEBè¯·æ±‚ï¼Œç½‘å…³æœåŠ¡å™¨åé¢å¯¹åº”ç€ä¸€å°æˆ–å¤šå°è´Ÿè½½å‡è¡¡æºæœåŠ¡å™¨ï¼Œä¼šæ ¹æ®å®ƒä»¬çš„è´Ÿè½½è¯·æ±‚ï¼ŒåŠ¨æ€åœ°è¯·æ±‚è½¬å‘åˆ°åˆé€‚çš„æºæœåŠ¡å™¨ä¸Šã€‚</p><p>CDNè¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜ç­–ç•¥å› æœåŠ¡å•†ä¸åŒè€Œä¸åŒï¼Œä½†ä¸€èˆ¬éƒ½ä¼šéµå¾ªhttpæ ‡å‡†åè®®ï¼Œé€šè¿‡httpå“åº”å¤´ä¸­çš„Cache-control: max-ageçš„å­—æ®µæ¥è®¾ç½®CDNè¾¹ç¼˜èŠ‚ç‚¹æ•°æ®ç¼“å­˜æ—¶é—´ã€‚</p><p>å½“å®¢æˆ·ç«¯å‘CDNèŠ‚ç‚¹è¯·æ±‚æ•°æ®æ—¶ï¼ŒCDNèŠ‚ç‚¹ä¼šåˆ¤æ–­ç¼“å­˜æ•°æ®æ˜¯å¦è¿‡æœŸï¼Œè‹¥ç¼“å­˜æ•°æ®å¹¶æ²¡æœ‰è¿‡æœŸï¼Œåˆ™ç›´æ¥å°†ç¼“å­˜æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼›å¦åˆ™ï¼ŒCDNèŠ‚ç‚¹å°±ä¼šå‘æºç«™å‘å‡ºå›æºè¯·æ±‚ï¼ˆback to the source requestï¼‰ï¼Œä»æºç«™æ‹‰å–æœ€æ–°æ•°æ®ï¼Œæ›´æ–°æœ¬åœ°ç¼“å­˜ï¼Œå¹¶å°†æœ€æ–°æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><h3 id="HTML5ç¼“å­˜"><a href="#HTML5ç¼“å­˜" class="headerlink" title="HTML5ç¼“å­˜"></a>HTML5ç¼“å­˜</h3><h4 id="application-cacheç¦»çº¿ç¼“å­˜"><a href="#application-cacheç¦»çº¿ç¼“å­˜" class="headerlink" title="application cacheç¦»çº¿ç¼“å­˜"></a>application cacheç¦»çº¿ç¼“å­˜</h4><p>ç¦»çº¿ç¼“å­˜æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li>ç”¨æˆ·å¯ç¦»çº¿è®¿é—®ä½ çš„åº”ç”¨ï¼Œè¿™å¯¹äºæ— æ³•éšæ—¶ä¿æŒè”ç½‘çŠ¶æ€çš„ç§»åŠ¨ç»ˆç«¯ç”¨æˆ·æ¥è¯´å°¤å…¶é‡è¦</li><li>ç”¨æˆ·è®¿é—®æœ¬åœ°çš„ç¼“å­˜æ–‡ä»¶ï¼Œé€šå¸¸æ„å‘³ç€æ›´å¿«çš„è®¿é—®é€Ÿåº¦</li><li>ä»…ä»…åŠ è½½è¢«ä¿®æ”¹è¿‡çš„èµ„æºï¼Œé¿å…åŒä¸€èµ„æºå¯¹æœåŠ¡å™¨å¤šæ¬¡çš„è¯·æ±‚ï¼Œå¤§å¤§é™ä½äº†å¯¹æœåŠ¡å™¨çš„è®¿é—®å‹åŠ›</li></ul><p>å®ç°æ–¹æ³•æ˜¯åœ¨<code>html</code>æ ‡ç­¾ä¸­é…ç½®æŒ‡å®šçš„<code>manifest</code>æ–‡ä»¶(<code>&lt;html manifest=&quot;demo.manifest&quot;&gt;</code>)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CACHE MANIFEST</span><br><span class="line"># wanz app v1</span><br><span class="line"></span><br><span class="line"># æŒ‡æ˜ç¼“å­˜å…¥å£</span><br><span class="line">CACHE:</span><br><span class="line">index.html</span><br><span class="line">style.css</span><br><span class="line">images/logo.png</span><br><span class="line">scripts/main.js</span><br><span class="line"></span><br><span class="line"># ä»¥ä¸‹èµ„æºå¿…é¡»åœ¨çº¿è®¿é—®</span><br><span class="line">NETWORK:</span><br><span class="line">login.php</span><br><span class="line"></span><br><span class="line"># å¦‚æœindex.phpæ— æ³•è®¿é—®åˆ™ç”¨404.htmlä»£æ›¿</span><br><span class="line">FALLBACK:</span><br><span class="line">/index.php /404.html</span><br></pre></td></tr></table></figure></p><p>åœ¨æ–‡ä»¶ä¸­é…åˆjsä½¿ç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.applicationCache.addEventListener(<span class="string">'updateready'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.applicationCache.status === <span class="built_in">window</span>.applicationCache.UPDATEREADY) &#123;</span><br><span class="line">    <span class="built_in">window</span>.applicationCache.swapCache();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªè¿‡ç¨‹ä¸­æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼š</p><ul><li>å¦‚æœæœåŠ¡å™¨å¯¹ç¦»çº¿çš„èµ„æºè¿›è¡Œäº†æ›´æ–°ï¼Œé‚£ä¹ˆå¿…é¡»æ›´æ–°manifestæ–‡ä»¶ä¹‹åè¿™äº›èµ„æºæ‰èƒ½è¢«æµè§ˆå™¨é‡æ–°ä¸‹è½½ï¼Œå¦‚æœåªæ˜¯æ›´æ–°äº†èµ„æºè€Œæ²¡æœ‰æ›´æ–°manifestæ–‡ä»¶çš„è¯ï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šé‡æ–°ä¸‹è½½èµ„æºï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æ˜¯ä½¿ç”¨åŸæ¥ç¦»çº¿å­˜å‚¨çš„èµ„æºã€‚</li><li>å¯¹äºmanifestæ–‡ä»¶è¿›è¡Œç¼“å­˜çš„æ—¶å€™éœ€è¦ååˆ†å°å¿ƒï¼Œå› ä¸ºå¯èƒ½å‡ºç°ä¸€ç§æƒ…å†µå°±æ˜¯ä½ å¯¹manifestæ–‡ä»¶è¿›è¡Œäº†æ›´æ–°ï¼Œä½†æ˜¯httpçš„ç¼“å­˜è§„åˆ™å‘Šè¯‰æµè§ˆå™¨æœ¬åœ°ç¼“å­˜çš„manifestæ–‡ä»¶è¿˜æ²¡è¿‡æœŸï¼Œè¿™ä¸ªæƒ…å†µä¸‹æµè§ˆå™¨è¿˜æ˜¯ä½¿ç”¨åŸæ¥çš„manifestæ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹äºmanifestæ–‡ä»¶æœ€å¥½ä¸è¦è®¾ç½®ç¼“å­˜ã€‚</li><li>æµè§ˆå™¨åœ¨ä¸‹è½½manifestæ–‡ä»¶ä¸­çš„èµ„æºçš„æ—¶å€™ï¼Œå®ƒä¼šä¸€æ¬¡æ€§ä¸‹è½½æ‰€æœ‰èµ„æºï¼Œå¦‚æœæŸä¸ªèµ„æºç”±äºæŸç§åŸå› ä¸‹è½½å¤±è´¥ï¼Œé‚£ä¹ˆè¿™æ¬¡çš„æ‰€æœ‰æ›´æ–°å°±ç®—æ˜¯å¤±è´¥çš„ï¼Œæµè§ˆå™¨è¿˜æ˜¯ä¼šä½¿ç”¨åŸæ¥çš„èµ„æºã€‚</li><li>åœ¨æ›´æ–°äº†èµ„æºä¹‹åï¼Œæ–°çš„èµ„æºéœ€è¦åˆ°ä¸‹æ¬¡å†æ‰“å¼€appæ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœéœ€è¦èµ„æºé©¬ä¸Šå°±èƒ½ç”Ÿæ•ˆï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>window.applicationCache.swapCache()</code>æ–¹æ³•æ¥ä½¿ä¹‹ç”Ÿæ•ˆï¼Œå‡ºç°è¿™ç§ç°è±¡çš„åŸå› æ˜¯æµè§ˆå™¨ä¼šå…ˆä½¿ç”¨ç¦»çº¿èµ„æºåŠ è½½é¡µé¢ï¼Œç„¶åå†å»æ£€æŸ¥manifestæ˜¯å¦æœ‰æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åˆ°ä¸‹æ¬¡æ‰“å¼€é¡µé¢æ‰èƒ½ç”Ÿæ•ˆã€‚</li><li>é…ç½®manifestçš„<strong>index.htmlæ–‡ä»¶ä¹Ÿä¼šè¢«ç¼“å­˜</strong>ã€‚</li></ul><h4 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h4><p><code>cookie</code>éå¸¸å°ï¼Œå®ƒçš„å¤§å°é™åˆ¶ä¸º4KBå·¦å³ã€‚ä¸»è¦ç”¨é€”æœ‰ä¿å­˜ç™»å½•ä¿¡æ¯ï¼Œåšèº«ä»½è®¤è¯ã€‚<br>cookieæ˜¯ä¸å¯è·¨åŸŸçš„ï¼Œä»–ä¼šæ ¹æ®åŸŸåæ¥åŒºåˆ†æ˜¯å‘å“ªä¸ªæœåŠ¡å™¨å‘é€æ•°æ®ã€‚</p><h4 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h4><p>sessionStorageå’ŒlocalStorageæ˜¯html5æä¾›çš„ä¸¤ç§æœ¬åœ°å­˜å‚¨æ–¹å¼ï¼Œåªä¼šå­˜åœ¨æœ¬åœ°ï¼Œå¤§å°è¦æ¯”cookieå¤§</p><p>sessionStorageæ˜¯ç”¨æˆ·ä»æ‰“å¼€å›è¯çª—åˆ°å…³é—­ä¼šè¯çª—è¿™ä¸€æ®µæ—¶é—´æœ‰æ•ˆï¼Œå…³é—­ä¹‹åå­˜çš„æ•°æ®å°±ä¼šè¢«åˆ é™¤ã€‚</p><p><strong>åˆ·æ–°é¡µé¢æ•°æ®ä¾æ—§å­˜åœ¨ï¼Œä½†ä¸åŒä¼šè¯çª—å£ä¹‹é—´ä¸åŒäº«</strong></p><h4 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h4><p>ä¸¥æ ¼è¯´æ¥localStorageæ›´åƒæ˜¯cookieä¸€ç±»çš„æœ¬åœ°æ•°æ®å­˜å‚¨ã€‚ä½†åœ¨æ ‡å‡†ç¼“å­˜ä¹‹å¤–ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç”¨æµè§ˆå™¨çš„ä¸€äº›åŠŸèƒ½æ¥å®ç°è‡ªå®šä¹‰çš„å®¢æˆ·ç«¯â€œç¼“å­˜â€ã€‚</p><p>ä¸sessionStroageä¸»è¦çš„åŒºåˆ«æ˜¯å­˜å‚¨æ—¶é—´å’Œä½œç”¨åŸŸã€‚</p><p>LocalStorageæ˜¯ä¸€ç§æœ¬åœ°å­˜å‚¨çš„å…¬å…±èµ„æºï¼ŒåŸŸåä¸‹å¾ˆå¤šåº”ç”¨å…±äº«è¿™ä»½èµ„æºä¼šæœ‰é£é™©ï¼›<br>LocalStorageæ˜¯ä»¥é¡µé¢åŸŸååˆ’åˆ†çš„ï¼Œå¦‚æœæœ‰å¤šä¸ªç­‰ä»·åŸŸåä¹‹é—´çš„LocalStorageä¸äº’é€šï¼Œåˆ™ä¼šé€ æˆç¼“å­˜å¤šä»½æµªè´¹ã€‚</p><p>LocalStorageåœ¨PCä¸Šçš„å…¼å®¹æ€§ä¸å¤ªå¥½ï¼Œè€Œä¸”å½“ç½‘ç»œé€Ÿåº¦å¿«ã€åå•†ç¼“å­˜å“åº”å¿«æ—¶ä½¿ç”¨localStorageçš„é€Ÿåº¦æ¯”ä¸ä¸Š304ã€‚<br>å¹¶ä¸”ä¸èƒ½ç¼“å­˜cssæ–‡ä»¶ã€‚è€Œç§»åŠ¨ç«¯ç”±äºç½‘é€Ÿæ…¢ï¼Œä½¿ç”¨localStorageè¦å¿«äº304ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.alloyteam.com/2016/03/discussion-on-web-caching/" target="_blank" rel="noopener">æµ…è°ˆWebç¼“å­˜</a></li><li><a href="http://imweb.io/topic/55c6f9bac222e3af6ce235b9" target="_blank" rel="noopener">ç¼“å­˜ç­–ç•¥</a></li><li><a href="http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part1" target="_blank" rel="noopener">å‰ç«¯å·¥ç¨‹ç²¾ç²¹ï¼ˆä¸€ï¼‰ï¼šé™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜</a></li><li><a href="http://jerryzou.com/posts/cookie-and-web-storage/" target="_blank" rel="noopener">è¯¦è¯´ Cookie, LocalStorage ä¸ SessionStorage</a></li><li><a href="https://segmentfault.com/a/1190000012478396" target="_blank" rel="noopener">å‰ç«¯å­˜å‚¨æµ…è°ˆâ€”â€”cookieã€sessionStorageã€localStorage</a></li><li><a href="https://segmentfault.com/a/1190000010400892" target="_blank" rel="noopener">cookieã€sessionStorageã€localStorage è¯¦è§£åŠåº”ç”¨åœºæ™¯</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½ä¸€ç›´éƒ½æ˜¯è¢«å¤§å®¶æ‰€é‡è§†çš„ä¸€ç‚¹ï¼Œç„¶è€Œåˆ¤æ–­ä¸€ä¸ªç½‘ç«™çš„æ€§èƒ½æœ€ç›´è§‚çš„å°±æ˜¯çœ‹ç½‘é¡µæ‰“å¼€çš„é€Ÿåº¦ã€‚å…¶ä¸­æé«˜ç½‘é¡µååº”é€Ÿåº¦çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯ä½¿ç”¨ç¼“å­˜ã€‚ä¸€ä¸ªä¼˜ç§€çš„ç¼“å­˜ç­–ç•¥å¯ä»¥ç¼©çŸ­ç½‘é¡µè¯·æ±‚èµ„æºçš„è·ç¦»ï¼Œå‡å°‘å»¶è¿Ÿï¼Œå¹¶ä¸”ç”±äºç¼“å­˜æ–‡ä»¶å¯ä»¥é‡å¤åˆ©ç”¨ï¼Œè¿˜å¯ä»¥å‡å°‘å¸¦å®½ï¼Œé™ä½ç½‘ç»œè´Ÿè·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæ•´ç†ä¸€äº›webç¼“å­˜çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ç¼“å­˜åˆ†ç±»&quot;&gt;&lt;a href=&quot;#ç¼“å­˜åˆ†ç±»&quot; class=&quot;headerlink&quot; title=&quot;ç¼“å­˜åˆ†ç±»&quot;&gt;&lt;/a&gt;ç¼“å­˜åˆ†ç±»&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/classify.png&quot; alt=&quot;ç¼“å­˜åˆ†ç±»&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="ç¼“å­˜" scheme="https://sampwood.github.io/tags/%E7%BC%93%E5%AD%98/"/>
    
  </entry>
  
  <entry>
    <title>threejs study</title>
    <link href="https://sampwood.github.io/2018/06/03/threejs-study/"/>
    <id>https://sampwood.github.io/2018/06/03/threejs-study/</id>
    <published>2018-06-03T09:20:56.000Z</published>
    <updated>2019-03-06T05:51:53.739Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h3><p>threejsæ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºä¸‰ç»´å›¾å½¢åº”ç”¨çš„jsåº“ã€‚<br>è¯´åˆ°ä¸‰ç»´å›¾å½¢åº”ç”¨ï¼Œå°±ä¸å¾—ä¸æä¸€å¥webGLã€‚åœ¨ç™¾åº¦ç™¾ç§‘ä¸­æ˜¯è¿™ä¹ˆæè¿°webGLçš„ï¼š<br><code>WebGLï¼ˆå…¨å†™Web Graphics Libraryï¼‰æ˜¯ä¸€ç§3Dç»˜å›¾åè®®ï¼Œè¿™ç§ç»˜å›¾æŠ€æœ¯æ ‡å‡†å…è®¸æŠŠJavaScriptå’ŒOpenGL ES 2.0ç»“åˆåœ¨ä¸€èµ·ï¼Œé€šè¿‡å¢åŠ OpenGL ES 2.0çš„ä¸€ä¸ªJavaScriptç»‘å®šï¼ŒWebGLå¯ä»¥ä¸ºHTML5 Canvasæä¾›ç¡¬ä»¶3DåŠ é€Ÿæ¸²æŸ“ï¼Œè¿™æ ·Webå¼€å‘äººå‘˜å°±å¯ä»¥å€ŸåŠ©ç³»ç»Ÿæ˜¾å¡æ¥åœ¨æµè§ˆå™¨é‡Œæ›´æµç•…åœ°å±•ç¤º3Dåœºæ™¯å’Œæ¨¡å‹äº†ï¼Œè¿˜èƒ½åˆ›å»ºå¤æ‚çš„å¯¼èˆªå’Œæ•°æ®è§†è§‰åŒ–ã€‚</code><br>ä¹Ÿå°±æ˜¯è¯´ï¼š<code>WebGLå¯ä»¥çœ‹åšæ˜¯å°†OpenGL ESï¼ˆOpenGL for Embedded Systemsï¼ŒOpenGLåµŒå…¥å¼ç‰ˆæœ¬ï¼Œé’ˆå¯¹æ‰‹æœºã€æ¸¸æˆæœºç­‰è®¾å¤‡ç›¸å¯¹è¾ƒè½»é‡çº§çš„ç‰ˆæœ¬ï¼‰ç§»æ¤åˆ°äº†ç½‘é¡µå¹³å°</code>ã€‚</p><p>Three.jså°è£…äº†åº•å±‚çš„å›¾å½¢æ¥å£ï¼Œä½¿å¾—ç¨‹åºå‘˜èƒ½å¤Ÿåœ¨æ— éœ€æŒæ¡ç¹å†—çš„å›¾å½¢å­¦çŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ç”¨ç®€å•çš„ä»£ç å®ç°ä¸‰ç»´åœºæ™¯çš„æ¸²æŸ“ã€‚<br>é™¤äº†WebGLä¹‹å¤–ï¼ŒThree.jsè¿˜æä¾›äº†åŸºäºCanvasã€SVGæ ‡ç­¾çš„æ¸²æŸ“å™¨ã€‚</p><a id="more"></a><p>ä¸‹é¢å°±å¼€å§‹å…·ä½“è¯´ä¸‹threejsçš„ä»£ç å®ç°ã€‚</p><h4 id="hello-world"><a href="#hello-world" class="headerlink" title="hello, world!"></a>hello, world!</h4><p>ä¸€ä¸ªå…¸å‹çš„Three.jsç¨‹åºè‡³å°‘è¦åŒ…æ‹¬æ¸²æŸ“å™¨ï¼ˆRendererï¼‰ã€åœºæ™¯ï¼ˆSceneï¼‰ã€ç…§ç›¸æœºï¼ˆCameraï¼‰ï¼Œä»¥åŠä½ åœ¨åœºæ™¯ä¸­åˆ›å»ºçš„ç‰©ä½“ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¸²æŸ“å™¨ï¼ˆRendererï¼‰</span></span><br><span class="line"><span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer(&#123;</span><br><span class="line">    canvas: <span class="built_in">document</span>.getElementById(<span class="string">'mainCanvas'</span>) <span class="comment">// å…ˆè¦åœ¨htmlä¸­å®šä¹‰idä¸ºmainCanvasçš„&lt;canvas&gt;&lt;/canvas&gt;å…ƒç´ </span></span><br><span class="line">&#125;);</span><br><span class="line">renderer.setClearColor(<span class="number">0x000000</span>); <span class="comment">// è®¾ç½®èƒŒæ™¯è‰²</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åœºæ™¯ï¼ˆsceneï¼‰ï¼šç›¸å½“äºå¤§çš„å®¹å™¨</span></span><br><span class="line"><span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene(); <span class="comment">// ä¸€èˆ¬è¯´ï¼Œåœºæ™¯é‡Œæ²¡æœ‰å¾ˆå¤æ‚çš„æ“ä½œï¼Œåœ¨ç¨‹åºæœ€å¼€å§‹çš„æ—¶å€™è¿›è¡Œå®ä¾‹åŒ–ï¼Œç„¶åå°†ç‰©ä½“æ·»åŠ åˆ°åœºæ™¯ä¸­å³å¯ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç…§ç›¸æœºï¼ˆCameraï¼‰</span></span><br><span class="line"><span class="keyword">var</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">45</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">1</span>, <span class="number">1000</span>); <span class="comment">// è¿™ä¸ªæ˜¯é€è§†ç›¸æœºã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–ç›¸æœº</span></span><br><span class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">scene.add(camera);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‰©ä½“</span></span><br><span class="line"><span class="keyword">var</span> cube = <span class="keyword">new</span> THREE.Mesh(<span class="keyword">new</span> THREE.CubeGeometry(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="comment">// CubeGeometryæ˜¯é•¿æ–¹ä½“</span></span><br><span class="line">    <span class="keyword">new</span> THREE.MeshBasicMaterial(&#123; <span class="comment">// materialæ˜¯æè´¨ï¼Œç”¨äºç‰©ä½“çš„é¢œè‰²ï¼Œè´´å›¾ä¹‹ç±»çš„</span></span><br><span class="line">        color: <span class="number">0xff0000</span></span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br><span class="line">scene.add(cube);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€åä¸€æ­¥ï¼šæ¸²æŸ“</span></span><br><span class="line">renderer.render(scene, camera);</span><br></pre></td></tr></table></figure></p><h3 id="ç›¸æœº"><a href="#ç›¸æœº" class="headerlink" title="ç›¸æœº"></a>ç›¸æœº</h3><p>WebGLå’ŒThree.jsä½¿ç”¨çš„åæ ‡ç³»æ˜¯å³æ‰‹åæ ‡ç³»ã€‚</p><p><img src="/images/threejs-coordinate.png" alt="åæ ‡ç³»"></p><p>é’ˆå¯¹æŠ•å½±æ–¹å¼çš„ä¸åŒï¼Œç…§ç›¸æœºåˆåˆ†ä¸ºæ­£äº¤æŠ•å½±ç…§ç›¸æœºï¼ˆOrthographic Cameraï¼‰ä¸é€è§†æŠ•å½±ç…§ç›¸æœºï¼ˆPerspective Cameraï¼‰ã€‚</p><h4 id="æ­£äº¤æŠ•å½±ç…§ç›¸æœº"><a href="#æ­£äº¤æŠ•å½±ç…§ç›¸æœº" class="headerlink" title="æ­£äº¤æŠ•å½±ç…§ç›¸æœº"></a>æ­£äº¤æŠ•å½±ç…§ç›¸æœº</h4><p>æ­£äº¤æŠ•å½±ç…§ç›¸æœºï¼ˆOrthographic Cameraï¼‰è®¾ç½®èµ·æ¥è¾ƒä¸ºç›´è§‚ï¼Œå®ƒçš„æ„é€ å‡½æ•°æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.OrthographicCamera(left, right, top, bottom, near, far)</span><br></pre></td></tr></table></figure><p>è¿™å…­ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨æ­£äº¤æŠ•å½±ç…§ç›¸æœºæ‹æ‘„åˆ°çš„ç©ºé—´çš„å…­ä¸ªé¢çš„ä½ç½®ï¼Œè¿™å…­ä¸ªé¢å›´æˆä¸€ä¸ªé•¿æ–¹ä½“ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºè§†æ™¯ä½“ï¼ˆFrustumï¼‰ã€‚åªæœ‰åœ¨è§†æ™¯ä½“å†…éƒ¨ï¼ˆä¸‹å›¾ä¸­çš„ç°è‰²éƒ¨åˆ†ï¼‰çš„ç‰©ä½“æ‰å¯èƒ½æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè€Œè§†æ™¯ä½“å¤–çš„ç‰©ä½“ä¼šåœ¨æ˜¾ç¤ºä¹‹å‰è¢«è£å‡æ‰ã€‚</p><p><img src="/images/orthographic-camera.png" alt="æ­£äº¤ç›¸æœº"></p><p>ä¸ºäº†ä¿æŒç…§ç›¸æœºçš„æ¨ªç«–æ¯”ä¾‹ï¼Œéœ€è¦ä¿è¯(right - left)ä¸(top - bottom)çš„æ¯”ä¾‹ä¸Canvaså®½åº¦ä¸é«˜åº¦çš„æ¯”ä¾‹ä¸€è‡´ã€‚(ps: å…¶å®æ„æ€æ˜¯å¦‚æœæ¯”ä¾‹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œä¼šç”¨ç›¸æœºçš„å†…å®¹å»å¡«å……canvasçš„å¤§å°ï¼Œæ‰€ä»¥ç›¸æœºçš„å†…å®¹çš„é•¿å®½ä¼šè¢«ç›¸åº”çš„æ‹‰ä¼¸)</p><p>nearä¸faréƒ½æ˜¯æŒ‡åˆ°ç…§ç›¸æœºä½ç½®åœ¨æ·±åº¦å¹³é¢çš„ä½ç½®ï¼Œè€Œç…§ç›¸æœºä¸åº”è¯¥æ‹æ‘„åˆ°å…¶åæ–¹çš„ç‰©ä½“ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå€¼åº”è¯¥å‡ä¸ºæ­£å€¼ã€‚ä¸ºäº†ä¿è¯åœºæ™¯ä¸­çš„ç‰©ä½“ä¸ä¼šå› ä¸ºå¤ªè¿‘æˆ–å¤ªè¿œè€Œè¢«ç…§ç›¸æœºå¿½ç•¥ï¼Œä¸€èˆ¬nearçš„å€¼è®¾ç½®å¾—è¾ƒå°ï¼Œfarçš„å€¼è®¾ç½®å¾—è¾ƒå¤§ï¼Œå…·ä½“å€¼è§†åœºæ™¯ä¸­ç‰©ä½“çš„ä½ç½®ç­‰å†³å®šã€‚</p><p>ä½¿ç”¨å®ä¾‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> camera = <span class="keyword">new</span> THREE.OrthographicCamera(<span class="number">-2</span>, <span class="number">2</span>, <span class="number">1.5</span>, <span class="number">-1.5</span>, <span class="number">1</span>, <span class="number">10</span>); <span class="comment">// åˆ›å»ºå®ä¾‹</span></span><br><span class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>); <span class="comment">// è®¾ç½®ä½ç½®</span></span><br><span class="line">camera.lookAt(<span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)); <span class="comment">// é»˜è®¤ç…§ç›¸æœºæ˜¯æ²¿zè½´è´Ÿæ–¹å‘è§‚å¯Ÿçš„ï¼Œå¯ä»¥é€šè¿‡lookAtå‡½æ•°æŒ‡å®šå®ƒçœ‹ç€åŸç‚¹æ–¹å‘ã€‚</span></span><br></pre></td></tr></table></figure></p><h4 id="é€è§†æŠ•å½±ç…§ç›¸æœº"><a href="#é€è§†æŠ•å½±ç…§ç›¸æœº" class="headerlink" title="é€è§†æŠ•å½±ç…§ç›¸æœº"></a>é€è§†æŠ•å½±ç…§ç›¸æœº</h4><p>é€è§†æŠ•å½±ç…§ç›¸æœºï¼ˆPerspective Cameraï¼‰çš„æ„é€ å‡½æ•°æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.PerspectiveCamera(fov, aspect, near, far)</span><br></pre></td></tr></table></figure><p><img src="/images/perspective-camera.png" alt="é€è§†ç›¸æœº"></p><p>é€è§†å›¾ä¸­ï¼Œç°è‰²çš„éƒ¨åˆ†æ˜¯è§†æ™¯ä½“ï¼Œæ˜¯å¯èƒ½è¢«æ¸²æŸ“çš„ç‰©ä½“æ‰€åœ¨çš„åŒºåŸŸã€‚fovæ˜¯è§†æ™¯ä½“ç«–ç›´æ–¹å‘ä¸Šçš„å¼ è§’ï¼ˆæ˜¯è§’åº¦åˆ¶è€Œéå¼§åº¦åˆ¶ï¼‰ï¼Œå¦‚ä¾§è§†å›¾æ‰€ç¤ºã€‚<br>aspectç­‰äºwidth / heightï¼Œæ˜¯ç…§ç›¸æœºæ°´å¹³æ–¹å‘å’Œç«–ç›´æ–¹å‘é•¿åº¦çš„æ¯”å€¼ï¼Œé€šå¸¸è®¾ä¸ºCanvasçš„æ¨ªçºµæ¯”ä¾‹ã€‚<br>nearå’Œfaråˆ†åˆ«æ˜¯ç…§ç›¸æœºåˆ°è§†æ™¯ä½“æœ€è¿‘ã€æœ€è¿œçš„è·ç¦»ï¼Œå‡ä¸ºæ­£å€¼ï¼Œä¸”faråº”å¤§äºnearã€‚</p><p>ä½¿ç”¨å®ä¾‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">45</span>, <span class="number">400</span> / <span class="number">300</span>, <span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure></p><h3 id="ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰"><a href="#ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰" class="headerlink" title="ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰"></a>ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰</h3><p>åœ¨åˆ›å»ºç‰©ä½“æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡ ä½•å½¢çŠ¶ï¼ˆGeometryï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æè´¨ï¼ˆMaterialï¼‰ã€‚</p><h4 id="å‡ ä½•å½¢çŠ¶"><a href="#å‡ ä½•å½¢çŠ¶" class="headerlink" title="å‡ ä½•å½¢çŠ¶"></a>å‡ ä½•å½¢çŠ¶</h4><p>å‡ ä½•å½¢çŠ¶ï¼ˆGeometryï¼‰æœ€ä¸»è¦çš„åŠŸèƒ½æ˜¯å‚¨å­˜äº†ä¸€ä¸ªç‰©ä½“çš„é¡¶ç‚¹ä¿¡æ¯ã€‚WebGLéœ€è¦ç¨‹åºå‘˜æŒ‡å®šæ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ï¼Œè€Œåœ¨Three.jsä¸­ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šä¸€äº›ç‰¹å¾æ¥åˆ›å»ºå‡ ä½•å½¢çŠ¶ï¼Œä¾‹å¦‚ä½¿ç”¨åŠå¾„åˆ›å»ºä¸€ä¸ªçƒä½“ï¼Œä»è€Œçœå»ç¨‹åºå‘˜ä¸€ä¸ªä¸ªæŒ‡å®šé¡¶ç‚¹çš„å·¥ä½œé‡ã€‚</p><h5 id="åŸºæœ¬å‡ ä½•å½¢çŠ¶"><a href="#åŸºæœ¬å‡ ä½•å½¢çŠ¶" class="headerlink" title="åŸºæœ¬å‡ ä½•å½¢çŠ¶"></a>åŸºæœ¬å‡ ä½•å½¢çŠ¶</h5><p>åœ¨é•¿æ–¹ä½“ä¸­ï¼Œwidthæ˜¯xæ–¹å‘ä¸Šçš„é•¿åº¦ï¼›heightæ˜¯yæ–¹å‘ä¸Šçš„é•¿åº¦ï¼›depthæ˜¯zæ–¹å‘ä¸Šçš„é•¿åº¦ï¼›åä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯åœ¨ä¸‰ä¸ªæ–¹å‘ä¸Šçš„åˆ†æ®µæ•°ï¼Œå¦‚widthSegmentsä¸º3çš„è¯ï¼Œä»£è¡¨xæ–¹å‘ä¸Šæ°´å¹³åˆ†ä¸ºä¸‰ä»½ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦åˆ†æ®µçš„è¯ï¼Œå¯ä»¥ä¸è®¾ç½®åä¸‰ä¸ªå‚æ•°ï¼Œåä¸‰ä¸ªå‚æ•°çš„ç¼ºçœå€¼ä¸º1ã€‚å…¶ä»–å‡ ä½•å½¢çŠ¶ä¸­çš„åˆ†æ®µä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸‹é¢ä¸åšè¯´æ˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è™½ç„¶è¿™ä¸€å½¢çŠ¶çš„åå­—å«ç«‹æ–¹ä½“ï¼ˆCubeGeometryï¼‰ï¼Œä½†å®ƒå…¶å®æ˜¯é•¿æ–¹ä½“ï¼Œä¹Ÿå°±æ˜¯é•¿å®½é«˜å¯ä»¥è®¾ç½®ä¸ºä¸åŒçš„å€¼ã€‚å…¶æ„é€ å‡½æ•°æ˜¯ï¼š</span></span><br><span class="line"><span class="keyword">new</span> THREE.CubeGeometry(width, height, depth, widthSegments, heightSegments, depthSegments)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹³é¢ï¼Œè¿™é‡Œçš„å¹³é¢ï¼ˆPlaneGeometryï¼‰å…¶å®æ˜¯ä¸€ä¸ªé•¿æ–¹å½¢ï¼Œè€Œä¸æ˜¯æ•°å­¦æ„ä¹‰ä¸Šæ— é™å¤§å°çš„å¹³é¢</span></span><br><span class="line"><span class="keyword">new</span> THREE.PlaneGeometry(width, height, widthSegments, heightSegments)</span><br><span class="line"></span><br><span class="line"><span class="comment">// çƒä½“</span></span><br><span class="line"><span class="keyword">new</span> THREE.SphereGeometry(radius, segmentsWidth, segmentsHeight, phiStart, phiLength, thetaStart, thetaLength)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ†å½¢</span></span><br><span class="line"><span class="keyword">new</span> THREE.CircleGeometry(radius, segments, thetaStart, thetaLength)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ†æŸ±ä½“</span></span><br><span class="line"><span class="keyword">new</span> THREE.CylinderGeometry(radiusTop, radiusBottom, height, radiusSegments, heightSegments, openEnded)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£å››é¢ä½“ã€æ­£å…«é¢ä½“ã€æ­£äºŒåé¢ä½“</span></span><br><span class="line"><span class="keyword">new</span> THREE.TetrahedronGeometry(radius, detail)</span><br><span class="line"><span class="keyword">new</span> THREE.OctahedronGeometry(radius, detail)</span><br><span class="line"><span class="keyword">new</span> THREE.IcosahedronGeometry(radius, detail)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ†ç¯é¢</span></span><br><span class="line"><span class="keyword">new</span> THREE.TorusGeometry(radius, tube, radialSegments, tubularSegments, arc)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ†ç¯ç»“</span></span><br><span class="line"><span class="keyword">new</span> THREE.TorusKnotGeometry(radius, tube, radialSegments, tubularSegments, p, q, heightScale)</span><br></pre></td></tr></table></figure><h5 id="æ–‡å­—å½¢çŠ¶"><a href="#æ–‡å­—å½¢çŠ¶" class="headerlink" title="æ–‡å­—å½¢çŠ¶"></a>æ–‡å­—å½¢çŠ¶</h5><p>æ–‡å­—å½¢çŠ¶ï¼ˆTextGeometryï¼‰å¯ä»¥ç”¨æ¥åˆ›å»ºä¸‰ç»´çš„æ–‡å­—å½¢çŠ¶ã€‚</p><p>åˆ›å»ºæ–‡å­—å½¢çŠ¶çš„æµç¨‹å’Œä¹‹å‰ä»‹ç»çš„åŸºæœ¬å‡ ä½•å½¢çŠ¶æ˜¯ç±»ä¼¼çš„ï¼Œå…¶æ„é€ å‡½æ•°æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.TextGeometry(text, parameters)</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ï¼Œtextæ˜¯æ–‡å­—å­—ç¬¦ä¸²ï¼Œparametersæ˜¯ä»¥ä¸‹å‚æ•°ç»„æˆçš„å¯¹è±¡ï¼š</p><ul><li>sizeï¼šå­—å·å¤§å°ï¼Œä¸€èˆ¬ä¸ºå¤§å†™å­—æ¯çš„é«˜åº¦</li><li>heightï¼šæ–‡å­—çš„åšåº¦</li><li>curveSegmentsï¼šå¼§çº¿åˆ†æ®µæ•°ï¼Œä½¿å¾—æ–‡å­—çš„æ›²çº¿æ›´åŠ å…‰æ»‘</li><li>fontï¼šå­—ä½“ï¼Œé»˜è®¤æ˜¯â€™helvetikerâ€™ï¼Œéœ€å¯¹åº”å¼•ç”¨çš„å­—ä½“æ–‡ä»¶</li><li>weightï¼šå€¼ä¸ºâ€™normalâ€™æˆ–â€™boldâ€™ï¼Œè¡¨ç¤ºæ˜¯å¦åŠ ç²—</li><li>styleï¼šå€¼ä¸ºâ€™normalâ€™æˆ–â€™italicsâ€™ï¼Œè¡¨ç¤ºæ˜¯å¦æ–œä½“</li><li>bevelEnabledï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦ä½¿ç”¨å€’è§’ï¼Œæ„ä¸ºåœ¨è¾¹ç¼˜å¤„æ–œåˆ‡</li><li>bevelThicknessï¼šå€’è§’åšåº¦</li><li>bevelSizeï¼šå€’è§’å®½åº¦</li></ul><p>ä½¿ç”¨æ–‡å­—å½¢çŠ¶éœ€è¦ä¸‹è½½å’Œå¼•ç”¨é¢å¤–çš„å­—ä½“åº“ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä»¥<code>helvetiker</code>å­—ä½“ä¸ºä¾‹ã€‚æˆ‘ä»¬åœ¨<code>Three.js GitHub master/examples/fonts</code>ç›®å½•ä¸‹ï¼Œä¸‹è½½<code>helvetiker_regular.typeface.json</code>æ–‡ä»¶æ”¾åœ¨ä½ çš„ç›®å½•ä¸‹ï¼Œç„¶åç”¨ä»¥ä¸‹æ–¹æ³•åŠ è½½ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loader = <span class="keyword">new</span> THREE.FontLoader();</span><br><span class="line">loader.load(<span class="string">'../lib/helvetiker_regular.typeface.json'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">font</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mesh = <span class="keyword">new</span> THREE.Mesh(<span class="keyword">new</span> THREE.TextGeometry(<span class="string">'Hello'</span>, &#123;</span><br><span class="line">        font: font,</span><br><span class="line">        size: <span class="number">1</span>,</span><br><span class="line">        height: <span class="number">1</span></span><br><span class="line">    &#125;), material);</span><br><span class="line">    scene.add(mesh);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// render</span></span><br><span class="line">    renderer.render(scene, camera);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h5 id="è‡ªå®šä¹‰å½¢çŠ¶"><a href="#è‡ªå®šä¹‰å½¢çŠ¶" class="headerlink" title="è‡ªå®šä¹‰å½¢çŠ¶"></a>è‡ªå®šä¹‰å½¢çŠ¶</h5><p>å¯¹äºThree.jsæ²¡æœ‰æä¾›çš„å½¢çŠ¶ï¼Œå¯ä»¥æä¾›è‡ªå®šä¹‰å½¢çŠ¶æ¥åˆ›å»ºã€‚<br>è‡ªå®šä¹‰å½¢çŠ¶ä½¿ç”¨çš„æ˜¯Geometryç±»ï¼Œå®ƒæ˜¯å…¶ä»–å¦‚CubeGeometryã€SphereGeometryç­‰å‡ ä½•å½¢çŠ¶çš„çˆ¶ç±»ï¼Œå…¶æ„é€ å‡½æ•°æ˜¯ï¼š<code>new THREE.Geometry()</code></p><h4 id="æè´¨"><a href="#æè´¨" class="headerlink" title="æè´¨"></a>æè´¨</h4><p>æè´¨ï¼ˆMaterialï¼‰æ˜¯ç‹¬ç«‹äºç‰©ä½“é¡¶ç‚¹ä¿¡æ¯ä¹‹å¤–çš„ä¸æ¸²æŸ“æ•ˆæœç›¸å…³çš„å±æ€§ã€‚é€šè¿‡è®¾ç½®æè´¨å¯ä»¥æ”¹å˜ç‰©ä½“çš„é¢œè‰²ã€çº¹ç†è´´å›¾ã€å…‰ç…§æ¨¡å¼ç­‰ã€‚</p><h5 id="åŸºæœ¬æè´¨"><a href="#åŸºæœ¬æè´¨" class="headerlink" title="åŸºæœ¬æè´¨"></a>åŸºæœ¬æè´¨</h5><p>ä½¿ç”¨åŸºæœ¬æè´¨ï¼ˆBasicMaterialï¼‰çš„ç‰©ä½“ï¼Œæ¸²æŸ“åç‰©ä½“çš„é¢œè‰²å§‹ç»ˆä¸ºè¯¥æè´¨çš„é¢œè‰²ï¼Œè€Œä¸ä¼šç”±äºå…‰ç…§äº§ç”Ÿæ˜æš—ã€é˜´å½±æ•ˆæœã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šæè´¨çš„é¢œè‰²ï¼Œåˆ™é¢œè‰²æ˜¯éšæœºçš„ã€‚å…¶æ„é€ å‡½æ•°æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.MeshBasicMaterial(opt)</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ï¼Œoptå¯ä»¥ç¼ºçœï¼Œæˆ–è€…ä¸ºåŒ…å«å„å±æ€§çš„å€¼ã€‚optå¯ä»¥æ˜¯ä»¥ä¸‹çš„å‡ ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„å±æ€§ï¼š</p><ul><li>visibleï¼šæ˜¯å¦å¯è§ï¼Œé»˜è®¤ä¸ºtrue</li><li>sideï¼šæ¸²æŸ“é¢ç‰‡æ­£é¢æˆ–æ˜¯åé¢ï¼Œé»˜è®¤ä¸ºæ­£é¢THREE.FrontSideï¼Œå¯è®¾ç½®ä¸ºåé¢THREE.BackSideï¼Œæˆ–åŒé¢THREE.DoubleSide</li><li>wireframeï¼šæ˜¯å¦æ¸²æŸ“çº¿è€Œéé¢ï¼Œé»˜è®¤ä¸ºfalse</li><li>colorï¼šåå…­è¿›åˆ¶RGBé¢œè‰²ï¼Œå¦‚çº¢è‰²è¡¨ç¤ºä¸º0xff0000</li><li>mapï¼šä½¿ç”¨çº¹ç†è´´å›¾</li></ul><h5 id="Lambertæè´¨"><a href="#Lambertæè´¨" class="headerlink" title="Lambertæè´¨"></a>Lambertæè´¨</h5><p>Lambertæè´¨ï¼ˆMeshLambertMaterialï¼‰æ˜¯ç¬¦åˆLambertå…‰ç…§æ¨¡å‹çš„æè´¨ã€‚Lambertå…‰ç…§æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹æ˜¯åªè€ƒè™‘æ¼«åå°„è€Œä¸è€ƒè™‘é•œé¢åå°„çš„æ•ˆæœï¼Œå› è€Œå¯¹äºé‡‘å±ã€é•œå­ç­‰éœ€è¦é•œé¢åå°„æ•ˆæœçš„ç‰©ä½“å°±ä¸é€‚åº”ï¼Œå¯¹äºå…¶ä»–å¤§éƒ¨åˆ†ç‰©ä½“çš„æ¼«åå°„æ•ˆæœéƒ½æ˜¯é€‚ç”¨çš„ã€‚<br>å…¶æ„é€ å‡½æ•°æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.MeshLambertMaterial(opt)</span><br></pre></td></tr></table></figure></p><p>optå¯ä»¥æ˜¯ä»¥ä¸‹çš„å±æ€§ï¼š</p><ul><li>coloræ˜¯ç”¨æ¥è¡¨ç°æè´¨å¯¹æ•£å°„å…‰çš„åå°„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨æ¥è®¾ç½®æè´¨é¢œè‰²çš„å±æ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨ambientå’Œemissiveæ§åˆ¶æè´¨çš„é¢œè‰²ã€‚</li><li>ambientè¡¨ç¤ºå¯¹ç¯å¢ƒå…‰çš„åå°„èƒ½åŠ›ï¼Œåªæœ‰å½“è®¾ç½®äº†AmbientLightåï¼Œè¯¥å€¼æ‰æ˜¯æœ‰æ•ˆçš„ï¼Œæè´¨å¯¹ç¯å¢ƒå…‰çš„åå°„èƒ½åŠ›ä¸ç¯å¢ƒå…‰å¼ºç›¸ä¹˜åå¾—åˆ°æè´¨å®é™…è¡¨ç°çš„é¢œè‰²ã€‚</li><li>emissiveæ˜¯æè´¨çš„è‡ªå‘å…‰é¢œè‰²ï¼Œå¯ä»¥ç”¨æ¥è¡¨ç°å…‰æºçš„é¢œè‰²</li></ul><h5 id="Phongæè´¨"><a href="#Phongæè´¨" class="headerlink" title="Phongæè´¨"></a>Phongæè´¨</h5><p>Phongæè´¨ï¼ˆMeshPhongMaterialï¼‰æ˜¯ç¬¦åˆPhongå…‰ç…§æ¨¡å‹çš„æè´¨ã€‚å’ŒLambertä¸åŒçš„æ˜¯ï¼ŒPhongæ¨¡å‹è€ƒè™‘äº†é•œé¢åå°„çš„æ•ˆæœï¼Œå› æ­¤å¯¹äºé‡‘å±ã€é•œé¢çš„è¡¨ç°å°¤ä¸ºé€‚åˆã€‚<br>å…¶æ„é€ å‡½æ•°æ˜¯ï¼š<code>new THREE.MeshPhongMaterial(opt)</code></p><p>åŒæ ·åœ°ï¼Œå¯ä»¥æŒ‡å®šemissiveå’Œambientå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨specularå€¼æŒ‡å®šé•œé¢åå°„ç³»æ•°ä½œè¯´æ˜ã€‚</p><h5 id="æ³•å‘æè´¨"><a href="#æ³•å‘æè´¨" class="headerlink" title="æ³•å‘æè´¨"></a>æ³•å‘æè´¨</h5><p>æ³•å‘æè´¨å¯ä»¥å°†æè´¨çš„é¢œè‰²è®¾ç½®ä¸ºå…¶æ³•å‘é‡çš„æ–¹å‘ï¼Œæœ‰æ—¶å€™å¯¹äºè°ƒè¯•å¾ˆæœ‰å¸®åŠ©ã€‚<br>æ³•å‘æè´¨çš„è®¾å®šå¾ˆç®€å•ï¼Œç”šè‡³ä¸ç”¨è®¾ç½®ä»»ä½•å‚æ•°ï¼š<code>new THREE.MeshNormalMaterial()</code></p><h5 id="æè´¨çš„çº¹ç†è´´å›¾"><a href="#æè´¨çš„çº¹ç†è´´å›¾" class="headerlink" title="æè´¨çš„çº¹ç†è´´å›¾"></a>æè´¨çš„çº¹ç†è´´å›¾</h5><p>æè´¨çš„çº¹ç†è´´å›¾çš„æ„æ€å°±æ˜¯è¯´ï¼Œthreejså¯ä»¥æ”¯æŒæˆ‘ä»¬è‡ªå·±å€’å…¥å›¾ç‰‡ä½œä¸ºçº¹ç†è´´å›¾ï¼Œæ·»åŠ åˆ°ç›¸åº”çš„æè´¨ä¸­ã€‚</p><p>å®ä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªåŠ è½½å™¨</span></span><br><span class="line"><span class="keyword">var</span> loader = <span class="keyword">new</span> THREE.TextureLoader();</span><br><span class="line"><span class="comment">// åŠ è½½ä¸€ä¸ªèµ„æº</span></span><br><span class="line">loader.load(</span><br><span class="line">    <span class="comment">// èµ„æºé“¾æ¥</span></span><br><span class="line">    <span class="string">'src/img/chess.png'</span>,</span><br><span class="line">    <span class="comment">// èµ„æºåŠ è½½å®Œæˆåçš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"> texture </span>) </span>&#123;</span><br><span class="line">        <span class="comment">// do something with the texture</span></span><br><span class="line">        <span class="keyword">var</span> material = <span class="keyword">new</span> THREE.MeshBasicMaterial( &#123;</span><br><span class="line">            map: texture</span><br><span class="line">         &#125; );</span><br><span class="line">        <span class="keyword">var</span> plane = <span class="keyword">new</span> THREE.PlaneGeometry(<span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">var</span> cube = <span class="keyword">new</span> THREE.Mesh(plane, material);</span><br><span class="line">        scene.add(cube);</span><br><span class="line">        renderer.render(scene, camera); <span class="comment">// å¯¼å…¥çº¹ç†ä¹‹å‰ï¼Œå·²ç»å®Œæˆäº†ä¸€æ¬¡æ¸²æŸ“ï¼Œæ‰€ä»¥å¯¼å…¥ä¹‹åè¿˜éœ€è¦é‡æ–°æ¸²æŸ“</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// èµ„æºåŠ è½½è¿‡ç¨‹ä¸­çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"> xhr </span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log( (xhr.loaded / xhr.total * <span class="number">100</span>) + <span class="string">'% loaded'</span> );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// èµ„æºä¸‹è½½å‡ºé”™æ—¶çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"> xhr </span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log( <span class="string">'An error happened'</span> );</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><h4 id="ç½‘æ ¼"><a href="#ç½‘æ ¼" class="headerlink" title="ç½‘æ ¼"></a>ç½‘æ ¼</h4><p>ç½‘æ ¼æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§ç‰©ä½“ã€‚ç½‘æ ¼æ˜¯ç”±é¡¶ç‚¹ã€è¾¹ã€é¢ç­‰ç»„æˆçš„ç‰©ä½“ï¼›å…¶ä»–ç‰©ä½“åŒ…æ‹¬çº¿æ®µï¼ˆLineï¼‰ã€éª¨éª¼ï¼ˆBoneï¼‰ã€ç²’å­ç³»ç»Ÿï¼ˆParticleSystemï¼‰ç­‰ã€‚<br>ç½‘æ ¼çš„æ„é€ å‡½æ•°æ˜¯ï¼š<code>Mesh(geometry, material)</code></p><h5 id="ä¿®æ”¹å±æ€§"><a href="#ä¿®æ”¹å±æ€§" class="headerlink" title="ä¿®æ”¹å±æ€§"></a>ä¿®æ”¹å±æ€§</h5><p>é™¤äº†åœ¨æ„é€ å‡½æ•°ä¸­æŒ‡å®šæè´¨ï¼Œåœ¨ç½‘æ ¼è¢«åˆ›å»ºåï¼Œä¹Ÿèƒ½å¯¹æè´¨è¿›è¡Œä¿®æ”¹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªç½‘æ ¼</span></span><br><span class="line"><span class="keyword">var</span> material = <span class="keyword">new</span> THREE.MeshLambertMaterial(&#123;</span><br><span class="line">    color: <span class="number">0xffff00</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> geometry = <span class="keyword">new</span> THREE.CubeGeometry(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">var</span> mesh = <span class="keyword">new</span> THREE.Mesh(geometry, material);</span><br><span class="line">scene.add(mesh);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹ç½‘æ ¼é¢œè‰²</span></span><br><span class="line">mesh.material = <span class="keyword">new</span> THREE.MeshLambertMaterial(&#123;</span><br><span class="line">    color: <span class="number">0xff0000</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ä½ç½®</span></span><br><span class="line">mesh.position.z = <span class="number">1</span>;</span><br><span class="line">mesh.position.set(<span class="number">1.5</span>, <span class="number">-0.5</span>, <span class="number">0</span>);</span><br><span class="line">mesh.position = <span class="keyword">new</span> THREE.Vector3(<span class="number">1.5</span>, <span class="number">-0.5</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ç¼©æ”¾,å…·ä½“æ–¹æ³•ä¸ä¸Šä¾‹ç›¸åŒï¼Œåˆ†åˆ«è¡¨ç¤ºæ²¿xã€yã€zä¸‰è½´ç¼©æ”¾æˆ–æ—‹è½¬ã€‚</span></span><br><span class="line">mesh.scale =</span><br><span class="line"><span class="comment">// æ—‹è½¬,å…·ä½“æ–¹æ³•ä¸ä¸Šä¾‹ç›¸åŒï¼Œåˆ†åˆ«è¡¨ç¤ºæ²¿xã€yã€zä¸‰è½´ç¼©æ”¾æˆ–æ—‹è½¬ã€‚</span></span><br><span class="line">mesh.rotation =</span><br></pre></td></tr></table></figure></p><h3 id="åŠ¨ç”»"><a href="#åŠ¨ç”»" class="headerlink" title="åŠ¨ç”»"></a>åŠ¨ç”»</h3><p>æ­£å¦‚åŠ¨ç”»ç‰‡çš„åŸç†ä¸€æ ·ï¼ŒåŠ¨ç”»çš„æœ¬è´¨æ˜¯åˆ©ç”¨äº†äººçœ¼çš„è§†è§‰æš‚ç•™ç‰¹æ€§ï¼Œå¿«é€Ÿåœ°å˜æ¢ç”»é¢ï¼Œä»è€Œäº§ç”Ÿç‰©ä½“åœ¨è¿åŠ¨çš„å‡è±¡ã€‚è€Œå¯¹äºThree.jsç¨‹åºè€Œè¨€ï¼ŒåŠ¨ç”»çš„å®ç°ä¹Ÿæ˜¯é€šè¿‡åœ¨æ¯ç§’ä¸­å¤šæ¬¡é‡ç»˜ç”»é¢å®ç°çš„ã€‚<br>æ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>setInterval</code>æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨ï¼š<code>requestAnimationFrame</code>ã€‚</p><h4 id="ä½¿ç”¨stat-jsè§‚å¯ŸFPS"><a href="#ä½¿ç”¨stat-jsè§‚å¯ŸFPS" class="headerlink" title="ä½¿ç”¨stat.jsè§‚å¯ŸFPS"></a>ä½¿ç”¨stat.jsè§‚å¯ŸFPS</h4><p>stat.jsæ˜¯Three.jsçš„ä½œè€…Mr. Doobçš„å¦ä¸€ä¸ªæœ‰ç”¨çš„JavaScriptåº“ã€‚stat.jså°±èƒ½æä¾›å®æ—¶ç›‘æµ‹åŠ¨ç”»æ•ˆæœã€‚å®ä¾‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="/images/statjs.png" alt="statjs"></p><p>å®ä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹å…¶åˆå§‹åŒ–å¹¶å°†å…¶æ·»åŠ è‡³å±å¹•å³ä¸Šè§’</span></span><br><span class="line"><span class="keyword">var</span> stat = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    stat = <span class="keyword">new</span> Stats();</span><br><span class="line">    stat.domElement.style.position = <span class="string">'absolute'</span>;</span><br><span class="line">    stat.domElement.style.right = <span class="string">'0px'</span>;</span><br><span class="line">    stat.domElement.style.top = <span class="string">'0px'</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(stat.domElement);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Three.js init ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨åŠ¨ç”»é‡ç»˜å‡½æ•°drawä¸­è°ƒç”¨stat.begin();ä¸stat.end();åˆ†åˆ«è¡¨ç¤ºä¸€å¸§çš„å¼€å§‹ä¸ç»“æŸ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    stat.begin();</span><br><span class="line"></span><br><span class="line">    mesh.rotation.y = (mesh.rotation.y + <span class="number">0.01</span>) % (<span class="built_in">Math</span>.PI * <span class="number">2</span>);</span><br><span class="line">    renderer.render(scene, camera);</span><br><span class="line"></span><br><span class="line">    stat.end();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å¤–éƒ¨æ¨¡å‹"><a href="#å¤–éƒ¨æ¨¡å‹" class="headerlink" title="å¤–éƒ¨æ¨¡å‹"></a>å¤–éƒ¨æ¨¡å‹</h3><p>Three.jså…è®¸ç”¨æˆ·å¯¼å…¥ç”±3ds Maxç­‰å·¥å…·åˆ¶ä½œçš„ä¸‰ç»´æ¨¡å‹ï¼Œå¹¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚</p><p>Three.jsæœ‰ä¸€ç³»åˆ—å¯¼å…¥å¤–éƒ¨æ–‡ä»¶çš„è¾…åŠ©å‡½æ•°ï¼Œæ˜¯åœ¨three.jsä¹‹å¤–çš„ï¼Œä½¿ç”¨å‰éœ€è¦é¢å¤–ä¸‹è½½ï¼Œåœ¨<a href="https://github.com/mrdoob/three.js/tree/master/examples/js/loaderså¯ä»¥æ‰¾åˆ°ã€‚" target="_blank" rel="noopener">https://github.com/mrdoob/three.js/tree/master/examples/js/loaderså¯ä»¥æ‰¾åˆ°ã€‚</a></p><p><code>*.obj</code>æ˜¯æœ€å¸¸ç”¨çš„æ¨¡å‹æ ¼å¼ï¼Œå¯¼å…¥<code>*.obj</code>æ–‡ä»¶éœ€è¦OBJLoader.jsï¼›å¯¼å…¥å¸¦<code>*.mtl</code>æè´¨çš„<code>*.obj</code>æ–‡ä»¶éœ€è¦MTLLoader.jsä»¥åŠOBJMTLLoader.jsã€‚å¦æœ‰PLYLoader.jsã€STLLoader.jsç­‰åˆ†åˆ«å¯¹åº”ä¸åŒæ ¼å¼çš„åŠ è½½å™¨ï¼Œå¯ä»¥æ ¹æ®æ¨¡å‹æ ¼å¼è‡ªè¡Œé€‰æ‹©ã€‚</p><p>ç›®å‰ï¼Œæ”¯æŒçš„æ¨¡å‹æ ¼å¼æœ‰ï¼š</p><ul><li>*.obj</li><li><em>.obj, </em>.mtl</li><li>*.dae</li><li>*.ctm</li><li>*.ply</li><li>*.stl</li><li>*.wrl</li><li>*.vtk</li></ul><p>æ— æè´¨æ¨¡å‹å¯¼å…¥å®ä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ¬ä¾‹å­éœ€è¦OBJLoader.js</span></span><br><span class="line"><span class="comment">// åˆ›å»ºloaderå®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> loader = <span class="keyword">new</span> THREE.OBJLoader();</span><br><span class="line">loader.load(<span class="string">'../lib/port.obj'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    mesh = obj; <span class="comment">//å‚¨å­˜åˆ°å…¨å±€å˜é‡ä¸­</span></span><br><span class="line">    scene.add(obj);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>æœ‰æè´¨æ¨¡å‹å¯¼å…¥å®ä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ¬ä¾‹å­éœ€è¦MTLLoader.jsä¸OBJMTLLoader.js</span></span><br><span class="line"><span class="keyword">var</span> loader = <span class="keyword">new</span> THREE.OBJMTLLoader();</span><br><span class="line">loader.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = event.content;</span><br><span class="line">    mesh = obj;</span><br><span class="line">    scene.add(obj);</span><br><span class="line">&#125;);</span><br><span class="line">loader.load(<span class="string">'../lib/port.obj'</span>, <span class="string">'../lib/port.mtl'</span>);</span><br></pre></td></tr></table></figure></p><h3 id="å…‰ä¸å½±"><a href="#å…‰ä¸å½±" class="headerlink" title="å…‰ä¸å½±"></a>å…‰ä¸å½±</h3><p>å›¾åƒæ¸²æŸ“çš„ä¸°å¯Œæ•ˆæœå¾ˆå¤§ç¨‹åº¦ä¸Šä¹Ÿè¦å½’åŠŸäºå…‰ä¸å½±çš„åˆ©ç”¨ã€‚</p><h4 id="ç¯å¢ƒå…‰"><a href="#ç¯å¢ƒå…‰" class="headerlink" title="ç¯å¢ƒå…‰"></a>ç¯å¢ƒå…‰</h4><p>ç¯å¢ƒå…‰æ˜¯æŒ‡åœºæ™¯æ•´ä½“çš„å…‰ç…§æ•ˆæœï¼Œæ˜¯ç”±äºåœºæ™¯å†…è‹¥å¹²å…‰æºçš„å¤šæ¬¡åå°„å½¢æˆçš„äº®åº¦ä¸€è‡´çš„æ•ˆæœï¼Œé€šå¸¸ç”¨æ¥ä¸ºæ•´ä¸ªåœºæ™¯æŒ‡å®šä¸€ä¸ªåŸºç¡€äº®åº¦ã€‚å› æ­¤ï¼Œç¯å¢ƒå…‰æ²¡æœ‰æ˜ç¡®çš„å…‰æºä½ç½®ï¼Œåœ¨å„å¤„å½¢æˆçš„äº®åº¦ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚å…¶æ„é€ å‡½æ•°æ˜¯ï¼š<code>new THREE.AmbientLight(hex)</code>ã€‚</p><p>å…³äºç¯å¢ƒå…‰æœ‰ä¸ªå¥½ç©çš„ç°è±¡ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å½“æˆ‘ä»¬å°†ç¯å¢ƒå…‰è®¾ç½®ä¸ºçº¢è‰²ï¼Œåœºæ™¯å†…åŒæ ·æ”¾ç½®ç»¿è‰²0x00ff00å’Œç™½è‰²0xffffffçš„é•¿æ–¹ä½“ã€‚</span><br><span class="line">æ¸²æŸ“çš„ç»“æœæ˜¯è¿™ä¸¤ä¸ªé•¿æ–¹ä½“éƒ½è¢«æ¸²æŸ“æˆäº†ç¯å¢ƒå…‰çš„çº¢è‰²ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">è¿™ä¸€ç»“æœå¯èƒ½æœ‰äº›å‡ºä¹ä½ çš„æ„æ–™ã€‚å…¶å®ï¼Œç¯å¢ƒå…‰å¹¶ä¸åœ¨ä¹ç‰©ä½“æè´¨çš„colorå±æ€§ï¼Œè€Œæ˜¯ambientå±æ€§ã€‚ambientå±æ€§çš„é»˜è®¤å€¼æ˜¯0xffffffã€‚</span><br><span class="line">ambientå±æ€§è¡¨ç¤ºçš„æ˜¯ç‰©ä½“åå°„ç¯å¢ƒå…‰çš„èƒ½åŠ›ã€‚å¯¹äº0x00ff00çš„ç‰©ä½“ï¼Œçº¢è‰²é€šé“æ˜¯0ï¼Œè€Œç¯å¢ƒå…‰æ˜¯å®Œå…¨çš„çº¢å…‰ï¼Œå› æ­¤è¯¥é•¿æ–¹ä½“ä¸èƒ½åå°„ä»»ä½•å…‰çº¿ï¼Œæœ€ç»ˆçš„æ¸²æŸ“é¢œè‰²å°±æ˜¯é»‘è‰²ï¼›è€Œå¯¹äº0xffffffçš„ç™½è‰²é•¿æ–¹ä½“ï¼Œçº¢è‰²é€šé“æ˜¯0xffï¼Œå› è€Œèƒ½åå°„æ‰€æœ‰çº¢å…‰ï¼Œæ¸²æŸ“çš„é¢œè‰²å°±æ˜¯çº¢è‰²ã€‚</span><br></pre></td></tr></table></figure></p><p>å½“ç¯å¢ƒå…‰ä¸æ˜¯ç™½è‰²æˆ–ç°è‰²çš„æ—¶å€™ï¼Œæ¸²æŸ“çš„æ•ˆæœå¾€å¾€ä¼šå¾ˆå¥‡æ€ªã€‚å› æ­¤ï¼Œç¯å¢ƒå…‰é€šå¸¸ä½¿ç”¨ç™½è‰²æˆ–è€…ç°è‰²ï¼Œä½œä¸ºæ•´ä½“å…‰ç…§çš„åŸºç¡€ã€‚</p><h4 id="ç‚¹å…‰æº"><a href="#ç‚¹å…‰æº" class="headerlink" title="ç‚¹å…‰æº"></a>ç‚¹å…‰æº</h4><p>ç‚¹å…‰æºæ˜¯ä¸è®¡å…‰æºå¤§å°ï¼Œå¯ä»¥çœ‹ä½œä¸€ä¸ªç‚¹å‘å‡ºçš„å…‰æºã€‚ç‚¹å…‰æºç…§åˆ°ä¸åŒç‰©ä½“è¡¨é¢çš„äº®åº¦æ˜¯çº¿æ€§é€’å‡çš„ï¼Œå› æ­¤ï¼Œç¦»ç‚¹å…‰æºè·ç¦»è¶Šè¿œçš„ç‰©ä½“ä¼šæ˜¾å¾—è¶Šæš—ã€‚<br>ç‚¹å…‰æºçš„æ„é€ å‡½æ•°æ˜¯ï¼š<code>new THREE.PointLight(hex, intensity, distance)</code></p><h4 id="å¹³è¡Œå…‰"><a href="#å¹³è¡Œå…‰" class="headerlink" title="å¹³è¡Œå…‰"></a>å¹³è¡Œå…‰</h4><p>å¯¹äºä»»æ„å¹³è¡Œçš„å¹³é¢ï¼Œå¹³è¡Œå…‰ç…§å°„çš„äº®åº¦éƒ½æ˜¯ç›¸åŒçš„ï¼Œè€Œä¸å¹³é¢æ‰€åœ¨ä½ç½®æ— å…³ã€‚<br>å¹³è¡Œå…‰çš„æ„é€ å‡½æ•°æ˜¯ï¼š<code>new THREE.DirectionalLight(hex, intensity)</code></p><h4 id="èšå…‰ç¯"><a href="#èšå…‰ç¯" class="headerlink" title="èšå…‰ç¯"></a>èšå…‰ç¯</h4><p>èšå…‰ç¯æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç‚¹å…‰æºï¼Œå®ƒèƒ½å¤Ÿæœç€ä¸€ä¸ªæ–¹å‘æŠ•å°„å…‰çº¿ã€‚èšå…‰ç¯æŠ•å°„å‡ºçš„æ˜¯ç±»ä¼¼åœ†é”¥å½¢çš„å…‰çº¿ï¼Œè¿™ä¸æˆ‘ä»¬ç°å®ä¸­çœ‹åˆ°çš„èšå…‰ç¯æ˜¯ä¸€è‡´çš„ã€‚</p><p>å…¶æ„é€ å‡½æ•°ä¸ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> THREE.SpotLight(hex, intensity, distance, angle, exponent)</span><br></pre></td></tr></table></figure></p><p>ç›¸æ¯”ç‚¹å…‰æºï¼Œå¤šäº†angleå’Œexponentä¸¤ä¸ªå‚æ•°ã€‚angleæ˜¯èšå…‰ç¯çš„å¼ è§’ï¼Œç¼ºçœå€¼æ˜¯Math.PI / 3ï¼Œæœ€å¤§å€¼æ˜¯Math.PI / 2ï¼›exponentæ˜¯å…‰å¼ºåœ¨åç¦»targetçš„è¡°å‡æŒ‡æ•°ï¼ˆtargetéœ€è¦åœ¨ä¹‹åå®šä¹‰ï¼Œç¼ºçœå€¼ä¸º(0, 0, 0)ï¼‰ï¼Œç¼ºçœå€¼æ˜¯10ã€‚</p><p>åœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹åï¼Œé™¤äº†è®¾ç½®å…‰æºæœ¬èº«çš„ä½ç½®ï¼Œä¸€èˆ¬è¿˜éœ€è¦è®¾ç½®targetï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">light.position.set(x1, y1, z1);</span><br><span class="line">light.target.position.set(x2, y2, z2);</span><br></pre></td></tr></table></figure></p><p>é™¤äº†è®¾ç½®light.target.positionçš„æ–¹æ³•å¤–ï¼Œå¦‚æœæƒ³è®©èšå…‰ç¯è·Ÿç€æŸä¸€ç‰©ä½“ç§»åŠ¨ï¼ˆå°±åƒçœŸçš„èšå…‰ç¯ï¼ï¼‰ï¼Œå¯ä»¥targetæŒ‡å®šä¸ºè¯¥ç‰©ä½“ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cube = <span class="keyword">new</span> THREE.Mesh(<span class="keyword">new</span> THREE.CubeGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>), <span class="keyword">new</span> THREE.MeshLambertMaterial(&#123;<span class="attr">color</span>: <span class="number">0x00ff00</span>&#125;));</span><br><span class="line"><span class="keyword">var</span> light = <span class="keyword">new</span> THREE.SpotLight(<span class="number">0xffff00</span>, <span class="number">1</span>, <span class="number">100</span>, <span class="built_in">Math</span>.PI / <span class="number">6</span>, <span class="number">25</span>);</span><br><span class="line">light.target = cube;</span><br></pre></td></tr></table></figure></p><h4 id="é˜´å½±"><a href="#é˜´å½±" class="headerlink" title="é˜´å½±"></a>é˜´å½±</h4><p>åœ¨Three.jsä¸­ï¼Œèƒ½å½¢æˆé˜´å½±çš„å…‰æºåªæœ‰<code>THREE.DirectionalLight</code>ä¸<code>THREE.SpotLight</code>ï¼›è€Œç›¸å¯¹åœ°ï¼Œèƒ½è¡¨ç°é˜´å½±æ•ˆæœçš„æè´¨åªæœ‰<code>THREE.LambertMaterial</code>ä¸<code>THREE.PhongMaterial</code>ã€‚å› è€Œåœ¨è®¾ç½®å…‰æºå’Œæè´¨çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚</p><p>å®ä¾‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆå§‹åŒ–æ—¶ï¼Œå‘Šè¯‰æ¸²æŸ“å™¨æ¸²æŸ“é˜´å½±ï¼š</span></span><br><span class="line">renderer.shadowMapEnabled = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// ç„¶åï¼Œå¯¹äºå…‰æºä»¥åŠæ‰€æœ‰è¦äº§ç”Ÿé˜´å½±çš„ç‰©ä½“è°ƒç”¨ï¼š</span></span><br><span class="line">xxx.castShadow = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// å¯¹äºæ¥æ”¶é˜´å½±çš„ç‰©ä½“è°ƒç”¨ï¼š</span></span><br><span class="line">xxx.receiveShadow = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></p><p>å¯¹äºèšå…‰ç¯ï¼Œéœ€è¦è®¾ç½®shadowCameraNearã€shadowCameraFarã€shadowCameraFovä¸‰ä¸ªå€¼ï¼Œç±»æ¯”æˆ‘ä»¬åœ¨ç¬¬äºŒç« å­¦åˆ°çš„é€è§†æŠ•å½±ç…§ç›¸æœºï¼Œåªæœ‰ä»‹äºshadowCameraNearä¸shadowCameraFarä¹‹é—´çš„ç‰©ä½“å°†äº§ç”Ÿé˜´å½±ï¼ŒshadowCameraFovè¡¨ç¤ºå¼ è§’ã€‚</p><p>å¯¹äºå¹³è¡Œå…‰ï¼Œéœ€è¦è®¾ç½®shadowCameraNearã€shadowCameraFarã€shadowCameraLeftã€shadowCameraRightã€shadowCameraTopä»¥åŠshadowCameraBottomå…­ä¸ªå€¼ï¼Œç›¸å½“äºæ­£äº¤æŠ•å½±ç…§ç›¸æœºçš„å…­ä¸ªé¢ã€‚åŒæ ·ï¼Œåªæœ‰åœ¨è¿™å…­ä¸ªé¢å›´æˆçš„é•¿æ–¹ä½“å†…çš„ç‰©ä½“æ‰ä¼šäº§ç”Ÿé˜´å½±æ•ˆæœã€‚</p><p>ä¸ºäº†çœ‹åˆ°é˜´å½±ç…§ç›¸æœºçš„ä½ç½®ï¼Œé€šå¸¸å¯ä»¥åœ¨è°ƒè¯•æ—¶å¼€å¯light.shadowCameraVisible = trueã€‚</p><p><img src="/images/shadow.jpeg" alt="shadow"></p><p>å¦‚æœæƒ³è¦ä¿®æ”¹é˜´å½±çš„æ·±æµ…ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®shadowDarknessï¼Œè¯¥å€¼çš„èŒƒå›´æ˜¯0åˆ°1ï¼Œè¶Šå°è¶Šæµ…ã€‚</p><p>å¦å¤–ï¼Œè¿™é‡Œå®ç°é˜´å½±æ•ˆæœçš„æ–¹æ³•æ˜¯Shadow Mappingï¼Œå³é˜´å½±æ˜¯ä½œä¸ºæ¸²æŸ“å‰è®¡ç®—å¥½çš„è´´å›¾è´´ä¸Šå»çš„ï¼Œå› è€Œä¼šå—åˆ°è´´å›¾åƒç´ å¤§å°çš„é™åˆ¶ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡è®¾ç½®shadowMapWidthä¸shadowMapHeightå€¼æ§åˆ¶è´´å›¾çš„å¤§å°ï¼Œæ¥æ”¹å˜é˜´å½±çš„ç²¾ç¡®åº¦ã€‚</p><p>è€Œå¦‚æœæƒ³å®ç°è½¯é˜´å½±çš„æ•ˆæœï¼Œå¯ä»¥é€šè¿‡renderer.shadowMapSoft = true;æ–¹ä¾¿åœ°å®ç°ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.ituring.com.cn/book/1272" target="_blank" rel="noopener">Three.jså…¥é—¨æŒ‡å—</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ç®€è¿°&quot;&gt;&lt;a href=&quot;#ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;ç®€è¿°&quot;&gt;&lt;/a&gt;ç®€è¿°&lt;/h3&gt;&lt;p&gt;threejsæ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºä¸‰ç»´å›¾å½¢åº”ç”¨çš„jsåº“ã€‚&lt;br&gt;è¯´åˆ°ä¸‰ç»´å›¾å½¢åº”ç”¨ï¼Œå°±ä¸å¾—ä¸æä¸€å¥webGLã€‚åœ¨ç™¾åº¦ç™¾ç§‘ä¸­æ˜¯è¿™ä¹ˆæè¿°webGLçš„ï¼š&lt;br&gt;&lt;code&gt;WebGLï¼ˆå…¨å†™Web Graphics Libraryï¼‰æ˜¯ä¸€ç§3Dç»˜å›¾åè®®ï¼Œè¿™ç§ç»˜å›¾æŠ€æœ¯æ ‡å‡†å…è®¸æŠŠJavaScriptå’ŒOpenGL ES 2.0ç»“åˆåœ¨ä¸€èµ·ï¼Œé€šè¿‡å¢åŠ OpenGL ES 2.0çš„ä¸€ä¸ªJavaScriptç»‘å®šï¼ŒWebGLå¯ä»¥ä¸ºHTML5 Canvasæä¾›ç¡¬ä»¶3DåŠ é€Ÿæ¸²æŸ“ï¼Œè¿™æ ·Webå¼€å‘äººå‘˜å°±å¯ä»¥å€ŸåŠ©ç³»ç»Ÿæ˜¾å¡æ¥åœ¨æµè§ˆå™¨é‡Œæ›´æµç•…åœ°å±•ç¤º3Dåœºæ™¯å’Œæ¨¡å‹äº†ï¼Œè¿˜èƒ½åˆ›å»ºå¤æ‚çš„å¯¼èˆªå’Œæ•°æ®è§†è§‰åŒ–ã€‚&lt;/code&gt;&lt;br&gt;ä¹Ÿå°±æ˜¯è¯´ï¼š&lt;code&gt;WebGLå¯ä»¥çœ‹åšæ˜¯å°†OpenGL ESï¼ˆOpenGL for Embedded Systemsï¼ŒOpenGLåµŒå…¥å¼ç‰ˆæœ¬ï¼Œé’ˆå¯¹æ‰‹æœºã€æ¸¸æˆæœºç­‰è®¾å¤‡ç›¸å¯¹è¾ƒè½»é‡çº§çš„ç‰ˆæœ¬ï¼‰ç§»æ¤åˆ°äº†ç½‘é¡µå¹³å°&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Three.jså°è£…äº†åº•å±‚çš„å›¾å½¢æ¥å£ï¼Œä½¿å¾—ç¨‹åºå‘˜èƒ½å¤Ÿåœ¨æ— éœ€æŒæ¡ç¹å†—çš„å›¾å½¢å­¦çŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ç”¨ç®€å•çš„ä»£ç å®ç°ä¸‰ç»´åœºæ™¯çš„æ¸²æŸ“ã€‚&lt;br&gt;é™¤äº†WebGLä¹‹å¤–ï¼ŒThree.jsè¿˜æä¾›äº†åŸºäºCanvasã€SVGæ ‡ç­¾çš„æ¸²æŸ“å™¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="https://sampwood.github.io/categories/coding/"/>
    
      <category term="js" scheme="https://sampwood.github.io/categories/coding/js/"/>
    
    
      <category term="WebGL" scheme="https://sampwood.github.io/tags/WebGL/"/>
    
      <category term="threejs" scheme="https://sampwood.github.io/tags/threejs/"/>
    
  </entry>
  
</feed>
